var EmpationAPI;(()=>{"use strict";var t={d:(e,i)=>{for(var n in i)t.o(i,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:i[n]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};t.r(e),t.d(e,{AbstractAPI:()=>u,EventSource:()=>n,HTTPError:()=>a,Logger:()=>l,RawAPI:()=>o,RootAPI:()=>v,RootContext:()=>f,STATUS_CODES:()=>s,ScopeContext:()=>p,ScopesAPI:()=>y,V3:()=>i,getJwtTokenExpiresTimeout:()=>c,parseJwtToken:()=>h,sleep:()=>d});var i={};t.r(i),t.d(i,{Apps:()=>g,Cases:()=>P,Examinations:()=>k,RationAI:()=>K,Root:()=>Z,Scopes:()=>Q,Slides:()=>L,Storage:()=>O});class n{constructor(){this.events={}}addOnceHandler(t,e,i,n,s){const r=this;n=n||1;let a=0;const o=function(i){return a++,a===n&&r.removeHandler(t,o),e(i)};this.addHandler(t,o,i,s)}addHandler(t,e,i,s){let r=this.events[t];if(r||(this.events[t]=r=[]),e&&n.isFunction(e)){let t=r.length,n={handler:e,userData:i||null,priority:s||0};for(r[t]=n;t>0&&r[t-1].priority<r[t].priority;)r[t]=r[t-1],r[t-1]=n,t--}}removeHandler(t,e){const i=this.events[t],n=[];if(i&&Array.isArray(i)){for(let t=0;t<i.length;t++)i[t].handler!==e&&n.push(i[t]);this.events[t]=n}}numberOfHandlers(t){const e=this.events[t];return e?e.length:0}removeAllHandlers(t){if(t)this.events[t]=[];else for(const t in this.events)this.events[t]=[]}getHandler(t){let e=this.events[t];return e&&e.length?(e=1===e.length?[e[0]]:Array.apply(null,e),function(t,i){let n,s=e.length;for(n=0;n<s;n++)e[n]&&(i.eventSource=t,i.userData=e[n].userData,e[n].handler(i))}):null}getAwaitingHandler(t){let e=this.events[t];return e&&e.length?(e=1===e.length?[e[0]]:Array.apply(null,e),function(t,i){return new Promise((s=>{const r=e.length;!function a(o){if(o>=r||!e[o])return s("Resolved!"),null;i.eventSource=t,i.userData=e[o].userData;let u=e[o].handler(i);return u=u&&"promise"===n.type(u)?u:Promise.resolve(),u.then((()=>a(o+1)))}(0)}))}):null}raiseEvent(t,e){const i=this.getHandler(t);if(i)return i(this,e||{})}raiseEventAwaiting(t,e){const i=this.getAwaitingHandler(t);return i?i(this,e||{}):Promise.resolve("No handler for this event registered.")}static isFunction(t){return"function"===this.type(t)}static type(t){return null==t?String(t):this.class2type[t.toString()]||("function"==typeof t?"function":"object")}}n.class2type={"[object Boolean]":"boolean","[object Number]":"number","[object String]":"string","[object Function]":"function","[object AsyncFunction]":"function","[object Promise]":"promise","[object Array]":"array","[object Date]":"date","[object RegExp]":"regexp","[object Object]":"object"};const s={100:"Continue",101:"Switching protocols",102:"Processing",103:"Early Hints",200:"Ok",201:"Created",202:"Accepted",203:"Non Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi Status",300:"Multiple Choices",301:"Moved Permanently",302:"Moved Temporarily",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",308:"Permanent Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Too Long",414:"Request Uri Too Long",415:"Unsupported Media Type",416:"Requested Range Not Satisfiable",417:"Expectation Failed",418:"Im A Teapot",419:"Insufficient Space On Resource",420:"Method Failure",421:"Misdirected Request",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",451:"Unavailable For Legal Reasons",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"Http Version Not Supported",507:"Insufficient Storage",511:"Network Authentication Required"};var r=function(t,e,i,n){return new(i||(i=Promise))((function(s,r){function a(t){try{u(n.next(t))}catch(t){r(t)}}function o(t){try{u(n.throw(t))}catch(t){r(t)}}function u(t){var e;t.done?s(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,o)}u((n=n.apply(t,e||[])).next())}))};class a extends Error{constructor(t,e,i){super(e||s[t]||`HTTP Code ${t}`),arguments.length>=3&&i&&Object.assign(this,i),this.name=function(t){const e=4==(t/100|0)||5==(t/100|0)?"error":"";return` ${String(s[t]||`HTTP Code ${t}`).replace(/error$/i,"")} ${e}`.split(" ").reduce(((t,e)=>t+(e?e.charAt(0).toUpperCase()+e.slice(1):"")))}(t),this.statusCode=t}}class o{constructor(t,e={}){this.url=t,this.options=e}_parseQueryParams(t){if(t){if("string"==typeof t)return t;if(t.constructor===Object||void 0===t.constructor)for(let e in t){null==t[e]&&delete t[e]}return`?${new URLSearchParams(t)}`}return""}_fetch(t,e){return r(this,void 0,void 0,(function*(){const i=yield fetch(t,{method:e.method,headers:e.headers,body:e.body});let n;try{n=yield i[e.responseType||"json"]()}catch(e){throw new a(500,`Failed to parse response data. Original status: ${i.status} | ${i.statusText}`,{url:t,error:e})}if(!i.ok)throw new a(i.status,i.statusText,n);return n}))}http(t,e){return r(this,void 0,void 0,(function*(){const i=!!e.body;return e.method=e.method||(i?"POST":"GET"),t.startsWith("/")||(t=`/${t}`),e.query=this._parseQueryParams(e.query),e.headers=e.headers||{},e.headers["Content-Type"]="application/json",e.body&&"string"!=typeof e.body?e.body=JSON.stringify(e.body):e.body=void 0,yield this._fetch(this.url+t+e.query,e)}))}}class u extends n{getCallerName(){const t=Error.prepareStackTrace;Error.prepareStackTrace=(t,e)=>e;const{stack:e}=new Error;Error.prepareStackTrace=t;return(null==e?void 0:e[2])||"unknown context"}requires(t,e){if(!e)throw`ArgumentError[${this.getCallerName()}] ${t} is missing - required property!`}}function c(t){return 1e3*t.exp-Date.now()||3e5}function h(t){return JSON.parse(atob(t.split(".")[1]))}function d(t){return new Promise((e=>setTimeout(e,t)))}class l{static error(...t){console.error("E:EmpationAPI",...t)}static warn(...t){console.warn("W:EmpationAPI",...t)}static info(...t){console.info("I:EmpationAPI",...t)}static debug(...t){console.debug("D:EmpationAPI",...t)}}class f{}class v extends u{constructor(t){if(super(),this.accessToken=null,this._tokenExpires=0,this._rawToken="",!t.workbenchApiUrl)throw"WB Api url is required!";let e;e=t.apiRootPath?t.apiRootPath.startsWith("/")?`${t.workbenchApiUrl}${t.apiRootPath}`:`${t.workbenchApiUrl}/${t.apiRootPath}`:t.workbenchApiUrl,e.endsWith("/")&&(e=e.slice(0,-1)),this.options={apiUrl:e,workbenchApiUrl:t.workbenchApiUrl,anonymousUserId:t.anonymousUserId||"anonymous",apiRootPath:t.apiRootPath||""},this._userId=this.options.anonymousUserId,this.cached={}}from(t,e=!0){if(!t)return this.reset();this._rawToken=t,e=e&&!this.accessToken,this.accessToken=h(t);const i=c(this.accessToken);this._tokenExpires=Date.now()+i/2;const n=this.accessToken.sub;if(!n||n.length>50)throw"Invalid User ID! Must be valid string shorter than 50 characters!";this._userId=n,this.userId!==n&&e&&this.raiseEvent("init")}reset(){this._rawToken="",this._tokenExpires=0,this.accessToken=null,this._userId=this.options.anonymousUserId,this.scopes.reset(),this.raiseEvent("reset")}get userId(){return this._userId}get rawToken(){return this._rawToken}rawQuery(t,e){return i=this,n=void 0,r=function*(){if(!this._userId)throw"User must be configured to access Empaia API: either provide a valid 'anonymous' user ID through env variables, or configure the Root API with a valid token.";if(this._tokenExpires>0&&Date.now()>this._tokenExpires){const t={newToken:""};yield this.raiseEventAwaiting("token-refresh",t),this.from(t.newToken)}},new((s=void 0)||(s=Promise))((function(t,e){function a(t){try{u(r.next(t))}catch(t){e(t)}}function o(t){try{u(r.throw(t))}catch(t){e(t)}}function u(e){var i;e.done?t(e.value):(i=e.value,i instanceof s?i:new s((function(t){t(i)}))).then(a,o)}u((r=r.apply(i,n||[])).next())}));var i,n,s,r}}class p{}class y extends u{}var m=function(t,e,i,n){return new(i||(i=Promise))((function(s,r){function a(t){try{u(n.next(t))}catch(t){r(t)}}function o(t){try{u(n.throw(t))}catch(t){r(t)}}function u(t){var e;t.done?s(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,o)}u((n=n.apply(t,e||[])).next())}))};class g extends f{constructor(t){super(),this.data=null,this._defaultApp=null,this.context=t}list(){return m(this,void 0,void 0,(function*(){return this.data=yield this.context.rawQuery("/apps/query",{method:"PUT",body:{apps:null,tissues:null,stains:null,job_modes:null}})}))}query(t){return m(this,void 0,void 0,(function*(){return this.data=yield this.context.rawQuery("/apps/query",{method:"PUT",body:t})}))}default(){return m(this,void 0,void 0,(function*(){this.data||(yield this.list());for(let t of this.data.items)if("MAP3"===t.name_short&&"rationai"===t.vendor_name){this._defaultApp=t;break}if(!this._defaultApp)throw"Default APP not present in the infrastructure! Was it imported?";return this._defaultApp}))}}const x=t=>("string"==typeof t&&(t=Number(t)),t),w=(t,e,i,n)=>{const s=new RegExp(e).exec(t);return!(!s||i<1||i>=s.length)&&s[i]===n};var b=function(t,e,i,n){return new(i||(i=Promise))((function(s,r){function a(t){try{u(n.next(t))}catch(t){r(t)}}function o(t){try{u(n.throw(t))}catch(t){r(t)}}function u(t){var e;t.done?s(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,o)}u((n=n.apply(t,e||[])).next())}))};class T{constructor(t){this.customCases=null,this.caseHierarchy=null,this.caseTissues=null,this.caseStains=null,this.identifierSeparator="",this.hierarchySpec=[],this.context=t}use(t,e){this.hierarchySpec=e,this.identifierSeparator=t}getCustomCases(){return b(this,void 0,void 0,(function*(){return this.customCases||(this.customCases=(yield this.context.list()).items.map((t=>Object.assign(Object.assign({},t),{pathInHierarchy:this.getCaseHierarchyPath(t)})))),this.customCases}))}getCaseHierarchyPath(t){if(!this.identifierSeparator||!this.hierarchySpec)throw"ArgumentError[CaseExplorer] identifierSeparator or hierarchySpec is missing - required property!";return this.hierarchySpec.reduce(((e,i)=>`${e}/${this.getCaseValue(i,t)}`),"")}getCase(t){return b(this,void 0,void 0,(function*(){let e;return this.customCases&&(e=this.customCases.find((e=>e.id===t))),e||(e=yield this.context.get(t)),Object.assign(Object.assign({},e),{pathInHierarchy:this.getCaseHierarchyPath(e)})}))}getCaseValue(t,e){switch(t){case"year":return this.getCaseYear(e);case"month":return this.getCaseMonth(e);case"day":return this.getCaseDay(e);case"description":return this.getCaseDescription(e);case"tissues":return this.getCaseTissues(e);case"stains":return this.getCaseStains(e);default:if("id_part_"===t.slice(0,8)&&!isNaN(Number(t.slice(8))))return this.getCaseIdentifierPart(e,Number(t.slice(8)));throw`KeyError[CaseExplorer] "${t}" is not supported!`}}evaluateCaseValue(t,e,i){const n=this.getCaseValue(t,i);switch(t){case"year":return this.evaulateCaseYear(n,e);case"month":return this.evaulateCaseMonth(n,e);case"day":return this.evaulateCaseDay(n,e);case"description":return this.evaluateCaseDescription(n,e);case"tissues":return this.evaluateCaseTissues(n,e);case"stains":return this.evaluateCaseStains(n,e);default:return this.evaulateCaseIdentifierPart(n,e)}}getCaseYear(t){return(e=t.created_at,new Date(1e3*x(e)).getFullYear()).toString();var e}getCaseMonth(t){return(e=t.created_at,new Date(1e3*x(e)).getMonth()).toString();var e}getCaseDay(t){return(e=t.created_at,new Date(1e3*x(e)).getDate()).toString();var e}getCaseIdentifierPart(t,e){if(!this.identifierSeparator)throw"ArgumentError[CaseExplorer] identifierSeparator is missing - required property!";const i=new RegExp(this.identifierSeparator).exec(t.local_id||"");if(!i)return"OTHER";if(e<1||e>=i.length)throw'KeyError[CaseExplorer] invalid key "id_part_<index>", group index is not valid!';return i[e]}getCaseDescription(t){return t.description||""}getCaseTissues(t){return Object.keys(t.tissues)}getCaseStains(t){return Object.keys(t.stains)}evaulateCaseYear(t,e){return t===e}evaulateCaseMonth(t,e){return t===e}evaulateCaseDay(t,e){return t===e}evaulateCaseIdentifierPart(t,e){return t===e}evaluateCaseDescription(t,e){return((t,e)=>{const i=e.split(" ").filter(Boolean).map((t=>`(?=.*\\b${t}\\b)`)),n=new RegExp(i.join(""),"gim");return null!==t.match(n)})(t,e)}evaluateCaseTissues(t,e){return e.every((e=>Object.keys(t).includes(e)))}evaluateCaseStains(t,e){return e.every((e=>Object.keys(t).includes(e)))}hierarchyLevel(t,e,i,n,s){if(e>=t.length)return{levelName:s,lastLevel:!0,items:i.map((t=>Object.assign(Object.assign({},t),{pathInHierarchy:n})))};const r=(a=i=>{const n=this.getCaseValue(t[e],i);return Array.isArray(n)?n[0]||"":n},i.reduce(((t,e)=>{var i;return(t[i=a(e)]||(t[i]=[])).push(e),t}),{}));var a;const o=Object.keys(r).map((i=>"OTHER"===i?this.hierarchyLevel(t,t.length,r[i],`${n}/${i}`,i):this.hierarchyLevel(t,e+1,r[i],`${n}/${i}`,i)));return{levelName:s,lastLevel:!1,items:o}}hierarchy(){return b(this,void 0,void 0,(function*(){if(!this.caseHierarchy){const t=yield this.getCustomCases();this.caseHierarchy=this.hierarchyLevel(this.hierarchySpec,0,t,"")}return this.caseHierarchy}))}search(t){return b(this,void 0,void 0,(function*(){let e=yield this.getCustomCases();return t.forEach((({key:t,value:i})=>e=e.filter((e=>this.evaluateCaseValue(t,i,e))))),e}))}tissues(t="EN"){return b(this,void 0,void 0,(function*(){if(!this.caseTissues){const e=yield this.getCustomCases(),i=new Set;e.forEach((e=>Object.values(e.tissues).map((e=>e[t])).forEach((t=>i.add(t))))),this.caseTissues=[...i]}return this.caseTissues}))}stains(t="EN"){return b(this,void 0,void 0,(function*(){if(!this.caseStains){const e=yield this.getCustomCases(),i=new Set;e.forEach((e=>Object.values(e.stains).map((e=>e[t])).forEach((t=>i.add(t))))),this.caseStains=[...i]}return this.caseStains}))}}var I=function(t,e,i,n){return new(i||(i=Promise))((function(s,r){function a(t){try{u(n.next(t))}catch(t){r(t)}}function o(t){try{u(n.throw(t))}catch(t){r(t)}}function u(t){var e;t.done?s(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,o)}u((n=n.apply(t,e||[])).next())}))};class S{constructor(t){this.lastCaseId=null,this.data=null,this.slidesData=null,this.masksData=null,this.maskIdentifierSeparator="",this.maskIdentifierValue="",this.context=t}use(t,e){this.maskIdentifierSeparator=t,this.maskIdentifierValue=e}getAllSlides(t){return I(this,void 0,void 0,(function*(){return this.lastCaseId===t&&this.data||(this.data=(yield this.context.slides(t)).items),this.data}))}slides(t){return I(this,void 0,void 0,(function*(){return this.lastCaseId===t&&this.slidesData||(this.slidesData=(yield this.getAllSlides(t)).filter((t=>!w(t.local_id||"",this.maskIdentifierSeparator,1,this.maskIdentifierValue)))),this.slidesData}))}masks(t){return I(this,void 0,void 0,(function*(){return this.lastCaseId===t&&this.masksData||(this.masksData=(yield this.getAllSlides(t)).filter((t=>w(t.local_id||"",this.maskIdentifierSeparator,1,this.maskIdentifierValue)))),this.masksData}))}}var C=function(t,e,i,n){return new(i||(i=Promise))((function(s,r){function a(t){try{u(n.next(t))}catch(t){r(t)}}function o(t){try{u(n.throw(t))}catch(t){r(t)}}function u(t){var e;t.done?s(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,o)}u((n=n.apply(t,e||[])).next())}))};class P extends f{constructor(t){super(),this.data=null,this.context=t,this.caseExplorer=new T(this),this.wsiExplorer=new S(this)}list(){return C(this,void 0,void 0,(function*(){return this.data||(this.data=yield this.context.rawQuery("/cases")),this.data}))}get(t){return C(this,void 0,void 0,(function*(){return yield this.context.rawQuery(`/cases/${t}`)}))}slides(t){return C(this,void 0,void 0,(function*(){return yield this.context.rawQuery(`/cases/${t}/slides`)}))}}var E=function(t,e,i,n){return new(i||(i=Promise))((function(s,r){function a(t){try{u(n.next(t))}catch(t){r(t)}}function o(t){try{u(n.throw(t))}catch(t){r(t)}}function u(t){var e;t.done?s(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,o)}u((n=n.apply(t,e||[])).next())}))};class k extends f{constructor(t){super(),this.data=null,this.context=t}create(t,e){return E(this,void 0,void 0,(function*(){const i=this.context;return i.requires("caseId",t),i.rawQuery("/examinations",{method:"PUT",body:{case_id:t,app_id:e}})}))}query(t,e,i){return E(this,void 0,void 0,(function*(){return this.context.rawQuery("/examinations/query",{method:"PUT",body:t,query:{skip:e,limit:i}})}))}get(t){return E(this,void 0,void 0,(function*(){const e=this.context;return e.requires("examinationId",t),e.rawQuery(`/examinations/${t}`)}))}scope(t){return E(this,void 0,void 0,(function*(){const e=this.context;return e.requires("examinationId",t),e.rawQuery(`/examinations/${t}/scope`,{method:"PUT"})}))}}var _=function(t,e,i,n){return new(i||(i=Promise))((function(s,r){function a(t){try{u(n.next(t))}catch(t){r(t)}}function o(t){try{u(n.throw(t))}catch(t){r(t)}}function u(t){var e;t.done?s(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,o)}u((n=n.apply(t,e||[])).next())}))};class O extends p{constructor(t){super(),this.data=null,this.context=t}getRaw(){return _(this,void 0,void 0,(function*(){return this.data||(this.data=yield this.context.rawQuery("/app-ui-storage/user")),this.data}))}flush(){return _(this,void 0,void 0,(function*(){return this.data?yield this.context.rawQuery("/app-ui-storage/user",{method:"PUT",body:this.data}):null}))}get(t){return _(this,void 0,void 0,(function*(){const e=yield this.getRaw();return"string"==typeof e.content[t]?JSON.parse(e.content[t]):e.content[t]}))}set(t,e,i){return _(this,void 0,void 0,(function*(){const n=JSON.stringify(e),s=yield this.getRaw();s.content[t]=n,this.data=s,i&&this.flush()}))}erase(){return _(this,void 0,void 0,(function*(){this.data={content:{}},this.flush()}))}}var $=function(t,e,i,n){return new(i||(i=Promise))((function(s,r){function a(t){try{u(n.next(t))}catch(t){r(t)}}function o(t){try{u(n.throw(t))}catch(t){r(t)}}function u(t){var e;t.done?s(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,o)}u((n=n.apply(t,e||[])).next())}))};class A extends p{constructor(t){super(),this.context=t}upload(t,e={}){return $(this,void 0,void 0,(function*(){return yield this.context.rawQuery("/annotations",{method:"POST",query:e,body:this.data})}))}create(t,e={}){return $(this,void 0,void 0,(function*(){return yield this.context.rawQuery("/annotations",{method:"POST",query:e,body:this.data})}))}delete(t){return $(this,void 0,void 0,(function*(){return yield this.context.rawQuery(`/annotations/${t}`,{method:"DELETE"})}))}update(t,e,i={}){return $(this,void 0,void 0,(function*(){return yield this.delete(t),!i.externalIds&&e.id&&(i.externalIds=!0),yield this.create(e,i)}))}}var R=function(t,e,i,n){return new(i||(i=Promise))((function(s,r){function a(t){try{u(n.next(t))}catch(t){r(t)}}function o(t){try{u(n.throw(t))}catch(t){r(t)}}function u(t){var e;t.done?s(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,o)}u((n=n.apply(t,e||[])).next())}))};class j extends p{constructor(t){super(),this.data=null,this.context=t}get(t){return R(this,void 0,void 0,(function*(){return yield this.context.rawQuery(`/collections/${t}`)}))}create(t){return R(this,void 0,void 0,(function*(){return yield this.context.rawQuery("/collections",{method:"POST",body:t})}))}delete(t){return R(this,void 0,void 0,(function*(){yield this.context.rawQuery(`/collections/${t}`,{method:"DELETE"})}))}queryItems(t,e){return R(this,void 0,void 0,(function*(){return yield this.context.rawQuery(`/collections/${t}/items/query`,{method:"PUT",body:e})}))}createItems(t,e){return R(this,void 0,void 0,(function*(){yield this.context.rawQuery(`/collections/${t}/items`,{method:"POST",body:Object.assign({},e)})}))}deleteItem(t,e){return R(this,void 0,void 0,(function*(){yield this.context.rawQuery(`/collections/${t}/items/${e}`,{method:"DELETE"})}))}}var q=function(t,e,i,n){return new(i||(i=Promise))((function(s,r){function a(t){try{u(n.next(t))}catch(t){r(t)}}function o(t){try{u(n.throw(t))}catch(t){r(t)}}function u(t){var e;t.done?s(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,o)}u((n=n.apply(t,e||[])).next())}))};class U extends y{constructor(t){super(),this.scopeContext=null,this._defaultExaminationId="",this._activeExaminationId="",this._tokenRefetchInterval=null,this.context=t,this.raw=new o(this.context.options.apiUrl+U.apiPath),this.storage=new O(this),this.annotations=new A(this),this.collections=new j(this)}use(t,e=void 0){return q(this,void 0,void 0,(function*(){this.requires("root::userId",this.context.userId);const i=e=>q(this,void 0,void 0,(function*(){let i=yield this.context.examinations.query({apps:[e],creators:[this.context.userId]});if(i.item_count>0){let t=i.items.find((t=>"OPEN"===t.state));if(t)return t}return yield this.context.examinations.create(t,e)}));let n;if(e?n=yield i(e):this._defaultExaminationId&&(n=yield this.context.examinations.get(this._defaultExaminationId)),!n){let t=yield this.context.apps.default();n=yield i(t.app_id),this._defaultExaminationId=n.id}yield this.from(n)}))}get scopeToken(){var t;return null===(t=this.scopeContext)||void 0===t?void 0:t.access_token}from(t){return q(this,void 0,void 0,(function*(){this.reset(),this.scopeContext=yield this.context.examinations.scope(t.id),this._activeExaminationId=t.id;const e=c(h(this.scopeContext.access_token));this._tokenRefetchInterval=setInterval((()=>q(this,void 0,void 0,(function*(){this.scopeContext=yield this.context.examinations.scope(t.id)}))),e),this.raiseEvent("init")}))}reset(){this._activeExaminationId="",this.scopeContext=null,this._tokenRefetchInterval&&(clearInterval(this._tokenRefetchInterval),this._tokenRefetchInterval=null,this.raiseEvent("reset"))}rawQuery(t,e){var i,n;return q(this,void 0,void 0,(function*(){this.requires("this.scopeContext",this.scopeContext),(e=e||{}).headers=e.headers||{},e.headers.Authorization=`Bearer ${null===(i=this.scopeContext)||void 0===i?void 0:i.access_token}`,t&&!t.startsWith("/")&&(t=`/${t}`);try{return yield this.raw.http(`/${null===(n=this.scopeContext)||void 0===n?void 0:n.scope_id}${t}`,e)}catch(i){if(401===i.statusCode)return this.scopeContext=yield this.context.examinations.scope(this._activeExaminationId),yield this.raw.http(`/${this.scopeContext.scope_id}${t}`,e);throw i}}))}}U.apiPath="/v3/scopes";const Q=U;var N,D,M,H=function(t,e,i,n){return new(i||(i=Promise))((function(s,r){function a(t){try{u(n.next(t))}catch(t){r(t)}}function o(t){try{u(n.throw(t))}catch(t){r(t)}}function u(t){var e;t.done?s(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,o)}u((n=n.apply(t,e||[])).next())}))};class L extends f{constructor(t){super(),this.data=null,this.context=t}slideInfo(t){return H(this,void 0,void 0,(function*(){return yield this.context.rawQuery(`/slides/${t}/info`)}))}slideThumbnail(t,e,i,n){return H(this,void 0,void 0,(function*(){return yield this.context.rawQuery(`/slides/${t}/thumbnail/max_size/${e}/${i}`,{query:{image_format:n},responseType:"blob"})}))}slideLabel(t,e,i,n){return H(this,void 0,void 0,(function*(){return yield this.context.rawQuery(`/slides/${t}/label/max_size/${e}/${i}`,{query:{image_format:n},responseType:"blob"})}))}loadTile(t,e,i,n,s){return H(this,void 0,void 0,(function*(){return yield this.context.rawQuery(`/slides/${t}/tile/level/${e}/tile/${i}/${n}`,{query:{image_format:s},responseType:"blob"})}))}}!function(t){t.USER="user",t.SCOPE="scope",t.JOB="job"}(N||(N={})),function(t){t.ANNOTATION="annotation",t.COLLECTION="collection",t.CLASS="class",t.PRIMITIVE="primitive",t.WSI="wsi",t.CASE="case",t.USER="user",t.SCOPE="scope",t.JOB="job"}(D||(D={})),function(t){t.Background="background",t.Params="params",t.Shader="shader",t.Visualization="visualization"}(M||(M={}));var V=function(t,e,i,n){return new(i||(i=Promise))((function(s,r){function a(t){try{u(n.next(t))}catch(t){r(t)}}function o(t){try{u(n.throw(t))}catch(t){r(t)}}function u(t){var e;t.done?s(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,o)}u((n=n.apply(t,e||[])).next())}))};class J{constructor(t){this.data=null,this.defaultSlideMetadata={visualization:{}},this.defaultMaskMetadata={},this.context=t}getWsiMetadataItem(t,e=!0){return V(this,void 0,void 0,(function*(){let i=(yield this.context.query({references:[t]})).find((t=>t.data_type===(e?"slide":"mask")+"_metadata"));return i||(i=yield this.createWsiMetadataItem(t,e?this.defaultSlideMetadata:this.defaultMaskMetadata)),i}))}createWsiMetadataItem(t,e,i=!0){return V(this,void 0,void 0,(function*(){return yield this.context.createValue(e,`Metadata of ${i?"slide":"mask"} ${t}`,void 0,t,D.WSI,(i?"slide":"mask")+"_metadata")}))}getSlideMetadata(t){return V(this,void 0,void 0,(function*(){return JSON.parse((yield this.getWsiMetadataItem(t)).value)}))}updateSlideMetadata(t,e){return V(this,void 0,void 0,(function*(){const i=yield this.getWsiMetadataItem(t);try{const t=yield this.context.update(i.id,Object.assign(Object.assign({},i),{value:JSON.stringify(e)}));return JSON.parse(t.value)}catch(t){return!1}}))}getShadersConfig(t){return V(this,void 0,void 0,(function*(){const e={};for(let i=0;i<t.length;i++){const n=yield this.context.visTemplates.getTemplate(M.Shader,t[i].shaderTemplate);e[t[i].id]=Object.assign(Object.assign({},n),{name:t[i].name||t[i].id,dataReferences:t[i].dataRefs})}return e}))}getVisualizations(t){var e;return V(this,void 0,void 0,(function*(){const i=(yield this.getSlideMetadata(t)).visualization;return{params:i.paramsTemplate&&(yield this.context.visTemplates.getTemplate(M.Params,i.paramsTemplate))||void 0,data:i.data,background:Object.assign(Object.assign({},i.background?yield this.context.visTemplates.getTemplate(M.Background,null===(e=i.background)||void 0===e?void 0:e.template):{}),{data:i.background&&i.background.dataRef}),visualizations:i.visualizations&&(yield Promise.all(i.visualizations.map((t=>V(this,void 0,void 0,(function*(){return Object.assign(Object.assign({},yield this.context.visTemplates.getTemplate(M.Visualization,t.visTemplate)),{name:t.name,shaders:yield this.getShadersConfig(t.shaders)})}))))))}}))}getMaskMetadata(t){return V(this,void 0,void 0,(function*(){return JSON.parse((yield this.getWsiMetadataItem(t,!1)).value)}))}}var z=function(t,e,i,n){return new(i||(i=Promise))((function(s,r){function a(t){try{u(n.next(t))}catch(t){r(t)}}function o(t){try{u(n.throw(t))}catch(t){r(t)}}function u(t){var e;t.done?s(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,o)}u((n=n.apply(t,e||[])).next())}))};const W="vis_templates";class F{constructor(t){this.data=null,this.context=t}fetchTemplateItem(t,e){return z(this,void 0,void 0,(function*(){return(yield this.context.query({references:[null],data_types:[`${W}_${t}`]})).find((t=>t.name===e))}))}getTemplate(t,e){return z(this,void 0,void 0,(function*(){const i=yield this.fetchTemplateItem(t,e);return!!i&&JSON.parse(i.value)}))}createTemplate(t,e,i){return z(this,void 0,void 0,(function*(){return!(yield this.fetchTemplateItem(t,e))&&(yield this.context.createValue(i,`${e}`,void 0,void 0,void 0,`${W}_${t}`))}))}deleteTemplate(t,e){return z(this,void 0,void 0,(function*(){const i=yield this.fetchTemplateItem(t,e);return!!i&&(yield this.context.delete(i.id),!0)}))}}var B=function(t,e,i,n){return new(i||(i=Promise))((function(s,r){function a(t){try{u(n.next(t))}catch(t){r(t)}}function o(t){try{u(n.throw(t))}catch(t){r(t)}}function u(t){var e;t.done?s(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,o)}u((n=n.apply(t,e||[])).next())}))};class Y{constructor(t){this.data=null,this.context=t,this.wsiMetadata=new J(this),this.visTemplates=new F(this)}get(t){return B(this,void 0,void 0,(function*(){return yield this.context.rawQuery(`/global-storage/${t}`)}))}getValue(t){return B(this,void 0,void 0,(function*(){const e=yield this.get(t);if("string"===e.type)try{return JSON.parse(e.value)}catch(t){return e.value}return e.value}))}query(t){return B(this,void 0,void 0,(function*(){return(yield this.context.rawQuery("/global-storage/query",{method:"PUT",body:t})).items}))}create(t){return B(this,void 0,void 0,(function*(){return yield this.context.rawQuery("/global-storage",{method:"POST",body:t})}))}createValue(t,e,i,n,s,r){return B(this,void 0,void 0,(function*(){t=JSON.stringify(t);const a={name:e,description:i,creator_id:this.context.userId,creator_type:N.USER,reference_id:n,reference_type:s,type:"string",value:t,data_type:r};return yield this.create(a)}))}update(t,e){return B(this,void 0,void 0,(function*(){return yield this.context.rawQuery(`/global-storage/${t}`,{method:"PUT",body:e})}))}updateValue(t,e){return B(this,void 0,void 0,(function*(){const i=yield this.context.rawQuery(`/global-storage/${t}`);return i.value=JSON.stringify(e),yield this.context.rawQuery(`/global-storage/${t}`,{method:"PUT",body:i})}))}delete(t){return B(this,void 0,void 0,(function*(){yield this.context.rawQuery(`/global-storage/${t}`,{method:"DELETE"})}))}}class G{constructor(t){this.context=t,this.globalStorage=new Y(this)}get userId(){return this.context.userId}rawQuery(t,e={}){return i=this,n=void 0,r=function*(){return this.context.rawQuery(`${G.relativeApiPath}${t}`,e)},new((s=void 0)||(s=Promise))((function(t,e){function a(t){try{u(r.next(t))}catch(t){e(t)}}function o(t){try{u(r.throw(t))}catch(t){e(t)}}function u(e){var i;e.done?t(e.value):(i=e.value,i instanceof s?i:new s((function(t){t(i)}))).then(a,o)}u((r=r.apply(i,n||[])).next())}));var i,n,s,r}}G.relativeApiPath="/rationai";const K=G;class X extends v{constructor(t){super(t),this.version="v3",this.rootURI=this.options.apiUrl+X.apiPath,this.raw=new o(this.rootURI),this.scopes=new Q(this),this.rationai=new K(this),this.apps=new g(this),this.cases=new P(this),this.examinations=new k(this),this.slides=new L(this)}rawQuery(t,e={}){const i=Object.create(null,{rawQuery:{get:()=>super.rawQuery}});return n=this,s=void 0,a=function*(){return yield i.rawQuery.call(this,t,e),(e=e||{}).headers=e.headers||{},e.headers["User-Id"]=this.userId,this.accessToken&&(e.headers.Authorization=e.headers.Authorization||`Bearer ${this.rawToken}`),this.raw.http(t,e)},new((r=void 0)||(r=Promise))((function(t,e){function i(t){try{u(a.next(t))}catch(t){e(t)}}function o(t){try{u(a.throw(t))}catch(t){e(t)}}function u(e){var n;e.done?t(e.value):(n=e.value,n instanceof r?n:new r((function(t){t(n)}))).then(i,o)}u((a=a.apply(n,s||[])).next())}));var n,s,r,a}}X.apiPath="/v3";const Z=X;EmpationAPI=e})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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VyxDQUFDLEdBQ2RXLFFBQVVYLEVBQVFXLFNBQVcsQ0FBQyxFQUN0Q1gsRUFBUVcsUUFBUSxXQUFhdkUsS0FBSzRILE9BQzlCNUgsS0FBSzhHLGNBQ0xsRCxFQUFRVyxRQUF1QixjQUFJWCxFQUFRVyxRQUF1QixlQUFLLFVBQVV2RSxLQUFLK0gsWUFFbkYvSCxLQUFLNFIsSUFBSTdNLEtBQUtDLEVBQVVwQixFQUNuQyxFLGdTQXRDTyxFQUFBaU8sUUFBVSxNIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vRW1wYXRpb25BUEkvd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vRW1wYXRpb25BUEkvd2VicGFjay9ydW50aW1lL2RlZmluZSBwcm9wZXJ0eSBnZXR0ZXJzIiwid2VicGFjazovL0VtcGF0aW9uQVBJL3dlYnBhY2svcnVudGltZS9oYXNPd25Qcm9wZXJ0eSBzaG9ydGhhbmQiLCJ3ZWJwYWNrOi8vRW1wYXRpb25BUEkvd2VicGFjay9ydW50aW1lL21ha2UgbmFtZXNwYWNlIG9iamVjdCIsIndlYnBhY2s6Ly9FbXBhdGlvbkFQSS8uL3NyYy9ldmVudHMudHMiLCJ3ZWJwYWNrOi8vRW1wYXRpb25BUEkvLi9zcmMvc3RhdHVzLWNvZGVzLnRzIiwid2VicGFjazovL0VtcGF0aW9uQVBJLy4vc3JjL2Jhc2UudHMiLCJ3ZWJwYWNrOi8vRW1wYXRpb25BUEkvLi9zcmMvdXRpbHMudHMiLCJ3ZWJwYWNrOi8vRW1wYXRpb25BUEkvLi9zcmMvcm9vdC50cyIsIndlYnBhY2s6Ly9FbXBhdGlvbkFQSS8uL3NyYy9zY29wZS50cyIsIndlYnBhY2s6Ly9FbXBhdGlvbkFQSS8uL3NyYy92My9yb290L2FwcHMudHMiLCJ3ZWJwYWNrOi8vRW1wYXRpb25BUEkvLi9zcmMvdjMvZXh0ZW5zaW9ucy91dGlscy50cyIsIndlYnBhY2s6Ly9FbXBhdGlvbkFQSS8uL3NyYy92My9leHRlbnNpb25zL2Nhc2UtZXhwbG9yZXIudHMiLCJ3ZWJwYWNrOi8vRW1wYXRpb25BUEkvLi9zcmMvdjMvZXh0ZW5zaW9ucy93c2ktZXhwbG9yZXIudHMiLCJ3ZWJwYWNrOi8vRW1wYXRpb25BUEkvLi9zcmMvdjMvcm9vdC9jYXNlcy50cyIsIndlYnBhY2s6Ly9FbXBhdGlvbkFQSS8uL3NyYy92My9yb290L2V4YW1pbmF0aW9ucy50cyIsIndlYnBhY2s6Ly9FbXBhdGlvbkFQSS8uL3NyYy92My9zY29wZS9zdG9yYWdlLnRzIiwid2VicGFjazovL0VtcGF0aW9uQVBJLy4vc3JjL3YzL3Njb3BlL2Fubm90YXRpb25zLnRzIiwid2VicGFjazovL0VtcGF0aW9uQVBJLy4vc3JjL3YzL3Njb3BlL2NvbGxlY3Rpb25zLnRzIiwid2VicGFjazovL0VtcGF0aW9uQVBJLy4vc3JjL3YzL3Njb3BlL3Njb3Blcy50cyIsIndlYnBhY2s6Ly9FbXBhdGlvbkFQSS8uL3NyYy92My9yYXRpb25haS90eXBlcy9nbG9iYWwtZGF0YS1jcmVhdG9yLXR5cGUudHMiLCJ3ZWJwYWNrOi8vRW1wYXRpb25BUEkvLi9zcmMvdjMvcmF0aW9uYWkvdHlwZXMvZ2xvYmFsLWl0ZW0tcmVmZXJlbmNlLXR5cGUudHMiLCJ3ZWJwYWNrOi8vRW1wYXRpb25BUEkvLi9zcmMvdjMvZXh0ZW5zaW9ucy90eXBlcy90ZW1wbGF0ZS10eXBlLnRzIiwid2VicGFjazovL0VtcGF0aW9uQVBJLy4vc3JjL3YzL3Jvb3Qvc2xpZGVzLnRzIiwid2VicGFjazovL0VtcGF0aW9uQVBJLy4vc3JjL3YzL2V4dGVuc2lvbnMvd3NpLW1ldGFkYXRhLnRzIiwid2VicGFjazovL0VtcGF0aW9uQVBJLy4vc3JjL3YzL2V4dGVuc2lvbnMvdmlzdWFsaXphdGlvbi10ZW1wbGF0ZXMudHMiLCJ3ZWJwYWNrOi8vRW1wYXRpb25BUEkvLi9zcmMvdjMvcmF0aW9uYWkvZ2xvYmFsLXN0b3JhZ2UudHMiLCJ3ZWJwYWNrOi8vRW1wYXRpb25BUEkvLi9zcmMvdjMvcmF0aW9uYWkvcmF0aW9uYWkudHMiLCJ3ZWJwYWNrOi8vRW1wYXRpb25BUEkvLi9zcmMvdjMvcm9vdC9yb290LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIFRoZSByZXF1aXJlIHNjb3BlXG52YXIgX193ZWJwYWNrX3JlcXVpcmVfXyA9IHt9O1xuXG4iLCIvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9ucyBmb3IgaGFybW9ueSBleHBvcnRzXG5fX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSAoZXhwb3J0cywgZGVmaW5pdGlvbikgPT4ge1xuXHRmb3IodmFyIGtleSBpbiBkZWZpbml0aW9uKSB7XG5cdFx0aWYoX193ZWJwYWNrX3JlcXVpcmVfXy5vKGRlZmluaXRpb24sIGtleSkgJiYgIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBrZXkpKSB7XG5cdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywga2V5LCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZGVmaW5pdGlvbltrZXldIH0pO1xuXHRcdH1cblx0fVxufTsiLCJfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSAob2JqLCBwcm9wKSA9PiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iaiwgcHJvcCkpIiwiLy8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuX193ZWJwYWNrX3JlcXVpcmVfXy5yID0gKGV4cG9ydHMpID0+IHtcblx0aWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7XG5cdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFN5bWJvbC50b1N0cmluZ1RhZywgeyB2YWx1ZTogJ01vZHVsZScgfSk7XG5cdH1cblx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbn07IiwiLyoqXHJcbiAqIE9wZW5TZWFkcmFnb24gaW5zcGlyZWQgZXZlbnQgc3lzdGVtIGZvciByZWR1Y3Rpb24gb2YgZGVwZW5kZW5jaWVzIGFuZCB1bmlmb3JtIGV2ZW50IGFwcHJvYWNoXHJcbiAqL1xyXG5cclxuZXhwb3J0IHR5cGUgRXZlbnRIYW5kbGVyID0gKGV2ZW50OiBvYmplY3QpID0+IHZvaWQ7XHJcblxyXG5leHBvcnQgY2xhc3MgRXZlbnRTb3VyY2Uge1xyXG4gICAgZXZlbnRzOiB7W2tleTogc3RyaW5nXTogYW55fSA9IHt9O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogQWRkIGFuIGV2ZW50IGhhbmRsZXIgdG8gYmUgdHJpZ2dlcmVkIG9ubHkgb25jZSAob3IgYSBnaXZlbiBudW1iZXIgb2YgdGltZXMpXHJcbiAgICAgKiBmb3IgYSBnaXZlbiBldmVudC4gSXQgaXMgbm90IHJlbW92YWJsZSB3aXRoIHJlbW92ZUhhbmRsZXIoKS5cclxuICAgICAqIEBmdW5jdGlvblxyXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IGV2ZW50TmFtZSAtIE5hbWUgb2YgZXZlbnQgdG8gcmVnaXN0ZXIuXHJcbiAgICAgKiBAcGFyYW0ge0V2ZW50SGFuZGxlcn0gaGFuZGxlciAtIEZ1bmN0aW9uIHRvIGNhbGwgd2hlbiBldmVudFxyXG4gICAgICogaXMgdHJpZ2dlcmVkLlxyXG4gICAgICogQHBhcmFtIHtPYmplY3R9IFt1c2VyRGF0YT1udWxsXSAtIEFyYml0cmFyeSBvYmplY3QgdG8gYmUgcGFzc2VkIHVuY2hhbmdlZFxyXG4gICAgICogdG8gdGhlIGhhbmRsZXIuXHJcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW3RpbWVzPTFdIC0gVGhlIG51bWJlciBvZiB0aW1lcyB0byBoYW5kbGUgdGhlIGV2ZW50XHJcbiAgICAgKiBiZWZvcmUgcmVtb3ZpbmcgaXQuXHJcbiAgICAgKiBAcGFyYW0ge051bWJlcn0gW3ByaW9yaXR5PTBdIC0gSGFuZGxlciBwcmlvcml0eS4gQnkgZGVmYXVsdCwgYWxsIHByaW9yaXRpZXMgYXJlIDAuIEhpZ2hlciBudW1iZXIgPSBwcmlvcml0eS5cclxuICAgICAqL1xyXG4gICAgYWRkT25jZUhhbmRsZXIoZXZlbnROYW1lOiBzdHJpbmcsIGhhbmRsZXI6IEV2ZW50SGFuZGxlciwgdXNlckRhdGE6IG9iamVjdCwgdGltZXM6IG51bWJlciwgcHJpb3JpdHk6IG51bWJlcikge1xyXG4gICAgICAgIGNvbnN0IHNlbGYgPSB0aGlzO1xyXG4gICAgICAgIHRpbWVzID0gdGltZXMgfHwgMTtcclxuICAgICAgICBsZXQgY291bnQgPSAwO1xyXG4gICAgICAgIGNvbnN0IG9uY2VIYW5kbGVyID0gZnVuY3Rpb24oZXZlbnQ6IG9iamVjdCkge1xyXG4gICAgICAgICAgICBjb3VudCsrO1xyXG4gICAgICAgICAgICBpZiAoY291bnQgPT09IHRpbWVzKSB7XHJcbiAgICAgICAgICAgICAgICBzZWxmLnJlbW92ZUhhbmRsZXIoZXZlbnROYW1lLCBvbmNlSGFuZGxlcik7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGhhbmRsZXIoZXZlbnQpO1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5hZGRIYW5kbGVyKGV2ZW50TmFtZSwgb25jZUhhbmRsZXIsIHVzZXJEYXRhLCBwcmlvcml0eSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBBZGQgYW4gZXZlbnQgaGFuZGxlciBmb3IgYSBnaXZlbiBldmVudC5cclxuICAgICAqIEBmdW5jdGlvblxyXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IGV2ZW50TmFtZSAtIE5hbWUgb2YgZXZlbnQgdG8gcmVnaXN0ZXIuXHJcbiAgICAgKiBAcGFyYW0ge0V2ZW50SGFuZGxlcn0gaGFuZGxlciAtIEZ1bmN0aW9uIHRvIGNhbGwgd2hlbiBldmVudCBpcyB0cmlnZ2VyZWQuXHJcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gW3VzZXJEYXRhPW51bGxdIC0gQXJiaXRyYXJ5IG9iamVjdCB0byBiZSBwYXNzZWQgdW5jaGFuZ2VkIHRvIHRoZSBoYW5kbGVyLlxyXG4gICAgICogQHBhcmFtIHtOdW1iZXJ9IFtwcmlvcml0eT0wXSAtIEhhbmRsZXIgcHJpb3JpdHkuIEJ5IGRlZmF1bHQsIGFsbCBwcmlvcml0aWVzIGFyZSAwLiBIaWdoZXIgbnVtYmVyID0gcHJpb3JpdHkuXHJcbiAgICAgKi9cclxuICAgIGFkZEhhbmRsZXIoZXZlbnROYW1lOiBzdHJpbmcsIGhhbmRsZXI6IEV2ZW50SGFuZGxlciwgdXNlckRhdGE6IG9iamVjdCwgcHJpb3JpdHk6IG51bWJlcikge1xyXG4gICAgICAgIGxldCBldmVudHMgPSB0aGlzLmV2ZW50c1sgZXZlbnROYW1lIF07XHJcbiAgICAgICAgaWYgKCAhZXZlbnRzICkge1xyXG4gICAgICAgICAgICB0aGlzLmV2ZW50c1sgZXZlbnROYW1lIF0gPSBldmVudHMgPSBbXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKCBoYW5kbGVyICYmIEV2ZW50U291cmNlLmlzRnVuY3Rpb24oIGhhbmRsZXIgKSApIHtcclxuICAgICAgICAgICAgbGV0IGluZGV4ID0gZXZlbnRzLmxlbmd0aCxcclxuICAgICAgICAgICAgICAgIGV2ZW50ID0geyBoYW5kbGVyOiBoYW5kbGVyLCB1c2VyRGF0YTogdXNlckRhdGEgfHwgbnVsbCwgcHJpb3JpdHk6IHByaW9yaXR5IHx8IDAgfTtcclxuICAgICAgICAgICAgZXZlbnRzWyBpbmRleCBdID0gZXZlbnQ7XHJcbiAgICAgICAgICAgIHdoaWxlICggaW5kZXggPiAwICYmIGV2ZW50c1sgaW5kZXggLSAxIF0ucHJpb3JpdHkgPCBldmVudHNbIGluZGV4IF0ucHJpb3JpdHkgKSB7XHJcbiAgICAgICAgICAgICAgICBldmVudHNbIGluZGV4IF0gPSBldmVudHNbIGluZGV4IC0gMSBdO1xyXG4gICAgICAgICAgICAgICAgZXZlbnRzWyBpbmRleCAtIDEgXSA9IGV2ZW50O1xyXG4gICAgICAgICAgICAgICAgaW5kZXgtLTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFJlbW92ZSBhIHNwZWNpZmljIGV2ZW50IGhhbmRsZXIgZm9yIGEgZ2l2ZW4gZXZlbnQuXHJcbiAgICAgKiBAZnVuY3Rpb25cclxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBldmVudE5hbWUgLSBOYW1lIG9mIGV2ZW50IGZvciB3aGljaCB0aGUgaGFuZGxlciBpcyB0byBiZSByZW1vdmVkLlxyXG4gICAgICogQHBhcmFtIHtFdmVudEhhbmRsZXJ9IGhhbmRsZXIgLSBGdW5jdGlvbiB0byBiZSByZW1vdmVkLlxyXG4gICAgICovXHJcbiAgICByZW1vdmVIYW5kbGVyKGV2ZW50TmFtZTogc3RyaW5nLCBoYW5kbGVyOiBFdmVudEhhbmRsZXIpIHtcclxuICAgICAgICBjb25zdCBldmVudHMgPSB0aGlzLmV2ZW50c1sgZXZlbnROYW1lIF0sXHJcbiAgICAgICAgICAgIGhhbmRsZXJzOiBFdmVudEhhbmRsZXJbXSA9IFtdO1xyXG4gICAgICAgIGlmICggIWV2ZW50cyApIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIEFycmF5LmlzQXJyYXkoIGV2ZW50cyApICkge1xyXG4gICAgICAgICAgICBmb3IgKCBsZXQgaSA9IDA7IGkgPCBldmVudHMubGVuZ3RoOyBpKysgKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoIGV2ZW50c1tpXS5oYW5kbGVyICE9PSBoYW5kbGVyICkge1xyXG4gICAgICAgICAgICAgICAgICAgIGhhbmRsZXJzLnB1c2goIGV2ZW50c1sgaSBdICk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgdGhpcy5ldmVudHNbIGV2ZW50TmFtZSBdID0gaGFuZGxlcnM7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogR2V0IHRoZSBhbW91bnQgb2YgaGFuZGxlcnMgcmVnaXN0ZXJlZCBmb3IgYSBnaXZlbiBldmVudC5cclxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBldmVudE5hbWUgLSBOYW1lIG9mIGV2ZW50IHRvIGluc3BlY3QuXHJcbiAgICAgKiBAcmV0dXJucyB7bnVtYmVyfSBhbW91bnQgb2YgZXZlbnRzXHJcbiAgICAgKi9cclxuICAgIG51bWJlck9mSGFuZGxlcnMoZXZlbnROYW1lOiBzdHJpbmcpIHtcclxuICAgICAgICBjb25zdCBldmVudHMgPSB0aGlzLmV2ZW50c1sgZXZlbnROYW1lIF07XHJcbiAgICAgICAgaWYgKCAhZXZlbnRzICkge1xyXG4gICAgICAgICAgICByZXR1cm4gMDtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIGV2ZW50cy5sZW5ndGg7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBSZW1vdmUgYWxsIGV2ZW50IGhhbmRsZXJzIGZvciBhIGdpdmVuIGV2ZW50IHR5cGUuIElmIG5vIHR5cGUgaXMgZ2l2ZW4gYWxsXHJcbiAgICAgKiBldmVudCBoYW5kbGVycyBmb3IgZXZlcnkgZXZlbnQgdHlwZSBhcmUgcmVtb3ZlZC5cclxuICAgICAqIEBmdW5jdGlvblxyXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IGV2ZW50TmFtZSAtIE5hbWUgb2YgZXZlbnQgZm9yIHdoaWNoIGFsbCBoYW5kbGVycyBhcmUgdG8gYmUgcmVtb3ZlZC5cclxuICAgICAqL1xyXG4gICAgcmVtb3ZlQWxsSGFuZGxlcnMoZXZlbnROYW1lOiBzdHJpbmcpIHtcclxuICAgICAgICBpZiAoIGV2ZW50TmFtZSApe1xyXG4gICAgICAgICAgICB0aGlzLmV2ZW50c1sgZXZlbnROYW1lIF0gPSBbXTtcclxuICAgICAgICB9IGVsc2V7XHJcbiAgICAgICAgICAgIGZvciAoIGNvbnN0IGV2ZW50VHlwZSBpbiB0aGlzLmV2ZW50cyApIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuZXZlbnRzWyBldmVudFR5cGUgXSA9IFtdO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogR2V0IGEgZnVuY3Rpb24gd2hpY2ggaXRlcmF0ZXMgdGhlIGxpc3Qgb2YgYWxsIGhhbmRsZXJzIHJlZ2lzdGVyZWQgZm9yIGEgZ2l2ZW4gZXZlbnQsIGNhbGxpbmcgdGhlIGhhbmRsZXIgZm9yIGVhY2guXHJcbiAgICAgKiBAZnVuY3Rpb25cclxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBldmVudE5hbWUgLSBOYW1lIG9mIGV2ZW50IHRvIGdldCBoYW5kbGVycyBmb3IuXHJcbiAgICAgKi9cclxuICAgIGdldEhhbmRsZXIoZXZlbnROYW1lOiBzdHJpbmcpIHtcclxuICAgICAgICBsZXQgZXZlbnRzID0gdGhpcy5ldmVudHNbIGV2ZW50TmFtZSBdO1xyXG4gICAgICAgIGlmICggIWV2ZW50cyB8fCAhZXZlbnRzLmxlbmd0aCApIHtcclxuICAgICAgICAgICAgcmV0dXJuIG51bGw7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGV2ZW50cyA9IGV2ZW50cy5sZW5ndGggPT09IDEgP1xyXG4gICAgICAgICAgICBbIGV2ZW50c1sgMCBdIF0gOlxyXG4gICAgICAgICAgICBBcnJheS5hcHBseSggbnVsbCwgZXZlbnRzICk7XHJcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICggc291cmNlOiBhbnksIGFyZ3M6IGFueSApIHtcclxuICAgICAgICAgICAgbGV0IGksXHJcbiAgICAgICAgICAgICAgICBsZW5ndGggPSBldmVudHMubGVuZ3RoO1xyXG4gICAgICAgICAgICBmb3IgKCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrICkge1xyXG4gICAgICAgICAgICAgICAgaWYgKCBldmVudHNbIGkgXSApIHtcclxuICAgICAgICAgICAgICAgICAgICBhcmdzLmV2ZW50U291cmNlID0gc291cmNlO1xyXG4gICAgICAgICAgICAgICAgICAgIGFyZ3MudXNlckRhdGEgPSBldmVudHNbIGkgXS51c2VyRGF0YTtcclxuICAgICAgICAgICAgICAgICAgICBldmVudHNbIGkgXS5oYW5kbGVyKCBhcmdzICk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIC8qKlxyXG4gICAgICogR2V0IGEgZnVuY3Rpb24gd2hpY2ggaXRlcmF0ZXMgdGhlIGxpc3Qgb2YgYWxsIGhhbmRsZXJzIHJlZ2lzdGVyZWQgZm9yIGEgZ2l2ZW4gZXZlbnQsXHJcbiAgICAgKiBjYWxsaW5nIHRoZSBoYW5kbGVyIGZvciBlYWNoIGFuZCBhd2FpdGluZyBhc3luYyBvbmVzLlxyXG4gICAgICogQGZ1bmN0aW9uXHJcbiAgICAgKiBAcGFyYW0ge1N0cmluZ30gZXZlbnROYW1lIC0gTmFtZSBvZiBldmVudCB0byBnZXQgaGFuZGxlcnMgZm9yLlxyXG4gICAgICovXHJcbiAgICBnZXRBd2FpdGluZ0hhbmRsZXIoIGV2ZW50TmFtZSkge1xyXG4gICAgICAgIGxldCBldmVudHMgPSB0aGlzLmV2ZW50c1sgZXZlbnROYW1lIF07XHJcbiAgICAgICAgaWYgKCAhZXZlbnRzIHx8ICFldmVudHMubGVuZ3RoICkge1xyXG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcclxuICAgICAgICB9XHJcbiAgICAgICAgZXZlbnRzID0gZXZlbnRzLmxlbmd0aCA9PT0gMSA/XHJcbiAgICAgICAgICAgIFsgZXZlbnRzWyAwIF0gXSA6XHJcbiAgICAgICAgICAgIEFycmF5LmFwcGx5KCBudWxsLCBldmVudHMgKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICggc291cmNlLCBhcmdzICkge1xyXG4gICAgICAgICAgICAvLyBXZSByZXR1cm4gYSBwcm9taXNlIHRoYXQgZ2V0cyByZXNvbHZlZCBhZnRlciBhbGwgdGhlIGV2ZW50cyBmaW5pc2guXHJcbiAgICAgICAgICAgIC8vIFJldHVybmluZyBsb29wIHJlc3VsdCBpcyBub3QgY29ycmVjdCwgbG9vcCBwcm9taXNlcyBjaGFpbiBkeW5hbWljYWxseVxyXG4gICAgICAgICAgICAvLyBhbmQgb3V0ZXIgY29kZSBjb3VsZCBwcm9jZXNzIGZpbmlzaGluZyBsb2dpY3MgaW4gdGhlIG1pZGRsZSBvZiBldmVudCBsb29wLlxyXG4gICAgICAgICAgICByZXR1cm4gbmV3IFByb21pc2UocmVzb2x2ZSA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBsZW5ndGggPSBldmVudHMubGVuZ3RoO1xyXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gbG9vcChpbmRleCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICggaW5kZXggPj0gbGVuZ3RoIHx8ICFldmVudHNbIGluZGV4IF0gKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc29sdmUoXCJSZXNvbHZlZCFcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBudWxsO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBhcmdzLmV2ZW50U291cmNlID0gc291cmNlO1xyXG4gICAgICAgICAgICAgICAgICAgIGFyZ3MudXNlckRhdGEgPSBldmVudHNbIGluZGV4IF0udXNlckRhdGE7XHJcbiAgICAgICAgICAgICAgICAgICAgbGV0IHJlc3VsdCA9IGV2ZW50c1sgaW5kZXggXS5oYW5kbGVyKCBhcmdzICk7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gKCFyZXN1bHQgfHwgRXZlbnRTb3VyY2UudHlwZShyZXN1bHQpICE9PSBcInByb21pc2VcIikgPyBQcm9taXNlLnJlc29sdmUoKSA6IHJlc3VsdDtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0LnRoZW4oKCkgPT4gbG9vcChpbmRleCArIDEpKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGxvb3AoMCk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH07XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBUcmlnZ2VyIGFuIGV2ZW50LCBvcHRpb25hbGx5IHBhc3NpbmcgYWRkaXRpb25hbCBpbmZvcm1hdGlvbi5cclxuICAgICAqIEBmdW5jdGlvblxyXG4gICAgICogQHBhcmFtIHtTdHJpbmd9IGV2ZW50TmFtZSAtIE5hbWUgb2YgZXZlbnQgdG8gcmVnaXN0ZXIuXHJcbiAgICAgKiBAcGFyYW0ge09iamVjdH0gZXZlbnRBcmdzIC0gRXZlbnQtc3BlY2lmaWMgZGF0YS5cclxuICAgICAqL1xyXG4gICAgcmFpc2VFdmVudCggZXZlbnROYW1lOiBzdHJpbmcsIGV2ZW50QXJncz86IGFueSApIHtcclxuICAgICAgICBjb25zdCBoYW5kbGVyID0gdGhpcy5nZXRIYW5kbGVyKCBldmVudE5hbWUgKTtcclxuICAgICAgICBpZiAoIGhhbmRsZXIgKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBoYW5kbGVyKCB0aGlzLCBldmVudEFyZ3MgfHwge30gKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcclxuICAgIH1cclxuXHJcbiAgICAvKipcclxuICAgICAqIFRyaWdnZXIgYW4gZXZlbnQsIG9wdGlvbmFsbHkgcGFzc2luZyBhZGRpdGlvbmFsIGluZm9ybWF0aW9uLlxyXG4gICAgICogVGhpcyBldmVudHMgYXdhaXRzIGV2ZXJ5IGFzeW5jaHJvbm91cyBvciBwcm9taXNlLXJldHVybmluZyBmdW5jdGlvbi5cclxuICAgICAqIEBwYXJhbSB7U3RyaW5nfSBldmVudE5hbWUgLSBOYW1lIG9mIGV2ZW50IHRvIHJlZ2lzdGVyLlxyXG4gICAgICogQHBhcmFtIHtPYmplY3R9IGV2ZW50QXJncyAtIEV2ZW50LXNwZWNpZmljIGRhdGEuXHJcbiAgICAgKiBAcmV0dXJuIHtQcm9taXNlfHVuZGVmaW5lZH0gLSBQcm9taXNlIHJlc29sdmVkIHVwb24gdGhlIGV2ZW50IGNvbXBsZXRpb24uXHJcbiAgICAgKi9cclxuICAgIHJhaXNlRXZlbnRBd2FpdGluZyggZXZlbnROYW1lLCBldmVudEFyZ3MgKSB7XHJcbiAgICAgICAgLy91bmNvbW1lbnQgaWYgeW91IHdhbnQgdG8gZ2V0IGEgbG9nIG9mIGFsbCBldmVudHNcclxuICAgICAgICAvLyQuY29uc29sZS5sb2coIFwiQXdhaXRpbmcgZXZlbnQgZmlyZWQ6XCIsIGV2ZW50TmFtZSApO1xyXG5cclxuICAgICAgICBjb25zdCBhd2FpdGluZ0hhbmRsZXIgPSB0aGlzLmdldEF3YWl0aW5nSGFuZGxlcihldmVudE5hbWUpO1xyXG4gICAgICAgIGlmIChhd2FpdGluZ0hhbmRsZXIpIHtcclxuICAgICAgICAgICAgcmV0dXJuIGF3YWl0aW5nSGFuZGxlcih0aGlzLCBldmVudEFyZ3MgfHwge30pO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKFwiTm8gaGFuZGxlciBmb3IgdGhpcyBldmVudCByZWdpc3RlcmVkLlwiKTtcclxuICAgIH1cclxuXHJcbiAgICBzdGF0aWMgY2xhc3MydHlwZSA9IHtcclxuICAgICAgICAnW29iamVjdCBCb29sZWFuXSc6ICAgICAgICdib29sZWFuJyxcclxuICAgICAgICAnW29iamVjdCBOdW1iZXJdJzogICAgICAgICdudW1iZXInLFxyXG4gICAgICAgICdbb2JqZWN0IFN0cmluZ10nOiAgICAgICAgJ3N0cmluZycsXHJcbiAgICAgICAgJ1tvYmplY3QgRnVuY3Rpb25dJzogICAgICAnZnVuY3Rpb24nLFxyXG4gICAgICAgICdbb2JqZWN0IEFzeW5jRnVuY3Rpb25dJzogJ2Z1bmN0aW9uJyxcclxuICAgICAgICAnW29iamVjdCBQcm9taXNlXSc6ICAgICAgICdwcm9taXNlJyxcclxuICAgICAgICAnW29iamVjdCBBcnJheV0nOiAgICAgICAgICdhcnJheScsXHJcbiAgICAgICAgJ1tvYmplY3QgRGF0ZV0nOiAgICAgICAgICAnZGF0ZScsXHJcbiAgICAgICAgJ1tvYmplY3QgUmVnRXhwXSc6ICAgICAgICAncmVnZXhwJyxcclxuICAgICAgICAnW29iamVjdCBPYmplY3RdJzogICAgICAgICdvYmplY3QnXHJcbiAgICB9O1xyXG5cclxuICAgIC8qKlxyXG4gICAgICogVGFrZW4gZnJvbSBqUXVlcnkgMS42LjFcclxuICAgICAqIEBmdW5jdGlvbiBpc0Z1bmN0aW9uXHJcbiAgICAgKiBAbWVtYmVyb2YgT3BlblNlYWRyYWdvblxyXG4gICAgICogQHNlZSB7QGxpbmsgaHR0cDovL3d3dy5qcXVlcnkuY29tLyBqUXVlcnl9XHJcbiAgICAgKi9cclxuICAgIHN0YXRpYyBpc0Z1bmN0aW9uKCBvYmo6IG9iamVjdCApIHtcclxuICAgICAgICByZXR1cm4gdGhpcy50eXBlKG9iaikgPT09IFwiZnVuY3Rpb25cIjtcclxuICAgIH07XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBUYWtlbiBmcm9tIGpRdWVyeSAxLjYuMVxyXG4gICAgICogQGZ1bmN0aW9uIHR5cGVcclxuICAgICAqIEBtZW1iZXJvZiBPcGVuU2VhZHJhZ29uXHJcbiAgICAgKiBAc2VlIHtAbGluayBodHRwOi8vd3d3LmpxdWVyeS5jb20vIGpRdWVyeX1cclxuICAgICAqL1xyXG4gICAgc3RhdGljIHR5cGUoIG9iajogb2JqZWN0ICkge1xyXG4gICAgICAgIHJldHVybiAoIG9iaiA9PT0gbnVsbCApIHx8ICggb2JqID09PSB1bmRlZmluZWQgKSA/XHJcbiAgICAgICAgICAgIFN0cmluZyggb2JqICkgOlxyXG4gICAgICAgICAgICB0aGlzLmNsYXNzMnR5cGVbIG9iai50b1N0cmluZygpIGFzIGtleW9mIHR5cGVvZiB0aGlzLmNsYXNzMnR5cGVdIHx8ICh0eXBlb2Yob2JqKSA9PT0gJ2Z1bmN0aW9uJyA/IFwiZnVuY3Rpb25cIiA6IFwib2JqZWN0XCIpXHJcbiAgICB9O1xyXG59XHJcbiIsIi8vIFNvdXJjZTogaHR0cHM6Ly9naXRodWIuY29tL3ByZXR0eW11Y2hicnljZS9odHRwLXN0YXR1cy1jb2Rlcy9ibG9iL21hc3Rlci9zcmMvc3RhdHVzLWNvZGVzLnRzXHJcbmV4cG9ydCBjb25zdCBTVEFUVVNfQ09ERVMgPSB7XHJcbiAgICAxMDA6ICdDb250aW51ZScsXHJcbiAgICAxMDE6ICdTd2l0Y2hpbmcgcHJvdG9jb2xzJyxcclxuICAgIDEwMjogJ1Byb2Nlc3NpbmcnLFxyXG4gICAgMTAzOiAnRWFybHkgSGludHMnLFxyXG4gICAgMjAwOiAnT2snLFxyXG4gICAgMjAxOiAnQ3JlYXRlZCcsXHJcbiAgICAyMDI6ICdBY2NlcHRlZCcsXHJcbiAgICAyMDM6ICdOb24gQXV0aG9yaXRhdGl2ZSBJbmZvcm1hdGlvbicsXHJcbiAgICAyMDQ6ICdObyBDb250ZW50JyxcclxuICAgIDIwNTogJ1Jlc2V0IENvbnRlbnQnLFxyXG4gICAgMjA2OiAnUGFydGlhbCBDb250ZW50JyxcclxuICAgIDIwNzogJ011bHRpIFN0YXR1cycsXHJcbiAgICAzMDA6ICdNdWx0aXBsZSBDaG9pY2VzJyxcclxuICAgIDMwMTogJ01vdmVkIFBlcm1hbmVudGx5JyxcclxuICAgIDMwMjogJ01vdmVkIFRlbXBvcmFyaWx5JyxcclxuICAgIDMwMzogJ1NlZSBPdGhlcicsXHJcbiAgICAzMDQ6ICdOb3QgTW9kaWZpZWQnLFxyXG4gICAgMzA1OiAnVXNlIFByb3h5JyxcclxuICAgIDMwNzogJ1RlbXBvcmFyeSBSZWRpcmVjdCcsXHJcbiAgICAzMDg6ICdQZXJtYW5lbnQgUmVkaXJlY3QnLFxyXG4gICAgNDAwOiAnQmFkIFJlcXVlc3QnLFxyXG4gICAgNDAxOiAnVW5hdXRob3JpemVkJyxcclxuICAgIDQwMjogJ1BheW1lbnQgUmVxdWlyZWQnLFxyXG4gICAgNDAzOiAnRm9yYmlkZGVuJyxcclxuICAgIDQwNDogJ05vdCBGb3VuZCcsXHJcbiAgICA0MDU6ICdNZXRob2QgTm90IEFsbG93ZWQnLFxyXG4gICAgNDA2OiAnTm90IEFjY2VwdGFibGUnLFxyXG4gICAgNDA3OiAnUHJveHkgQXV0aGVudGljYXRpb24gUmVxdWlyZWQnLFxyXG4gICAgNDA4OiAnUmVxdWVzdCBUaW1lb3V0JyxcclxuICAgIDQwOTogJ0NvbmZsaWN0JyxcclxuICAgIDQxMDogJ0dvbmUnLFxyXG4gICAgNDExOiAnTGVuZ3RoIFJlcXVpcmVkJyxcclxuICAgIDQxMjogJ1ByZWNvbmRpdGlvbiBGYWlsZWQnLFxyXG4gICAgNDEzOiAnUmVxdWVzdCBUb28gTG9uZycsXHJcbiAgICA0MTQ6ICdSZXF1ZXN0IFVyaSBUb28gTG9uZycsXHJcbiAgICA0MTU6ICdVbnN1cHBvcnRlZCBNZWRpYSBUeXBlJyxcclxuICAgIDQxNjogJ1JlcXVlc3RlZCBSYW5nZSBOb3QgU2F0aXNmaWFibGUnLFxyXG4gICAgNDE3OiAnRXhwZWN0YXRpb24gRmFpbGVkJyxcclxuICAgIC8qKlxyXG4gICAgICogT2ZmaWNpYWwgRG9jdW1lbnRhdGlvbiBAIGh0dHBzOi8vdG9vbHMuaWV0Zi5vcmcvaHRtbC9yZmMyMzI0I3NlY3Rpb24tMi4zLjJcclxuICAgICAqXHJcbiAgICAgKiBBbnkgYXR0ZW1wdCB0byBicmV3IGNvZmZlZSB3aXRoIGEgdGVhcG90IHNob3VsZCByZXN1bHQgaW4gdGhlIGVycm9yIGNvZGUgXCI0MTggSSdtIGEgdGVhcG90XCIuIFRoZSByZXN1bHRpbmcgZW50aXR5IGJvZHkgTWF5IGJlIHNob3J0IGFuZCBzdG91dC5cclxuICAgICAqL1xyXG4gICAgNDE4OiAnSW0gQSBUZWFwb3QnLFxyXG4gICAgNDE5OiAnSW5zdWZmaWNpZW50IFNwYWNlIE9uIFJlc291cmNlJyxcclxuICAgIDQyMDogJ01ldGhvZCBGYWlsdXJlJyxcclxuICAgIDQyMTogJ01pc2RpcmVjdGVkIFJlcXVlc3QnLFxyXG4gICAgNDIyOiAnVW5wcm9jZXNzYWJsZSBFbnRpdHknLFxyXG4gICAgNDIzOiAnTG9ja2VkJyxcclxuICAgIDQyNDogJ0ZhaWxlZCBEZXBlbmRlbmN5JyxcclxuICAgIDQyNjogJ1VwZ3JhZGUgUmVxdWlyZWQnLFxyXG4gICAgNDI4OiAnUHJlY29uZGl0aW9uIFJlcXVpcmVkJyxcclxuICAgIDQyOTogJ1RvbyBNYW55IFJlcXVlc3RzJyxcclxuICAgIDQzMTogJ1JlcXVlc3QgSGVhZGVyIEZpZWxkcyBUb28gTGFyZ2UnLFxyXG4gICAgNDUxOiAnVW5hdmFpbGFibGUgRm9yIExlZ2FsIFJlYXNvbnMnLFxyXG4gICAgNTAwOiAnSW50ZXJuYWwgU2VydmVyIEVycm9yJyxcclxuICAgIDUwMTogJ05vdCBJbXBsZW1lbnRlZCcsXHJcbiAgICA1MDI6ICdCYWQgR2F0ZXdheScsXHJcbiAgICA1MDM6ICdTZXJ2aWNlIFVuYXZhaWxhYmxlJyxcclxuICAgIDUwNDogJ0dhdGV3YXkgVGltZW91dCcsXHJcbiAgICA1MDU6ICdIdHRwIFZlcnNpb24gTm90IFN1cHBvcnRlZCcsXHJcbiAgICA1MDc6ICdJbnN1ZmZpY2llbnQgU3RvcmFnZScsXHJcbiAgICA1MTE6ICdOZXR3b3JrIEF1dGhlbnRpY2F0aW9uIFJlcXVpcmVkJ1xyXG59O1xyXG4iLCJpbXBvcnQge0V2ZW50U291cmNlfSBmcm9tIFwiLi9ldmVudHNcIjtcclxuaW1wb3J0IHsgU1RBVFVTX0NPREVTIH0gZnJvbSAnLi9zdGF0dXMtY29kZXMnO1xyXG5cclxuZXhwb3J0IGludGVyZmFjZSBFbXBhdGlvbkFQSU9wdGlvbnMge1xyXG4gICAgYW5vbnltb3VzVXNlcklkPzogc3RyaW5nO1xyXG4gICAgd29ya2JlbmNoQXBpVXJsOiBzdHJpbmc7XHJcbiAgICBhcGlSb290UGF0aD86IHN0cmluZztcclxufVxyXG5cclxudHlwZSBSZXNwb25zZVR5cGUgPSBcImpzb25cIiB8IFwiYmxvYlwiIHwgXCJ0ZXh0XCI7XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIFJhd09wdGlvbnMge1xyXG4gICAgYm9keT86IG9iamVjdCB8IHN0cmluZztcclxuICAgIHF1ZXJ5PzogYW55O1xyXG4gICAgbWV0aG9kPzogc3RyaW5nO1xyXG4gICAgaGVhZGVycz86IHtba2V5OiBzdHJpbmddOiBzdHJpbmd9O1xyXG4gICAgcmVzcG9uc2VUeXBlPzogUmVzcG9uc2VUeXBlO1xyXG59XHJcblxyXG4vL2h0dHBzOi8vZ2lzdC5naXRodWIuY29tL1Rvb1RhbGxOYXRlLzRmZDY0MWY4MjBlMTMyNTY5NTQ4N2RmZDg4M2U1Mjg1XHJcbmZ1bmN0aW9uIGh0dHBFcnJvclRvTmFtZShjb2RlOiBudW1iZXIpOiBzdHJpbmcge1xyXG4gICAgY29uc3Qgc3VmZml4ID0gKGNvZGUgLyAxMDAgfCAwKSA9PT0gNCB8fCAoY29kZSAvIDEwMCB8IDApID09PSA1ID8gJ2Vycm9yJyA6ICcnO1xyXG4gICAgbGV0IG5hbWUgPSBgICR7U3RyaW5nKFNUQVRVU19DT0RFU1tjb2RlIGFzIGtleW9mIHR5cGVvZiBTVEFUVVNfQ09ERVNdIHx8IGBIVFRQIENvZGUgJHtjb2RlfWApLnJlcGxhY2UoL2Vycm9yJC9pLCAnJyl9ICR7c3VmZml4fWA7XHJcbiAgICByZXR1cm4gbmFtZS5zcGxpdChcIiBcIikucmVkdWNlKChhY2MsIGMpID0+IGFjY1xyXG4gICAgICAgICsgKGMgPyAoYy5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIGMuc2xpY2UoMSkpIDogXCJcIikpO1xyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgSFRUUEVycm9yIGV4dGVuZHMgRXJyb3Ige1xyXG5cclxuICAgIHN0YXR1c0NvZGU6IG51bWJlcjtcclxuICAgIFtrZXk6IHN0cmluZ106IGFueVxyXG5cclxuICAgIHB1YmxpYyBjb25zdHJ1Y3Rvcihjb2RlOiBudW1iZXIsIG1lc3NhZ2U6IHN0cmluZywgZXh0cmFzPzogUmVjb3JkPHN0cmluZywgYW55Pikge1xyXG4gICAgICAgIHN1cGVyKG1lc3NhZ2UgfHwgU1RBVFVTX0NPREVTW2NvZGUgYXMga2V5b2YgdHlwZW9mIFNUQVRVU19DT0RFU10gfHwgYEhUVFAgQ29kZSAke2NvZGV9YCk7XHJcbiAgICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPj0gMyAmJiBleHRyYXMpIHtcclxuICAgICAgICAgICAgLy8gbm9pbnNwZWN0aW9uIFR5cGVTY3JpcHRWYWxpZGF0ZVR5cGVzXHJcbiAgICAgICAgICAgIE9iamVjdC5hc3NpZ24odGhpcywgZXh0cmFzKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5uYW1lID0gaHR0cEVycm9yVG9OYW1lKGNvZGUpO1xyXG4gICAgICAgIHRoaXMuc3RhdHVzQ29kZSA9IGNvZGU7XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgUmF3QXBpT3B0aW9ucyB7fVxyXG5cclxuZXhwb3J0IGNsYXNzIFJhd0FQSSB7XHJcbiAgICBwdWJsaWMgdXJsOiBzdHJpbmc7XHJcbiAgICBwdWJsaWMgb3B0aW9uczogUmF3T3B0aW9ucztcclxuICAgIGNvbnN0cnVjdG9yKHVybDogc3RyaW5nLCBvcHRpb25zOiBSYXdBcGlPcHRpb25zID0ge30pIHtcclxuICAgICAgICB0aGlzLnVybCA9IHVybDtcclxuICAgICAgICB0aGlzLm9wdGlvbnMgPSBvcHRpb25zO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgX3BhcnNlUXVlcnlQYXJhbXMocGFyYW1zOiBzdHJpbmcgfCB7W2tleTogc3RyaW5nXTogc3RyaW5nfSkge1xyXG4gICAgICAgIGlmIChwYXJhbXMpIHtcclxuICAgICAgICAgICAgaWYgKHR5cGVvZiBwYXJhbXMgPT09IFwic3RyaW5nXCIpIHJldHVybiBwYXJhbXM7XHJcblxyXG4gICAgICAgICAgICAvL2NsZWFudXAgcGxhaW4gb2JqZWN0c1xyXG4gICAgICAgICAgICBpZiAocGFyYW1zLmNvbnN0cnVjdG9yID09PSBPYmplY3QgfHwgcGFyYW1zLmNvbnN0cnVjdG9yID09PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgIGZvciAobGV0IGsgaW4gcGFyYW1zKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdiA9IHBhcmFtc1trXTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodiA9PT0gbnVsbCB8fCB2ID09PSB1bmRlZmluZWQpIGRlbGV0ZSBwYXJhbXNba107XHJcbiAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBgPyR7bmV3IFVSTFNlYXJjaFBhcmFtcyhwYXJhbXMpfWA7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBcIlwiO1xyXG4gICAgfVxyXG5cclxuXHJcbiAgICBwcml2YXRlIGFzeW5jIF9mZXRjaCh1cmw6IHN0cmluZywgb3B0aW9uczogUmF3T3B0aW9ucyk6IFByb21pc2U8YW55PiB7XHJcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCh1cmwsIHtcclxuICAgICAgICAgICAgbWV0aG9kOiBvcHRpb25zLm1ldGhvZCxcclxuICAgICAgICAgICAgaGVhZGVyczogb3B0aW9ucy5oZWFkZXJzLFxyXG4gICAgICAgICAgICBib2R5OiBvcHRpb25zLmJvZHlcclxuICAgICAgICB9IGFzIFJlcXVlc3RJbml0KTtcclxuXHJcbiAgICAgICAgbGV0IHJlc3VsdDtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICByZXN1bHQgPSBhd2FpdCByZXNwb25zZVtvcHRpb25zLnJlc3BvbnNlVHlwZSB8fCBcImpzb25cIl0oKTtcclxuICAgICAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgICAgICAgIHRocm93IG5ldyBIVFRQRXJyb3IoNTAwLFxyXG4gICAgICAgICAgICAgICAgYEZhaWxlZCB0byBwYXJzZSByZXNwb25zZSBkYXRhLiBPcmlnaW5hbCBzdGF0dXM6ICR7cmVzcG9uc2Uuc3RhdHVzfSB8ICR7cmVzcG9uc2Uuc3RhdHVzVGV4dH1gLFxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIHVybDogdXJsLFxyXG4gICAgICAgICAgICAgICAgICAgIGVycm9yOiBlXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICghcmVzcG9uc2Uub2spIHtcclxuICAgICAgICAgICAgdGhyb3cgbmV3IEhUVFBFcnJvcihyZXNwb25zZS5zdGF0dXMsIHJlc3BvbnNlLnN0YXR1c1RleHQsIHJlc3VsdCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICB9XHJcblxyXG4gICAgYXN5bmMgaHR0cChlbmRwb2ludDogc3RyaW5nLCBvcHRpb25zOiBSYXdPcHRpb25zKTogUHJvbWlzZTxhbnk+IHtcclxuICAgICAgICBjb25zdCBoYXNCb2R5ID0gISFvcHRpb25zLmJvZHk7XHJcbiAgICAgICAgb3B0aW9ucy5tZXRob2QgPSBvcHRpb25zLm1ldGhvZCB8fCAoaGFzQm9keSA/IFwiUE9TVFwiIDogXCJHRVRcIik7XHJcbiAgICAgICAgaWYgKCFlbmRwb2ludC5zdGFydHNXaXRoKCcvJykpIHtcclxuICAgICAgICAgICAgZW5kcG9pbnQgPSBgLyR7ZW5kcG9pbnR9YDtcclxuICAgICAgICB9XHJcbiAgICAgICAgb3B0aW9ucy5xdWVyeSA9IHRoaXMuX3BhcnNlUXVlcnlQYXJhbXMob3B0aW9ucy5xdWVyeSk7XHJcbiAgICAgICAgb3B0aW9ucy5oZWFkZXJzID0gb3B0aW9ucy5oZWFkZXJzIHx8IHt9O1xyXG4gICAgICAgIG9wdGlvbnMuaGVhZGVyc1snQ29udGVudC1UeXBlJ10gPSBcImFwcGxpY2F0aW9uL2pzb25cIjtcclxuICAgICAgICBpZiAob3B0aW9ucy5ib2R5ICYmIHR5cGVvZiBvcHRpb25zLmJvZHkgIT09IFwic3RyaW5nXCIpIHtcclxuICAgICAgICAgICAgb3B0aW9ucy5ib2R5ID0gSlNPTi5zdHJpbmdpZnkob3B0aW9ucy5ib2R5KTtcclxuICAgICAgICB9IGVsc2Ugb3B0aW9ucy5ib2R5ID0gdW5kZWZpbmVkO1xyXG5cclxuICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5fZmV0Y2godGhpcy51cmwgKyBlbmRwb2ludCArIG9wdGlvbnMucXVlcnksIG9wdGlvbnMpO1xyXG4gICAgfVxyXG59XHJcblxyXG4vL3RvZG8gY29uc2lkZXIgaW1wbGVtZW50aW5nICdvYnNlcnZlJyBtZXRob2QgdGhhdCByZWdpc3RlcnMgYW5kIHdhdGNoZXMgY2VydGFpbiBwcm9wZXJ0eSBsaXN0Li5cclxuZXhwb3J0IGNsYXNzIEFic3RyYWN0QVBJIGV4dGVuZHMgRXZlbnRTb3VyY2Uge1xyXG4gICAgLy90b2RvIHRyeSBmaWd1cmluZyBvdXQgaG93IHRvIHByaW50IHRoZSBjbGFzcyBuYW1lIHRvb1xyXG4gICAgLy9odHRwczovL3N0YWNrb3ZlcmZsb3cuY29tL3F1ZXN0aW9ucy8yODAzODkvaG93LWRvLXlvdS1maW5kLW91dC10aGUtY2FsbGVyLWZ1bmN0aW9uLWluLWphdmFzY3JpcHRcclxuICAgIHByaXZhdGUgZ2V0Q2FsbGVyTmFtZSgpIHtcclxuICAgICAgICAvLyBHZXQgc3RhY2sgYXJyYXlcclxuICAgICAgICBjb25zdCBvcmlnID0gRXJyb3IucHJlcGFyZVN0YWNrVHJhY2U7XHJcbiAgICAgICAgRXJyb3IucHJlcGFyZVN0YWNrVHJhY2UgPSAoZXJyb3IsIHN0YWNrKSA9PiBzdGFjaztcclxuICAgICAgICBjb25zdCB7IHN0YWNrIH0gPSBuZXcgRXJyb3IoKTtcclxuICAgICAgICBFcnJvci5wcmVwYXJlU3RhY2tUcmFjZSA9IG9yaWc7XHJcblxyXG4gICAgICAgIGNvbnN0IGNhbGxlciA9IHN0YWNrPy5bMl07XHJcbiAgICAgICAgcmV0dXJuIGNhbGxlciA/IGNhbGxlciA6ICd1bmtub3duIGNvbnRleHQnO1xyXG4gICAgfVxyXG5cclxuICAgIHJlcXVpcmVzKG5hbWU6IHN0cmluZywgdmFsdWU6IGFueSk6IHZvaWQge1xyXG4gICAgICAgIGlmICghdmFsdWUpIHtcclxuICAgICAgICAgICAgdGhyb3cgYEFyZ3VtZW50RXJyb3JbJHt0aGlzLmdldENhbGxlck5hbWUoKX1dICR7bmFtZX0gaXMgbWlzc2luZyAtIHJlcXVpcmVkIHByb3BlcnR5IWBcclxuICAgICAgICB9XHJcbiAgICB9XHJcbn1cclxuIiwiXHJcbmV4cG9ydCBpbnRlcmZhY2UgSnd0VG9rZW5CYXNlIHtcclxuICAgIHN1Yjogc3RyaW5nLFxyXG4gICAgZXhwOiBudW1iZXIsXHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgSnd0VG9rZW4gZXh0ZW5kcyBKd3RUb2tlbkJhc2Uge1xyXG4gICAgaWF0OiBudW1iZXI7XHJcbiAgICBqdGk6IHN0cmluZztcclxuICAgIGlzczogc3RyaW5nO1xyXG4gICAgYXVkOiBzdHJpbmc7XHJcbiAgICB0eXA6IHN0cmluZztcclxuICAgIGF6cDogc3RyaW5nO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0Snd0VG9rZW5FeHBpcmVzVGltZW91dCh0b2tlbjogSnd0VG9rZW5CYXNlKSB7XHJcbiAgICAvL3RpbWVvdXQgT1IgMzAwIHNlY3NcclxuICAgIHJldHVybiB0b2tlbi5leHAqMWUzIC0gRGF0ZS5ub3coKSB8fCAzMDBlMztcclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBTY29wZVRva2VuIGV4dGVuZHMgSnd0VG9rZW5CYXNlIHtcclxuICAgIHRva2VuX2lkOiBudW1iZXJcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHBhcnNlSnd0VG9rZW4odG9rZW46IHN0cmluZyk6IEp3dFRva2VuQmFzZSB7XHJcbiAgICByZXR1cm4gSlNPTi5wYXJzZShhdG9iKHRva2VuLnNwbGl0KCcuJylbMV0pKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIHNsZWVwKG1zOiBudW1iZXIpOiBQcm9taXNlPHZvaWQ+IHtcclxuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4gc2V0VGltZW91dChyZXNvbHZlLCBtcykpO1xyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgTG9nZ2VyIHtcclxuICAgIHN0YXRpYyBlcnJvciguLi5hcmdzOiBhbnkpOnZvaWQge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoXCJFOkVtcGF0aW9uQVBJXCIsIC4uLmFyZ3MpO1xyXG4gICAgfVxyXG4gICAgc3RhdGljIHdhcm4oLi4uYXJnczogYW55KTp2b2lkIHtcclxuICAgICAgICBjb25zb2xlLndhcm4oXCJXOkVtcGF0aW9uQVBJXCIsIC4uLmFyZ3MpO1xyXG4gICAgfVxyXG4gICAgc3RhdGljIGluZm8oLi4uYXJnczogYW55KTp2b2lkIHtcclxuICAgICAgICBjb25zb2xlLmluZm8oXCJJOkVtcGF0aW9uQVBJXCIsIC4uLmFyZ3MpO1xyXG4gICAgfVxyXG4gICAgc3RhdGljIGRlYnVnKC4uLmFyZ3M6IGFueSk6dm9pZCB7XHJcbiAgICAgICAgY29uc29sZS5kZWJ1ZyhcIkQ6RW1wYXRpb25BUElcIiwgLi4uYXJncyk7XHJcbiAgICB9XHJcbn1cclxuIiwiaW1wb3J0IHtBYnN0cmFjdEFQSSwgRW1wYXRpb25BUElPcHRpb25zLCBSYXdBUEksIFJhd09wdGlvbnN9IGZyb20gXCIuL2Jhc2VcIjtcclxuaW1wb3J0IHtTY29wZXNBUEl9IGZyb20gXCIuL3Njb3BlXCI7XHJcbmltcG9ydCB7Z2V0Snd0VG9rZW5FeHBpcmVzVGltZW91dCwgSnd0VG9rZW5CYXNlLCBwYXJzZUp3dFRva2VufSBmcm9tIFwiLi91dGlsc1wiO1xyXG5cclxuZXhwb3J0IGFic3RyYWN0IGNsYXNzIFJvb3RDb250ZXh0IHtcclxuICAgIHByb3RlY3RlZCBhYnN0cmFjdCBjb250ZXh0OiBSb290QVBJO1xyXG4gICAgcHJvdGVjdGVkIGFic3RyYWN0IGRhdGE6IGFueTtcclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBSb290QVBJT3B0aW9ucyB7XHJcbiAgICBhbm9ueW1vdXNVc2VySWQ6IHN0cmluZztcclxuICAgIHdvcmtiZW5jaEFwaVVybDogc3RyaW5nO1xyXG4gICAgYXBpVXJsOiBzdHJpbmc7XHJcbiAgICBhcGlSb290UGF0aDogc3RyaW5nO1xyXG59XHJcblxyXG4vLyBCYXNlQVBJIGltcGxlbWVudHMgQWJzdHJhY3RBUEkgb3ZlciAvdlt2ZXJzaW9uXVxyXG5leHBvcnQgYWJzdHJhY3QgY2xhc3MgUm9vdEFQSSBleHRlbmRzIEFic3RyYWN0QVBJIHtcclxuXHJcbiAgICAvLyBSYXdBUEkgaW1wbGVtZW50cyBhY2Nlc3MgdG8gdGhlIGh0dHAgZW5kcG9pbnRzXHJcbiAgICBwcm90ZWN0ZWQgYWJzdHJhY3QgcmF3OiBSYXdBUEk7XHJcbiAgICAvLyBTY29wZXNBUEkgaW1wbGVtZW50cyBBYnN0cmFjdEFQSSBvdmVyIC92W3ZlcnNpb25dL3Njb3Blc1xyXG4gICAgYWJzdHJhY3Qgc2NvcGVzOiBTY29wZXNBUEk7XHJcblxyXG4gICAgLy8gUHJvcGVydGllc1xyXG4gICAgYWJzdHJhY3QgdmVyc2lvbjogc3RyaW5nO1xyXG4gICAgYWJzdHJhY3Qgcm9vdFVSSTogc3RyaW5nO1xyXG4gICAgb3B0aW9uczogUm9vdEFQSU9wdGlvbnM7XHJcbiAgICBjYWNoZWQ6IG9iamVjdDtcclxuICAgIGFjY2Vzc1Rva2VuOiBKd3RUb2tlbkJhc2UgfCBudWxsID0gbnVsbDtcclxuXHJcbiAgICBwcml2YXRlIF91c2VySWQ6IHN0cmluZztcclxuICAgIHByaXZhdGUgX3Rva2VuRXhwaXJlczogbnVtYmVyID0gMDtcclxuICAgIHByaXZhdGUgX3Jhd1Rva2VuOiBzdHJpbmcgPSBcIlwiO1xyXG5cclxuICAgIHByb3RlY3RlZCBjb25zdHJ1Y3RvcihvcHRpb25zOiBFbXBhdGlvbkFQSU9wdGlvbnMpIHtcclxuICAgICAgICBzdXBlcigpO1xyXG5cclxuICAgICAgICBpZiAoIW9wdGlvbnMud29ya2JlbmNoQXBpVXJsKSB7XHJcbiAgICAgICAgICAgIHRocm93IFwiV0IgQXBpIHVybCBpcyByZXF1aXJlZCFcIjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGxldCBhcGlVcmw7XHJcbiAgICAgICAgaWYgKCFvcHRpb25zLmFwaVJvb3RQYXRoKSB7XHJcbiAgICAgICAgICAgIGFwaVVybCA9IG9wdGlvbnMud29ya2JlbmNoQXBpVXJsO1xyXG4gICAgICAgIH0gZWxzZSBpZiAoIW9wdGlvbnMuYXBpUm9vdFBhdGguc3RhcnRzV2l0aChcIi9cIikpIHtcclxuICAgICAgICAgICAgYXBpVXJsID0gYCR7b3B0aW9ucy53b3JrYmVuY2hBcGlVcmx9LyR7b3B0aW9ucy5hcGlSb290UGF0aH1gO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGFwaVVybCA9IGAke29wdGlvbnMud29ya2JlbmNoQXBpVXJsfSR7b3B0aW9ucy5hcGlSb290UGF0aH1gO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoYXBpVXJsLmVuZHNXaXRoKCcvJykpIHtcclxuICAgICAgICAgICAgYXBpVXJsID0gYXBpVXJsLnNsaWNlKDAsIC0xKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdGhpcy5vcHRpb25zID0ge1xyXG4gICAgICAgICAgICBhcGlVcmwsXHJcbiAgICAgICAgICAgIHdvcmtiZW5jaEFwaVVybDogb3B0aW9ucy53b3JrYmVuY2hBcGlVcmwsXHJcbiAgICAgICAgICAgIGFub255bW91c1VzZXJJZDogb3B0aW9ucy5hbm9ueW1vdXNVc2VySWQgfHwgJ2Fub255bW91cycsXHJcbiAgICAgICAgICAgIGFwaVJvb3RQYXRoOiBvcHRpb25zLmFwaVJvb3RQYXRoIHx8IFwiXCIsXHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLl91c2VySWQgPSB0aGlzLm9wdGlvbnMuYW5vbnltb3VzVXNlcklkO1xyXG4gICAgICAgIHRoaXMuY2FjaGVkID0ge307XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDaGFuZ2UgdGhlIFVzZXIgYWN0b3IgZm9yIHRoZSBBUEkuIE5vdGU6IHRoZSBhcGkgd2lsbFxyXG4gICAgICogcmVzZXQgaXQncyB3aG9sZSBzdGF0ZS5cclxuICAgICAqIEBwYXJhbSB0b2tlbiBzZXR1cCBjb250ZXh0IGZyb20gb2JqZWN0XHJcbiAgICAgKiBAcGFyYW0gd2l0aEV2ZW50XHJcbiAgICAgKi9cclxuICAgIGZyb20odG9rZW46IHN0cmluZywgd2l0aEV2ZW50PXRydWUpOiB2b2lkIHtcclxuICAgICAgICBpZiAoIXRva2VuKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLnJlc2V0KCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuX3Jhd1Rva2VuID0gdG9rZW47XHJcbiAgICAgICAgd2l0aEV2ZW50ID0gd2l0aEV2ZW50ICYmICF0aGlzLmFjY2Vzc1Rva2VuOyAvL2ZpcmUgZXZlbnQgb25seSB3aGVuIHdlIGNvbmZpZ3VyZSBuZXcgc2Vzc2lvblxyXG4gICAgICAgIHRoaXMuYWNjZXNzVG9rZW4gPSBwYXJzZUp3dFRva2VuKHRva2VuKSBhcyBKd3RUb2tlbkJhc2U7XHJcbiAgICAgICAgY29uc3QgdG9rZW5UaW1lb3V0ID0gZ2V0Snd0VG9rZW5FeHBpcmVzVGltZW91dCh0aGlzLmFjY2Vzc1Rva2VuKTtcclxuICAgICAgICB0aGlzLl90b2tlbkV4cGlyZXMgPSBEYXRlLm5vdygpICsgdG9rZW5UaW1lb3V0IC8gMjtcclxuICAgICAgICBjb25zdCB1c2VySWQgPSB0aGlzLmFjY2Vzc1Rva2VuLnN1YjtcclxuICAgICAgICBpZiAoIXVzZXJJZCB8fCB1c2VySWQubGVuZ3RoID4gNTApIHRocm93IFwiSW52YWxpZCBVc2VyIElEISBNdXN0IGJlIHZhbGlkIHN0cmluZyBzaG9ydGVyIHRoYW4gNTAgY2hhcmFjdGVycyFcIjtcclxuICAgICAgICB0aGlzLl91c2VySWQgPSB1c2VySWQ7XHJcbiAgICAgICAgaWYgKHRoaXMudXNlcklkID09PSB1c2VySWQpIHJldHVybjtcclxuICAgICAgICBpZiAod2l0aEV2ZW50KSB0aGlzLnJhaXNlRXZlbnQoJ2luaXQnKTtcclxuICAgIH1cclxuXHJcbiAgICByZXNldCgpOiB2b2lkIHtcclxuICAgICAgICB0aGlzLl9yYXdUb2tlbiA9IFwiXCI7XHJcbiAgICAgICAgdGhpcy5fdG9rZW5FeHBpcmVzID0gMDtcclxuICAgICAgICB0aGlzLmFjY2Vzc1Rva2VuID0gbnVsbDtcclxuICAgICAgICB0aGlzLl91c2VySWQgPSB0aGlzLm9wdGlvbnMuYW5vbnltb3VzVXNlcklkO1xyXG4gICAgICAgIHRoaXMuc2NvcGVzLnJlc2V0KCk7XHJcbiAgICAgICAgdGhpcy5yYWlzZUV2ZW50KCdyZXNldCcpO1xyXG4gICAgfVxyXG5cclxuICAgIGdldCB1c2VySWQoKTogc3RyaW5nIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fdXNlcklkO1xyXG4gICAgfVxyXG5cclxuICAgIGdldCByYXdUb2tlbigpOiBzdHJpbmcge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9yYXdUb2tlbjtcclxuICAgIH1cclxuXHJcbiAgICBhc3luYyByYXdRdWVyeShlbmRwb2ludDogc3RyaW5nLCBvcHRpb25zPzogUmF3T3B0aW9ucyk6IFByb21pc2U8YW55PiB7XHJcbiAgICAgICAgaWYgKCF0aGlzLl91c2VySWQpIHtcclxuICAgICAgICAgICAgdGhyb3cgXCJVc2VyIG11c3QgYmUgY29uZmlndXJlZCB0byBhY2Nlc3MgRW1wYWlhIEFQSTogZWl0aGVyIHByb3ZpZGUgYSB2YWxpZCAnYW5vbnltb3VzJyB1c2VyIElEIHRocm91Z2ggZW52IHZhcmlhYmxlcywgb3IgY29uZmlndXJlIHRoZSBSb290IEFQSSB3aXRoIGEgdmFsaWQgdG9rZW4uXCI7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAodGhpcy5fdG9rZW5FeHBpcmVzID4gMCAmJiBEYXRlLm5vdygpID4gdGhpcy5fdG9rZW5FeHBpcmVzKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGV2ZW50T2JqZWN0ID0ge25ld1Rva2VuOiBcIlwifTtcclxuICAgICAgICAgICAgLyoqXHJcbiAgICAgICAgICAgICAqIEBldmVudCB0b2tlbi1yZWZyZXNoXHJcbiAgICAgICAgICAgICAqIEF3YWl0aW5nIGV2ZW50LiBQcm92aWRlIG5ld1Rva2VuIHZhbHVlIGluIHRoZSBldmVudCBoYW5kbGVyIGFyZ3VtZW50IHBhcmFtcyBvYmplY3RcclxuICAgICAgICAgICAgICogZm9yIHRoZSByb290IEFQSSB0byBjb25zdW1lLlxyXG4gICAgICAgICAgICAgKi9cclxuICAgICAgICAgICAgYXdhaXQgdGhpcy5yYWlzZUV2ZW50QXdhaXRpbmcoJ3Rva2VuLXJlZnJlc2gnLCBldmVudE9iamVjdCk7XHJcbiAgICAgICAgICAgIHRoaXMuZnJvbShldmVudE9iamVjdC5uZXdUb2tlbik7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxufVxyXG5cclxuXHJcblxyXG5cclxuIiwiaW1wb3J0IHtBYnN0cmFjdEFQSSwgUmF3QVBJLCBSYXdPcHRpb25zfSBmcm9tIFwiLi9iYXNlXCI7XHJcblxyXG5leHBvcnQgYWJzdHJhY3QgY2xhc3MgU2NvcGVDb250ZXh0IHtcclxuICAgIHByb3RlY3RlZCBhYnN0cmFjdCBjb250ZXh0OiBTY29wZXNBUEk7XHJcbiAgICBwcm90ZWN0ZWQgYWJzdHJhY3QgZGF0YTogYW55O1xyXG59XHJcblxyXG4vKipcclxuICogU2NvcGUgQmluZHMgRXhhbWluYXRpb24gYW5kIFVzZXIuXHJcbiAqL1xyXG5leHBvcnQgYWJzdHJhY3QgY2xhc3MgU2NvcGVzQVBJIGV4dGVuZHMgQWJzdHJhY3RBUEkge1xyXG5cclxuICAgIHByb3RlY3RlZCBhYnN0cmFjdCByYXc6IFJhd0FQSTtcclxuXHJcbiAgICAvKipcclxuICAgICAqIENoYW5nZSB0aGUgYWN0aXZlIFNjb3BlIGZvciB0aGUgQVBJLiBOb3RlOiB0aGUgc2NvcGUgc3RhdGUgd2lsbCByZXNldC5cclxuICAgICAqIEBwYXJhbSBjYXNlSWQgY2FzZSBpZCAtIG1hbmFnZXMgdGhlIGFjdGl2ZSBzY29wZVxyXG4gICAgICogQHBhcmFtIGFwcElkIG1hbmFnZXMgdGhlIGFjdGl2ZSBzY29wZSB0aHJvdWdoIGV4YW1pbmF0aW9uPHVzZXIsIGFwcD5cclxuICAgICAqICAgICAgICAgIGlmIHVuZGVmaW5lZCwgdGhlIGV4YW1pbmF0aW9uIGlzIG1hbmFnZWQgaW50ZXJuYWxseVxyXG4gICAgICovXHJcbiAgICBhYnN0cmFjdCB1c2UoY2FzZUlkOiBzdHJpbmcsIGFwcElkPzogc3RyaW5nKTogUHJvbWlzZTx2b2lkPjtcclxuXHJcbiAgICAvKipcclxuICAgICAqIENoYW5nZSB0aGUgYWN0aXZlIFNjb3BlIGZvciB0aGUgQVBJLiBOb3RlOiB0aGUgc2NvcGUgc3RhdGUgd2lsbCByZXNldC5cclxuICAgICAqIEBwYXJhbSBleGFtaW5hdGlvbiBzZXR1cCBjb250ZXh0IGZyb20gb2JqZWN0XHJcbiAgICAgKi9cclxuICAgIGFic3RyYWN0IGZyb20oZXhhbWluYXRpb246IG9iamVjdCk6IFByb21pc2U8dm9pZD47XHJcblxyXG4gICAgYWJzdHJhY3QgcmVzZXQoKTogdm9pZDtcclxuXHJcbiAgICBhYnN0cmFjdCByYXdRdWVyeShlbmRwb2ludDogc3RyaW5nLCBvcHRpb25zPzogUmF3T3B0aW9ucyk6IFByb21pc2U8YW55PjtcclxufVxyXG5cclxuXHJcblxyXG5cclxuIiwiaW1wb3J0IHtSb290QVBJLCBSb290Q29udGV4dH0gZnJvbSBcIi4uLy4uL3Jvb3RcIjtcclxuaW1wb3J0IFJvb3QgZnJvbSBcIi4vcm9vdFwiO1xyXG5pbXBvcnQge0FwcExpc3R9IGZyb20gXCIuL3R5cGVzL2FwcC1saXN0XCI7XHJcbmltcG9ydCB7QXBwUXVlcnl9IGZyb20gXCIuL3R5cGVzL2FwcC1xdWVyeVwiO1xyXG5pbXBvcnQge0FwcE91dHB1dH0gZnJvbSBcIi4vdHlwZXMvYXBwLW91dHB1dFwiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQXBwcyBleHRlbmRzIFJvb3RDb250ZXh0IHtcclxuICAgIHByb3RlY3RlZCBjb250ZXh0OiBSb290QVBJO1xyXG4gICAgcHJvdGVjdGVkIGRhdGE6IEFwcExpc3QgfCBudWxsID0gbnVsbDtcclxuICAgIHByaXZhdGUgX2RlZmF1bHRBcHA6IEFwcE91dHB1dCB8IG51bGwgPSBudWxsO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKGNvbnRleHQ6IFJvb3QpIHtcclxuICAgICAgICBzdXBlcigpO1xyXG4gICAgICAgIHRoaXMuY29udGV4dCA9IGNvbnRleHQ7XHJcbiAgICB9XHJcblxyXG4gICAgYXN5bmMgbGlzdCgpOiBQcm9taXNlPEFwcExpc3Q+IHtcclxuICAgICAgICByZXR1cm4gdGhpcy5kYXRhID0gYXdhaXQgdGhpcy5jb250ZXh0LnJhd1F1ZXJ5KCcvYXBwcy9xdWVyeScsIHtcclxuICAgICAgICAgICAgbWV0aG9kOiBcIlBVVFwiLFxyXG4gICAgICAgICAgICBib2R5OiB7XHJcbiAgICAgICAgICAgICAgICBhcHBzOiBudWxsLFxyXG4gICAgICAgICAgICAgICAgdGlzc3VlczogbnVsbCxcclxuICAgICAgICAgICAgICAgIHN0YWluczogbnVsbCxcclxuICAgICAgICAgICAgICAgIGpvYl9tb2RlczogbnVsbFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSkgYXMgQXBwTGlzdDtcclxuICAgIH1cclxuXHJcbiAgICBhc3luYyBxdWVyeShxdWVyeTogQXBwUXVlcnkpOiBQcm9taXNlPEFwcExpc3Q+IHtcclxuICAgICAgICByZXR1cm4gdGhpcy5kYXRhID0gYXdhaXQgdGhpcy5jb250ZXh0LnJhd1F1ZXJ5KCcvYXBwcy9xdWVyeScsIHtcclxuICAgICAgICAgICAgbWV0aG9kOiBcIlBVVFwiLFxyXG4gICAgICAgICAgICBib2R5OiBxdWVyeVxyXG4gICAgICAgIH0pIGFzIEFwcExpc3Q7XHJcbiAgICB9XHJcblxyXG4gICAgYXN5bmMgZGVmYXVsdCgpOiBQcm9taXNlPEFwcE91dHB1dD4ge1xyXG4gICAgICAgIGlmICghdGhpcy5kYXRhKSBhd2FpdCB0aGlzLmxpc3QoKTtcclxuICAgICAgICBmb3IgKGxldCBhcHAgb2YgdGhpcy5kYXRhIS5pdGVtcykge1xyXG4gICAgICAgICAgICBpZiAoYXBwLm5hbWVfc2hvcnQgPT09IFwiTUFQM1wiICYmIGFwcC52ZW5kb3JfbmFtZSA9PT0gXCJyYXRpb25haVwiKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9kZWZhdWx0QXBwID0gYXBwO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKCF0aGlzLl9kZWZhdWx0QXBwKSB0aHJvdyBcIkRlZmF1bHQgQVBQIG5vdCBwcmVzZW50IGluIHRoZSBpbmZyYXN0cnVjdHVyZSEgV2FzIGl0IGltcG9ydGVkP1wiO1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9kZWZhdWx0QXBwO1xyXG4gICAgfVxyXG59XHJcbiIsImNvbnN0IGdldE51bWJlciA9ICh2YXJpYWJsZTogc3RyaW5nIHwgbnVtYmVyKSA9PiB7XHJcbiAgaWYgKHR5cGVvZiB2YXJpYWJsZSA9PT0gJ3N0cmluZycpIHtcclxuICAgIHZhcmlhYmxlID0gTnVtYmVyKHZhcmlhYmxlKVxyXG4gIH1cclxuXHJcbiAgcmV0dXJuIHZhcmlhYmxlXHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBnZXRZZWFyRnJvbUVwb2NoVGltZSA9IChlcG9jaFRpbWU6IG51bWJlciB8IHN0cmluZykgPT4ge1xyXG4gIHJldHVybiBuZXcgRGF0ZShnZXROdW1iZXIoZXBvY2hUaW1lKSAqIDEwMDApLmdldEZ1bGxZZWFyKClcclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IGdldE1vbnRoRnJvbUVwb2NoVGltZSA9IChlcG9jaFRpbWU6IG51bWJlciB8IHN0cmluZykgPT4ge1xyXG4gIHJldHVybiBuZXcgRGF0ZShnZXROdW1iZXIoZXBvY2hUaW1lKSAqIDEwMDApLmdldE1vbnRoKClcclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IGdldERheUZyb21FcG9jaFRpbWUgPSAoZXBvY2hUaW1lOiBudW1iZXIgfCBzdHJpbmcpID0+IHtcclxuICByZXR1cm4gbmV3IERhdGUoZ2V0TnVtYmVyKGVwb2NoVGltZSkgKiAxMDAwKS5nZXREYXRlKClcclxufVxyXG5cclxuZXhwb3J0IGNvbnN0IG1hdGNoU3RyaW5nT25TZXBhcmF0b3JHcm91cCA9IChzdHI6IHN0cmluZywgc2VwYXJhdG9yOiBzdHJpbmcsIGdyb3VwSWR4OiBudW1iZXIsIHZhbHVlOiBzdHJpbmcpID0+IHtcclxuICBjb25zdCBtYXRjaGVzID0gbmV3IFJlZ0V4cChzZXBhcmF0b3IpLmV4ZWMoc3RyKVxyXG4gICAgICBpZighbWF0Y2hlcyB8fCBncm91cElkeCA8IDEgfHwgZ3JvdXBJZHggPj0gbWF0Y2hlcy5sZW5ndGgpIFxyXG4gICAgICAgIHJldHVybiBmYWxzZVxyXG4gICAgICByZXR1cm4gbWF0Y2hlc1tncm91cElkeF0gPT09IHZhbHVlXHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCBtYXRjaFN0cmluZ09uVG9rZW5zID0gKHN0cmluZ1RvTWF0Y2g6IHN0cmluZywgdG9rZW5TdHJpbmc6IHN0cmluZykgPT4ge1xyXG4gIGNvbnN0IHRva2VucyA9IHRva2VuU3RyaW5nXHJcbiAgICAuc3BsaXQoJyAnKVxyXG4gICAgLmZpbHRlcihCb29sZWFuKVxyXG4gICAgLm1hcCh0b2tlbiA9PiBgKD89LipcXFxcYiR7dG9rZW59XFxcXGIpYCk7XHJcblxyXG5jb25zdCBzZWFyY2hUZXJtUmVnZXggPSBuZXcgUmVnRXhwKHRva2Vucy5qb2luKCcnKSwgJ2dpbScpO1xyXG5yZXR1cm4gc3RyaW5nVG9NYXRjaC5tYXRjaChzZWFyY2hUZXJtUmVnZXgpICE9PSBudWxsO1xyXG59XHJcblxyXG5leHBvcnQgY29uc3QgZ3JvdXBCeSA9IDxULCBLIGV4dGVuZHMga2V5b2YgYW55PihhcnI6IFRbXSwga2V5OiAoaTogVCkgPT4gSykgPT5cclxuICBhcnIucmVkdWNlKChncm91cHMsIGl0ZW0pID0+IHtcclxuICAgIChncm91cHNba2V5KGl0ZW0pXSB8fD0gW10pLnB1c2goaXRlbSk7XHJcbiAgICByZXR1cm4gZ3JvdXBzO1xyXG4gIH0sIHt9IGFzIFJlY29yZDxLLCBUW10+KTsiLCJpbXBvcnQgQ2FzZXMgZnJvbSBcIi4uL3Jvb3QvY2FzZXNcIjtcclxuaW1wb3J0IHsgQ2FzZSB9IGZyb20gXCIuLi9yb290L3R5cGVzL2Nhc2VcIjtcclxuaW1wb3J0IHsgQ2FzZUV4cGxvcmVyUmVzdWx0cyB9IGZyb20gXCIuL3R5cGVzL2Nhc2UtZXhwbG9yZXItcmVzdWx0c1wiO1xyXG5pbXBvcnQgeyBDYXNlSCB9IGZyb20gXCIuL3R5cGVzL2Nhc2UtaFwiO1xyXG5pbXBvcnQgeyBDYXNlSGllcmFyY2h5IH0gZnJvbSBcIi4vdHlwZXMvY2FzZS1oaWVyYXJjaHktcmVzdWx0XCI7XHJcbmltcG9ydCB7IENhc2VTZWFyY2hQYXJhbXMgfSBmcm9tIFwiLi90eXBlcy9jYXNlLXNlYXJjaC1wYXJhbXNcIjtcclxuaW1wb3J0IHsgZ2V0RGF5RnJvbUVwb2NoVGltZSwgZ2V0TW9udGhGcm9tRXBvY2hUaW1lLCBnZXRZZWFyRnJvbUVwb2NoVGltZSwgZ3JvdXBCeSwgbWF0Y2hTdHJpbmdPblRva2VucyB9IGZyb20gXCIuL3V0aWxzXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBDYXNlRXhwbG9yZXIge1xyXG4gICAgcHJvdGVjdGVkIGNvbnRleHQ6IENhc2VzO1xyXG4gICAgcHJvdGVjdGVkIGN1c3RvbUNhc2VzOiBDYXNlSFtdIHwgbnVsbCA9IG51bGw7XHJcbiAgICBwcm90ZWN0ZWQgY2FzZUhpZXJhcmNoeTogQ2FzZUhpZXJhcmNoeSB8IG51bGwgPSBudWxsO1xyXG4gICAgcHJvdGVjdGVkIGNhc2VUaXNzdWVzOiBzdHJpbmdbXSB8IG51bGwgPSBudWxsO1xyXG4gICAgcHJvdGVjdGVkIGNhc2VTdGFpbnM6IHN0cmluZ1tdIHwgbnVsbCA9IG51bGw7IFxyXG5cclxuICAgIGlkZW50aWZpZXJTZXBhcmF0b3I6IHN0cmluZyA9IFwiXCI7XHJcbiAgICBoaWVyYXJjaHlTcGVjOiBzdHJpbmdbXSA9IFtdO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKGNvbnRleHQ6IENhc2VzKSB7XHJcbiAgICAgICAgdGhpcy5jb250ZXh0ID0gY29udGV4dDtcclxuICAgIH1cclxuXHJcbiAgICB1c2UoaWRlbnRpZmllclNlcGFyYXRvcjogc3RyaW5nLCBoaWVyYXJjaHlTcGVjOiBzdHJpbmdbXSk6IHZvaWQge1xyXG4gICAgICB0aGlzLmhpZXJhcmNoeVNwZWMgPSBoaWVyYXJjaHlTcGVjO1xyXG4gICAgICB0aGlzLmlkZW50aWZpZXJTZXBhcmF0b3IgPSBpZGVudGlmaWVyU2VwYXJhdG9yO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgYXN5bmMgZ2V0Q3VzdG9tQ2FzZXMoKSB7XHJcbiAgICAgIGlmKCF0aGlzLmN1c3RvbUNhc2VzKSB7XHJcbiAgICAgICAgdGhpcy5jdXN0b21DYXNlcyA9IChhd2FpdCB0aGlzLmNvbnRleHQubGlzdCgpKS5pdGVtcy5tYXAoKGNhc2VPYmopID0+IHtcclxuICAgICAgICAgIHJldHVybiB7Li4uY2FzZU9iaiwgcGF0aEluSGllcmFyY2h5OiB0aGlzLmdldENhc2VIaWVyYXJjaHlQYXRoKGNhc2VPYmopfVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHRoaXMuY3VzdG9tQ2FzZXM7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0Q2FzZUhpZXJhcmNoeVBhdGgoY2FzZU9iajogQ2FzZSkge1xyXG4gICAgICBpZighdGhpcy5pZGVudGlmaWVyU2VwYXJhdG9yIHx8ICF0aGlzLmhpZXJhcmNoeVNwZWMpIHtcclxuICAgICAgICB0aHJvdyBgQXJndW1lbnRFcnJvcltDYXNlRXhwbG9yZXJdIGlkZW50aWZpZXJTZXBhcmF0b3Igb3IgaGllcmFyY2h5U3BlYyBpcyBtaXNzaW5nIC0gcmVxdWlyZWQgcHJvcGVydHkhYFxyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiB0aGlzLmhpZXJhcmNoeVNwZWMucmVkdWNlKChwcmV2LCBjdXJyKSA9PiB7XHJcbiAgICAgICAgcmV0dXJuIGAke3ByZXZ9LyR7dGhpcy5nZXRDYXNlVmFsdWUoY3VyciwgY2FzZU9iail9YFxyXG4gICAgICB9LCBcIlwiKVxyXG4gICAgfVxyXG5cclxuICAgIGFzeW5jIGdldENhc2UoY2FzZUlkOiBzdHJpbmcpOiBQcm9taXNlPENhc2VIPiB7XHJcbiAgICAgIGxldCBjYXNlT2JqOiBDYXNlIHwgdW5kZWZpbmVkO1xyXG4gICAgICBpZih0aGlzLmN1c3RvbUNhc2VzKSB7XHJcbiAgICAgICAgY2FzZU9iaiA9IHRoaXMuY3VzdG9tQ2FzZXMuZmluZCgoY3MpID0+IGNzLmlkID09PSBjYXNlSWQpXHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGlmKCFjYXNlT2JqKSB7XHJcbiAgICAgICAgY2FzZU9iaiA9IGF3YWl0IHRoaXMuY29udGV4dC5nZXQoY2FzZUlkKVxyXG4gICAgICB9XHJcblxyXG4gICAgICByZXR1cm4gey4uLmNhc2VPYmosIHBhdGhJbkhpZXJhcmNoeTogdGhpcy5nZXRDYXNlSGllcmFyY2h5UGF0aChjYXNlT2JqKX1cclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGdldENhc2VWYWx1ZShrZXk6IHN0cmluZywgY3M6IENhc2UpIHtcclxuICAgICAgc3dpdGNoKGtleSkge1xyXG4gICAgICAgIGNhc2UgXCJ5ZWFyXCI6IHtcclxuICAgICAgICAgIHJldHVybiB0aGlzLmdldENhc2VZZWFyKGNzKVxyXG4gICAgICAgIH1cclxuICAgICAgICBjYXNlIFwibW9udGhcIjoge1xyXG4gICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0Q2FzZU1vbnRoKGNzKVxyXG4gICAgICAgIH1cclxuICAgICAgICBjYXNlIFwiZGF5XCI6IHtcclxuICAgICAgICAgIHJldHVybiB0aGlzLmdldENhc2VEYXkoY3MpXHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNhc2UgXCJkZXNjcmlwdGlvblwiOiB7XHJcbiAgICAgICAgICByZXR1cm4gdGhpcy5nZXRDYXNlRGVzY3JpcHRpb24oY3MpXHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNhc2UgXCJ0aXNzdWVzXCI6IHtcclxuICAgICAgICAgIHJldHVybiB0aGlzLmdldENhc2VUaXNzdWVzKGNzKVxyXG4gICAgICAgIH1cclxuICAgICAgICBjYXNlIFwic3RhaW5zXCI6IHtcclxuICAgICAgICAgIHJldHVybiB0aGlzLmdldENhc2VTdGFpbnMoY3MpXHJcbiAgICAgICAgfVxyXG4gICAgICAgIGRlZmF1bHQ6IHtcclxuICAgICAgICAgIGlmKGtleS5zbGljZSgwLCA4KSA9PT0gXCJpZF9wYXJ0X1wiICYmICFpc05hTihOdW1iZXIoa2V5LnNsaWNlKDgpKSkpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2V0Q2FzZUlkZW50aWZpZXJQYXJ0KGNzLCBOdW1iZXIoa2V5LnNsaWNlKDgpKSlcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIHRocm93IGBLZXlFcnJvcltDYXNlRXhwbG9yZXJdIFxcXCIke2tleX1cXFwiIGlzIG5vdCBzdXBwb3J0ZWQhYFxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgZXZhbHVhdGVDYXNlVmFsdWUoa2V5OiBzdHJpbmcsIGV2YWxWYWx1ZTogc3RyaW5nIHwgc3RyaW5nW10sIGNzOiBDYXNlKSB7XHJcbiAgICAgIGNvbnN0IGNhc2VWYWx1ZSA9IHRoaXMuZ2V0Q2FzZVZhbHVlKGtleSwgY3MpXHJcbiAgICAgIHN3aXRjaChrZXkpIHtcclxuICAgICAgICBjYXNlIFwieWVhclwiOiB7XHJcbiAgICAgICAgICByZXR1cm4gdGhpcy5ldmF1bGF0ZUNhc2VZZWFyKGNhc2VWYWx1ZSBhcyBzdHJpbmcsIGV2YWxWYWx1ZSBhcyBzdHJpbmcpXHJcbiAgICAgICAgfVxyXG4gICAgICAgIGNhc2UgXCJtb250aFwiOiB7XHJcbiAgICAgICAgICByZXR1cm4gdGhpcy5ldmF1bGF0ZUNhc2VNb250aChjYXNlVmFsdWUgYXMgc3RyaW5nLCBldmFsVmFsdWUgYXMgc3RyaW5nKVxyXG4gICAgICAgIH1cclxuICAgICAgICBjYXNlIFwiZGF5XCI6IHtcclxuICAgICAgICAgIHJldHVybiB0aGlzLmV2YXVsYXRlQ2FzZURheShjYXNlVmFsdWUgYXMgc3RyaW5nLCBldmFsVmFsdWUgYXMgc3RyaW5nKVxyXG4gICAgICAgIH1cclxuICAgICAgICBjYXNlIFwiZGVzY3JpcHRpb25cIjoge1xyXG4gICAgICAgICAgcmV0dXJuIHRoaXMuZXZhbHVhdGVDYXNlRGVzY3JpcHRpb24oY2FzZVZhbHVlIGFzIHN0cmluZywgZXZhbFZhbHVlIGFzIHN0cmluZylcclxuICAgICAgICB9XHJcbiAgICAgICAgY2FzZSBcInRpc3N1ZXNcIjoge1xyXG4gICAgICAgICAgcmV0dXJuIHRoaXMuZXZhbHVhdGVDYXNlVGlzc3VlcyhjYXNlVmFsdWUgYXMgc3RyaW5nW10sIGV2YWxWYWx1ZSBhcyBzdHJpbmdbXSlcclxuICAgICAgICB9XHJcbiAgICAgICAgY2FzZSBcInN0YWluc1wiOiB7XHJcbiAgICAgICAgICByZXR1cm4gdGhpcy5ldmFsdWF0ZUNhc2VTdGFpbnMoY2FzZVZhbHVlIGFzIHN0cmluZ1tdLCBldmFsVmFsdWUgYXMgc3RyaW5nW10pXHJcbiAgICAgICAgfVxyXG4gICAgICAgIGRlZmF1bHQ6IHtcclxuICAgICAgICAgIC8vIGFueSBpbnZhbGlkIGtleSB3aWxsIGJlIGNhdWdodCBpbiBnZXRDYXNlVmFsdWUgY2FsbFxyXG4gICAgICAgICAgcmV0dXJuIHRoaXMuZXZhdWxhdGVDYXNlSWRlbnRpZmllclBhcnQoY2FzZVZhbHVlIGFzIHN0cmluZywgZXZhbFZhbHVlIGFzIHN0cmluZylcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGdldENhc2VZZWFyKGNzOiBDYXNlKTogc3RyaW5nIHtcclxuICAgICAgcmV0dXJuIGdldFllYXJGcm9tRXBvY2hUaW1lKGNzLmNyZWF0ZWRfYXQpLnRvU3RyaW5nKClcclxuICAgIH1cclxuICAgIHByaXZhdGUgZ2V0Q2FzZU1vbnRoKGNzOiBDYXNlKTogc3RyaW5nIHtcclxuICAgICAgcmV0dXJuIGdldE1vbnRoRnJvbUVwb2NoVGltZShjcy5jcmVhdGVkX2F0KS50b1N0cmluZygpXHJcbiAgICB9XHJcbiAgICBwcml2YXRlIGdldENhc2VEYXkoY3M6IENhc2UpOiBzdHJpbmcge1xyXG4gICAgICByZXR1cm4gZ2V0RGF5RnJvbUVwb2NoVGltZShjcy5jcmVhdGVkX2F0KS50b1N0cmluZygpXHJcbiAgICB9XHJcbiAgICBwcml2YXRlIGdldENhc2VJZGVudGlmaWVyUGFydChjczogQ2FzZSwgcGFydElkeDogbnVtYmVyKTogc3RyaW5nIHtcclxuICAgICAgaWYoIXRoaXMuaWRlbnRpZmllclNlcGFyYXRvcikge1xyXG4gICAgICAgIHRocm93IGBBcmd1bWVudEVycm9yW0Nhc2VFeHBsb3Jlcl0gaWRlbnRpZmllclNlcGFyYXRvciBpcyBtaXNzaW5nIC0gcmVxdWlyZWQgcHJvcGVydHkhYFxyXG4gICAgICB9XHJcbiAgICAgIGNvbnN0IHBhcnRzID0gbmV3IFJlZ0V4cCh0aGlzLmlkZW50aWZpZXJTZXBhcmF0b3IpLmV4ZWMoY3MubG9jYWxfaWQgfHwgXCJcIilcclxuICAgICAgaWYoIXBhcnRzKSBcclxuICAgICAgICByZXR1cm4gXCJPVEhFUlwiXHJcbiAgICAgIGlmKHBhcnRJZHggPCAxIHx8IHBhcnRJZHggPj0gcGFydHMubGVuZ3RoKVxyXG4gICAgICAgIHRocm93IGBLZXlFcnJvcltDYXNlRXhwbG9yZXJdIGludmFsaWQga2V5IFxcXCJpZF9wYXJ0XzxpbmRleD5cXFwiLCBncm91cCBpbmRleCBpcyBub3QgdmFsaWQhYFxyXG4gICAgICByZXR1cm4gcGFydHNbcGFydElkeF1cclxuICAgIH1cclxuICAgIHByaXZhdGUgZ2V0Q2FzZURlc2NyaXB0aW9uKGNzOiBDYXNlKTogc3RyaW5nIHtcclxuICAgICAgcmV0dXJuIGNzLmRlc2NyaXB0aW9uIHx8IFwiXCJcclxuICAgIH1cclxuICAgIHByaXZhdGUgZ2V0Q2FzZVRpc3N1ZXMoY3M6IENhc2UpOiBzdHJpbmdbXSB7XHJcbiAgICAgIHJldHVybiBPYmplY3Qua2V5cyhjcy50aXNzdWVzKVxyXG4gICAgfVxyXG4gICAgcHJpdmF0ZSBnZXRDYXNlU3RhaW5zKGNzOiBDYXNlKTogc3RyaW5nW10ge1xyXG4gICAgICByZXR1cm4gT2JqZWN0LmtleXMoY3Muc3RhaW5zKVxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgZXZhdWxhdGVDYXNlWWVhcih2YWx1ZTogc3RyaW5nLCBldmFsVmFsdWU6IHN0cmluZyk6IGJvb2xlYW4ge1xyXG4gICAgICByZXR1cm4gdmFsdWUgPT09IGV2YWxWYWx1ZTtcclxuICAgIH1cclxuICAgIHByaXZhdGUgZXZhdWxhdGVDYXNlTW9udGgodmFsdWU6IHN0cmluZywgZXZhbFZhbHVlOiBzdHJpbmcpOiBib29sZWFuIHtcclxuICAgICAgcmV0dXJuIHZhbHVlID09PSBldmFsVmFsdWU7XHJcbiAgICB9XHJcbiAgICBwcml2YXRlIGV2YXVsYXRlQ2FzZURheSh2YWx1ZTogc3RyaW5nLCBldmFsVmFsdWU6IHN0cmluZyk6IGJvb2xlYW4ge1xyXG4gICAgICByZXR1cm4gdmFsdWUgPT09IGV2YWxWYWx1ZTtcclxuICAgIH1cclxuICAgIHByaXZhdGUgZXZhdWxhdGVDYXNlSWRlbnRpZmllclBhcnQodmFsdWU6IHN0cmluZywgZXZhbFZhbHVlOiBzdHJpbmcpOiBib29sZWFuIHtcclxuICAgICAgcmV0dXJuIHZhbHVlID09PSBldmFsVmFsdWU7XHJcbiAgICB9XHJcbiAgICBwcml2YXRlIGV2YWx1YXRlQ2FzZURlc2NyaXB0aW9uKHZhbHVlOiBzdHJpbmcsIGV2YWxWYWx1ZTogc3RyaW5nKTogYm9vbGVhbiB7XHJcbiAgICAgIHJldHVybiBtYXRjaFN0cmluZ09uVG9rZW5zKHZhbHVlLCBldmFsVmFsdWUpXHJcbiAgICB9XHJcbiAgICBwcml2YXRlIGV2YWx1YXRlQ2FzZVRpc3N1ZXModmFsdWU6IHN0cmluZ1tdLCBldmFsVmFsdWU6IHN0cmluZ1tdKTogYm9vbGVhbiB7XHJcbiAgICAgIC8vIEFMTCBzZWFyY2hlZCB0aXNzdWVzIGFyZSBwcmVzZW50IGluIGNhc2VcclxuICAgICAgcmV0dXJuIGV2YWxWYWx1ZS5ldmVyeSgodGlzc3VlKSA9PiBPYmplY3Qua2V5cyh2YWx1ZSkuaW5jbHVkZXModGlzc3VlKSlcclxuXHJcbiAgICAgIC8vIFNPTUUgc2VhcmNoZWQgdGlzc3VlcyBhcmUgcHJlc2VudCBpbiBjYXNlXHJcbiAgICAgIC8vIHJldHVybiBldmFsVmFsdWUuc29tZSgodGlzc3VlKSA9PiBPYmplY3Qua2V5cyh2YWx1ZSkuaW5jbHVkZXModGlzc3VlKSlcclxuICAgIH1cclxuICAgIHByaXZhdGUgZXZhbHVhdGVDYXNlU3RhaW5zKHZhbHVlOiBzdHJpbmdbXSwgZXZhbFZhbHVlOiBzdHJpbmdbXSk6IGJvb2xlYW4ge1xyXG4gICAgICAvLyBBTEwgc2VhcmNoZWQgc3RhaW5zIGFyZSBwcmVzZW50IGluIGNhc2VcclxuICAgICAgcmV0dXJuIGV2YWxWYWx1ZS5ldmVyeSgoc3RhaW4pID0+IE9iamVjdC5rZXlzKHZhbHVlKS5pbmNsdWRlcyhzdGFpbikpXHJcblxyXG4gICAgICAvLyBTT01FIHNlYXJjaGVkIHN0YWlucyBhcmUgcHJlc2VudCBpbiBjYXNlXHJcbiAgICAgIC8vIHJldHVybiBldmFsVmFsdWUuc29tZSgoc3RhaW4pID0+IE9iamVjdC5rZXlzKHZhbHVlKS5pbmNsdWRlcyhzdGFpbikpXHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBoaWVyYXJjaHlMZXZlbChrZXlzOiBzdHJpbmdbXSwga2V5SWR4OiBudW1iZXIsIGNhc2VzOiBDYXNlW10sIGN1cnJlbnRIaWVyYXJjaHlQYXRoOiBzdHJpbmcsIG5hbWU/OiBzdHJpbmcpOiBDYXNlSGllcmFyY2h5IHtcclxuICAgICAgaWYgKGtleUlkeCA+PSBrZXlzLmxlbmd0aCkge1xyXG4gICAgICAgIHJldHVybiB7IGxldmVsTmFtZTogbmFtZSwgbGFzdExldmVsOiB0cnVlLCBpdGVtczogY2FzZXMubWFwKChjYXNlT2JqKSA9PiB7IHJldHVybiB7Li4uY2FzZU9iaiwgcGF0aEluSGllcmFyY2h5OiBjdXJyZW50SGllcmFyY2h5UGF0aH19KX1cclxuICAgICAgfVxyXG4gICAgICAvLyBncm91cGluZyBieSBhcnJheSB2YWx1ZXModGlzc3Vlcywgc3RhaW5zKSBpcyBub3QgZXhwZWN0ZWQsIGJ1dCB3b3JrcyBieSBncm91cGluZyBvbiBmaXJzdCB2YWx1ZSBvZiBhcnJheVxyXG4gICAgICBjb25zdCBncm91cHMgPSBncm91cEJ5KGNhc2VzLCAoY3MpID0+IHtcclxuICAgICAgICBjb25zdCB2YWx1ZSA9IHRoaXMuZ2V0Q2FzZVZhbHVlKGtleXNba2V5SWR4XSwgY3MpO1xyXG4gICAgICAgIGlmKEFycmF5LmlzQXJyYXkodmFsdWUpKSB7XHJcbiAgICAgICAgICByZXR1cm4gdmFsdWVbMF0gfHwgXCJcIjtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHZhbHVlO1xyXG4gICAgICB9KVxyXG5cclxuICAgICAgY29uc3QgaXRlbXMgPSBPYmplY3Qua2V5cyhncm91cHMpLm1hcCgobmFtZSkgPT4ge1xyXG4gICAgICAgIGlmKG5hbWUgPT09IFwiT1RIRVJcIikge1xyXG4gICAgICAgICAgcmV0dXJuIHRoaXMuaGllcmFyY2h5TGV2ZWwoa2V5cywga2V5cy5sZW5ndGgsIGdyb3Vwc1tuYW1lXSwgYCR7Y3VycmVudEhpZXJhcmNoeVBhdGh9LyR7bmFtZX1gLCBuYW1lKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuaGllcmFyY2h5TGV2ZWwoa2V5cywga2V5SWR4ICsgMSwgZ3JvdXBzW25hbWVdLCBgJHtjdXJyZW50SGllcmFyY2h5UGF0aH0vJHtuYW1lfWAsIG5hbWUpO1xyXG4gICAgICB9KVxyXG5cclxuICAgICAgcmV0dXJuIHsgbGV2ZWxOYW1lOiBuYW1lLCBsYXN0TGV2ZWw6IGZhbHNlLCBpdGVtczogaXRlbXMgfTtcclxuICAgIH1cclxuXHJcbiAgICBhc3luYyBoaWVyYXJjaHkoKTogUHJvbWlzZTxDYXNlSGllcmFyY2h5PiB7XHJcbiAgICAgIGlmKCF0aGlzLmNhc2VIaWVyYXJjaHkpIHtcclxuICAgICAgICBjb25zdCBjYXNlcyA9IGF3YWl0IHRoaXMuZ2V0Q3VzdG9tQ2FzZXMoKTtcclxuICAgICAgICB0aGlzLmNhc2VIaWVyYXJjaHkgPSB0aGlzLmhpZXJhcmNoeUxldmVsKHRoaXMuaGllcmFyY2h5U3BlYywgMCwgY2FzZXMsIFwiXCIpO1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiB0aGlzLmNhc2VIaWVyYXJjaHk7XHJcbiAgICB9XHJcblxyXG4gICAgYXN5bmMgc2VhcmNoKHF1ZXJ5OiBDYXNlU2VhcmNoUGFyYW1zW10pOiBQcm9taXNlPENhc2VIW10+IHtcclxuICAgICAgbGV0IGZpbHRlcmVkQ2FzZXMgPSBhd2FpdCB0aGlzLmdldEN1c3RvbUNhc2VzKCk7XHJcbiAgICAgIHF1ZXJ5LmZvckVhY2goKHtrZXksIHZhbHVlfSkgPT4gZmlsdGVyZWRDYXNlcyA9IGZpbHRlcmVkQ2FzZXMuZmlsdGVyKChjcykgPT4gdGhpcy5ldmFsdWF0ZUNhc2VWYWx1ZShrZXksIHZhbHVlLCBjcykpKTtcclxuXHJcbiAgICAgIHJldHVybiBmaWx0ZXJlZENhc2VzO1xyXG4gICAgfVxyXG5cclxuICAgIGFzeW5jIHRpc3N1ZXMobG9jYWxpemF0aW9uOiBzdHJpbmcgPSBcIkVOXCIpOiBQcm9taXNlPHN0cmluZ1tdPiB7XHJcbiAgICAgIGlmKCF0aGlzLmNhc2VUaXNzdWVzKSB7XHJcbiAgICAgICAgY29uc3QgY2FzZXMgPSBhd2FpdCB0aGlzLmdldEN1c3RvbUNhc2VzKCk7XHJcblxyXG4gICAgICAgIGNvbnN0IGFsbFRpc3N1ZXM6IFNldDxzdHJpbmc+ID0gbmV3IFNldCgpO1xyXG4gICAgICAgIGNhc2VzLmZvckVhY2goKGMpID0+IE9iamVjdC52YWx1ZXMoYy50aXNzdWVzKS5tYXAoKHRpc3N1ZTogYW55KSA9PiB0aXNzdWVbbG9jYWxpemF0aW9uXSkuZm9yRWFjaCgodCkgPT4gYWxsVGlzc3Vlcy5hZGQodCkpKTtcclxuICAgICAgICB0aGlzLmNhc2VUaXNzdWVzID0gWy4uLmFsbFRpc3N1ZXNdO1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiB0aGlzLmNhc2VUaXNzdWVzO1xyXG4gICAgfVxyXG5cclxuICAgIGFzeW5jIHN0YWlucyhsb2NhbGl6YXRpb246IHN0cmluZyA9IFwiRU5cIik6IFByb21pc2U8c3RyaW5nW10+IHtcclxuICAgICAgaWYoIXRoaXMuY2FzZVN0YWlucykge1xyXG4gICAgICAgIGNvbnN0IGNhc2VzID0gYXdhaXQgdGhpcy5nZXRDdXN0b21DYXNlcygpO1xyXG5cclxuICAgICAgICBjb25zdCBhbGxTdGFpbnM6IFNldDxzdHJpbmc+ID0gbmV3IFNldCgpO1xyXG4gICAgICAgIGNhc2VzLmZvckVhY2goKGMpID0+IE9iamVjdC52YWx1ZXMoYy5zdGFpbnMpLm1hcCgoc3RhaW46IGFueSkgPT4gc3RhaW5bbG9jYWxpemF0aW9uXSkuZm9yRWFjaCgodCkgPT4gYWxsU3RhaW5zLmFkZCh0KSkpO1xyXG4gICAgICAgIHRoaXMuY2FzZVN0YWlucyA9IFsuLi5hbGxTdGFpbnNdO1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiB0aGlzLmNhc2VTdGFpbnM7XHJcbiAgICB9XHJcbn1cclxuIiwiaW1wb3J0IENhc2VzIGZyb20gXCIuLi9yb290L2Nhc2VzXCI7XHJcbmltcG9ydCB7IFNsaWRlIH0gZnJvbSBcIi4uL3Jvb3QvdHlwZXMvc2xpZGVcIjtcclxuaW1wb3J0IHsgbWF0Y2hTdHJpbmdPblNlcGFyYXRvckdyb3VwIH0gZnJvbSBcIi4vdXRpbHNcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFdzaUV4cGxvcmVyIHtcclxuICAgIHByb3RlY3RlZCBjb250ZXh0OiBDYXNlcztcclxuICAgIHByb3RlY3RlZCBsYXN0Q2FzZUlkOiBzdHJpbmcgfCBudWxsID0gbnVsbDtcclxuICAgIHByb3RlY3RlZCBkYXRhOiBTbGlkZVtdIHwgbnVsbCA9IG51bGw7XHJcbiAgICBwcm90ZWN0ZWQgc2xpZGVzRGF0YTogU2xpZGVbXSB8IG51bGwgPSBudWxsO1xyXG4gICAgcHJvdGVjdGVkIG1hc2tzRGF0YTogU2xpZGVbXSB8IG51bGwgPSBudWxsO1xyXG5cclxuICAgIG1hc2tJZGVudGlmaWVyU2VwYXJhdG9yOiBzdHJpbmcgPSBcIlwiO1xyXG4gICAgbWFza0lkZW50aWZpZXJWYWx1ZTogc3RyaW5nID0gXCJcIjtcclxuXHJcbiAgICBjb25zdHJ1Y3Rvcihjb250ZXh0OiBDYXNlcykge1xyXG4gICAgICAgIHRoaXMuY29udGV4dCA9IGNvbnRleHQ7XHJcbiAgICB9XHJcblxyXG4gICAgdXNlKG1hc2tJZGVudGlmaWVyU2VwYXJhdG9yOiBzdHJpbmcsIG1hc2tJZGVudGlmaWVyVmFsdWU6IHN0cmluZyk6IHZvaWQge1xyXG4gICAgICB0aGlzLm1hc2tJZGVudGlmaWVyU2VwYXJhdG9yID0gbWFza0lkZW50aWZpZXJTZXBhcmF0b3I7XHJcbiAgICAgIHRoaXMubWFza0lkZW50aWZpZXJWYWx1ZSA9IG1hc2tJZGVudGlmaWVyVmFsdWU7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBhc3luYyBnZXRBbGxTbGlkZXMoY2FzZUlkOiBzdHJpbmcpOiBQcm9taXNlPFNsaWRlW10+IHtcclxuICAgICAgaWYgKHRoaXMubGFzdENhc2VJZCAhPT0gY2FzZUlkIHx8ICF0aGlzLmRhdGEpIHtcclxuICAgICAgICB0aGlzLmRhdGEgPSAoYXdhaXQgdGhpcy5jb250ZXh0LnNsaWRlcyhjYXNlSWQpKS5pdGVtcztcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gdGhpcy5kYXRhXHJcbiAgICB9XHJcblxyXG4gICAgYXN5bmMgc2xpZGVzKGNhc2VJZDogc3RyaW5nKTogUHJvbWlzZTxTbGlkZVtdPiB7XHJcbiAgICAgIGlmICh0aGlzLmxhc3RDYXNlSWQgIT09IGNhc2VJZCB8fCAhdGhpcy5zbGlkZXNEYXRhKSB7XHJcbiAgICAgICAgdGhpcy5zbGlkZXNEYXRhID0gKGF3YWl0IHRoaXMuZ2V0QWxsU2xpZGVzKGNhc2VJZCkpLmZpbHRlcigoc2xpZGUpID0+IHsgXHJcbiAgICAgICAgICByZXR1cm4gIW1hdGNoU3RyaW5nT25TZXBhcmF0b3JHcm91cChzbGlkZS5sb2NhbF9pZCB8fCBcIlwiLCB0aGlzLm1hc2tJZGVudGlmaWVyU2VwYXJhdG9yLCAxLCB0aGlzLm1hc2tJZGVudGlmaWVyVmFsdWUpO1xyXG4gICAgICAgIH0pXHJcbiAgICAgIH1cclxuICAgICAgcmV0dXJuIHRoaXMuc2xpZGVzRGF0YTtcclxuICAgIH1cclxuXHJcbiAgICBhc3luYyBtYXNrcyhjYXNlSWQ6IHN0cmluZyk6IFByb21pc2U8U2xpZGVbXT4ge1xyXG4gICAgICBpZiAodGhpcy5sYXN0Q2FzZUlkICE9PSBjYXNlSWQgfHwgIXRoaXMubWFza3NEYXRhKSB7XHJcbiAgICAgICAgdGhpcy5tYXNrc0RhdGEgPSAoYXdhaXQgdGhpcy5nZXRBbGxTbGlkZXMoY2FzZUlkKSkuZmlsdGVyKChzbGlkZSkgPT4geyBcclxuICAgICAgICAgIHJldHVybiBtYXRjaFN0cmluZ09uU2VwYXJhdG9yR3JvdXAoc2xpZGUubG9jYWxfaWQgfHwgXCJcIiwgdGhpcy5tYXNrSWRlbnRpZmllclNlcGFyYXRvciwgMSwgdGhpcy5tYXNrSWRlbnRpZmllclZhbHVlKTtcclxuICAgICAgICB9KVxyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiB0aGlzLm1hc2tzRGF0YTtcclxuICAgIH1cclxufVxyXG4iLCJpbXBvcnQge1Jvb3RBUEksIFJvb3RDb250ZXh0fSBmcm9tIFwiLi4vLi4vcm9vdFwiO1xyXG5pbXBvcnQgQ2FzZUV4cGxvcmVyIGZyb20gXCIuLi9leHRlbnNpb25zL2Nhc2UtZXhwbG9yZXJcIjtcclxuaW1wb3J0IFdzaUV4cGxvcmVyIGZyb20gXCIuLi9leHRlbnNpb25zL3dzaS1leHBsb3JlclwiO1xyXG5pbXBvcnQgUm9vdCBmcm9tIFwiLi9yb290XCI7XHJcbmltcG9ydCB7IENhc2UgfSBmcm9tIFwiLi90eXBlcy9jYXNlXCI7XHJcbmltcG9ydCB7Q2FzZUxpc3R9IGZyb20gXCIuL3R5cGVzL2Nhc2UtbGlzdFwiO1xyXG5pbXBvcnQgeyBTbGlkZUxpc3QgfSBmcm9tIFwiLi90eXBlcy9zbGlkZS1saXN0XCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBDYXNlcyBleHRlbmRzIFJvb3RDb250ZXh0IHtcclxuICAgIHByb3RlY3RlZCBjb250ZXh0OiBSb290QVBJO1xyXG4gICAgcHJvdGVjdGVkIGRhdGE6IENhc2VMaXN0IHwgbnVsbCA9IG51bGw7XHJcblxyXG4gICAgY2FzZUV4cGxvcmVyOiBDYXNlRXhwbG9yZXI7XHJcbiAgICB3c2lFeHBsb3JlcjogV3NpRXhwbG9yZXI7XHJcblxyXG5cclxuICAgIGNvbnN0cnVjdG9yKGNvbnRleHQ6IFJvb3QpIHtcclxuICAgICAgICBzdXBlcigpO1xyXG4gICAgICAgIHRoaXMuY29udGV4dCA9IGNvbnRleHQ7XHJcblxyXG4gICAgICAgIHRoaXMuY2FzZUV4cGxvcmVyID0gbmV3IENhc2VFeHBsb3Jlcih0aGlzKTtcclxuICAgICAgICB0aGlzLndzaUV4cGxvcmVyID0gbmV3IFdzaUV4cGxvcmVyKHRoaXMpO1xyXG4gICAgfVxyXG5cclxuICAgIGFzeW5jIGxpc3QoKTogUHJvbWlzZTxDYXNlTGlzdD4ge1xyXG4gICAgICAgIGlmKCF0aGlzLmRhdGEpIHtcclxuICAgICAgICAgICAgdGhpcy5kYXRhID0gYXdhaXQgdGhpcy5jb250ZXh0LnJhd1F1ZXJ5KCcvY2FzZXMnKSBhcyBDYXNlTGlzdDtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuZGF0YTtcclxuICAgIH1cclxuXHJcbiAgICBhc3luYyBnZXQoY2FzZUlkOiBzdHJpbmcpOiBQcm9taXNlPENhc2U+IHtcclxuICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5jb250ZXh0LnJhd1F1ZXJ5KGAvY2FzZXMvJHtjYXNlSWR9YCk7XHJcbiAgICB9XHJcblxyXG4gICAgYXN5bmMgc2xpZGVzKGNhc2VJZDogc3RyaW5nKTogUHJvbWlzZTxTbGlkZUxpc3Q+IHtcclxuICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5jb250ZXh0LnJhd1F1ZXJ5KGAvY2FzZXMvJHtjYXNlSWR9L3NsaWRlc2ApO1xyXG4gICAgfVxyXG59XHJcbiIsImltcG9ydCB7Um9vdENvbnRleHR9IGZyb20gXCIuLi8uLi9yb290XCI7XHJcbmltcG9ydCBSb290IGZyb20gXCIuL3Jvb3RcIjtcclxuaW1wb3J0IHtcclxuICAgIFdvcmtiZW5jaFNlcnZpY2VBcGlWM0N1c3RvbU1vZGVsc0V4YW1pbmF0aW9uc0V4YW1pbmF0aW9uXHJcbn0gZnJvbSBcIi4vdHlwZXMvd29ya2JlbmNoLXNlcnZpY2UtYXBpLXYtMy1jdXN0b20tbW9kZWxzLWV4YW1pbmF0aW9ucy1leGFtaW5hdGlvblwiO1xyXG5pbXBvcnQge0V4YW1pbmF0aW9uUXVlcnl9IGZyb20gXCIuL3R5cGVzL2V4YW1pbmF0aW9uLXF1ZXJ5XCI7XHJcbmltcG9ydCB7RXhhbWluYXRpb25MaXN0fSBmcm9tIFwiLi90eXBlcy9leGFtaW5hdGlvbi1saXN0XCI7XHJcbmltcG9ydCB7U2NvcGVUb2tlbkFuZFNjb3BlSWR9IGZyb20gXCIuL3R5cGVzL3Njb3BlLXRva2VuLWFuZC1zY29wZS1pZFwiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgRXhhbWluYXRpb25zIGV4dGVuZHMgUm9vdENvbnRleHQge1xyXG4gICAgcHJvdGVjdGVkIGNvbnRleHQ6IFJvb3Q7XHJcbiAgICBwcm90ZWN0ZWQgZGF0YTogRXhhbWluYXRpb25MaXN0IHwgbnVsbCA9IG51bGw7XHJcblxyXG4gICAgY29uc3RydWN0b3IoY29udGV4dDogUm9vdCkge1xyXG4gICAgICAgIHN1cGVyKCk7XHJcbiAgICAgICAgdGhpcy5jb250ZXh0ID0gY29udGV4dDtcclxuICAgIH1cclxuXHJcbiAgICBhc3luYyBjcmVhdGUoY2FzZUlkOiBzdHJpbmcsIGFwcElkOiBzdHJpbmcpOiBQcm9taXNlPFdvcmtiZW5jaFNlcnZpY2VBcGlWM0N1c3RvbU1vZGVsc0V4YW1pbmF0aW9uc0V4YW1pbmF0aW9uPiB7XHJcbiAgICAgICAgY29uc3Qgc2VsZiA9IHRoaXMuY29udGV4dDtcclxuICAgICAgICBzZWxmLnJlcXVpcmVzKCdjYXNlSWQnLCBjYXNlSWQpO1xyXG4gICAgICAgIHJldHVybiBzZWxmLnJhd1F1ZXJ5KCcvZXhhbWluYXRpb25zJywge1xyXG4gICAgICAgICAgICBtZXRob2Q6ICdQVVQnLFxyXG4gICAgICAgICAgICBib2R5OiB7XHJcbiAgICAgICAgICAgICAgICBjYXNlX2lkOiBjYXNlSWQsXHJcbiAgICAgICAgICAgICAgICBhcHBfaWQ6IGFwcElkXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBhc3luYyBxdWVyeShxdWVyeTogRXhhbWluYXRpb25RdWVyeSwgc2tpcD86IG51bWJlciB8IHVuZGVmaW5lZCwgbGltaXQ/OiBudW1iZXIgfCB1bmRlZmluZWQpOiBQcm9taXNlPEV4YW1pbmF0aW9uTGlzdD4ge1xyXG4gICAgICAgIGNvbnN0IHNlbGYgPSB0aGlzLmNvbnRleHQ7XHJcbiAgICAgICAgcmV0dXJuIHNlbGYucmF3UXVlcnkoYC9leGFtaW5hdGlvbnMvcXVlcnlgLCB7XHJcbiAgICAgICAgICAgIG1ldGhvZDogJ1BVVCcsXHJcbiAgICAgICAgICAgIGJvZHk6IHF1ZXJ5LFxyXG4gICAgICAgICAgICBxdWVyeToge3NraXAsIGxpbWl0fVxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGFzeW5jIGdldChleGFtaW5hdGlvbklkOiBzdHJpbmcpOiBQcm9taXNlPFdvcmtiZW5jaFNlcnZpY2VBcGlWM0N1c3RvbU1vZGVsc0V4YW1pbmF0aW9uc0V4YW1pbmF0aW9uPiB7XHJcbiAgICAgICAgY29uc3Qgc2VsZiA9IHRoaXMuY29udGV4dDtcclxuICAgICAgICBzZWxmLnJlcXVpcmVzKCdleGFtaW5hdGlvbklkJywgZXhhbWluYXRpb25JZCk7XHJcbiAgICAgICAgcmV0dXJuIHNlbGYucmF3UXVlcnkoYC9leGFtaW5hdGlvbnMvJHtleGFtaW5hdGlvbklkfWApO1xyXG4gICAgfVxyXG5cclxuICAgIGFzeW5jIHNjb3BlKGV4YW1pbmF0aW9uSWQ6IHN0cmluZyk6IFByb21pc2U8U2NvcGVUb2tlbkFuZFNjb3BlSWQ+IHtcclxuICAgICAgICBjb25zdCBzZWxmID0gdGhpcy5jb250ZXh0O1xyXG4gICAgICAgIHNlbGYucmVxdWlyZXMoJ2V4YW1pbmF0aW9uSWQnLCBleGFtaW5hdGlvbklkKTtcclxuICAgICAgICByZXR1cm4gc2VsZi5yYXdRdWVyeShgL2V4YW1pbmF0aW9ucy8ke2V4YW1pbmF0aW9uSWR9L3Njb3BlYCwge1xyXG4gICAgICAgICAgICBtZXRob2Q6ICdQVVQnXHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbn1cclxuIiwiaW1wb3J0IHsgU2NvcGVDb250ZXh0IH0gZnJvbSBcIi4uLy4uL3Njb3BlXCI7XHJcbmltcG9ydCBTY29wZXMgZnJvbSBcIi4vc2NvcGVzXCI7XHJcbmltcG9ydCB7IEFwcFVpU3RvcmFnZSB9IGZyb20gXCIuL3R5cGVzL2FwcC11aS1zdG9yYWdlXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBTdG9yYWdlIGV4dGVuZHMgU2NvcGVDb250ZXh0IHtcclxuICAgIHByb3RlY3RlZCBjb250ZXh0OiBTY29wZXM7XHJcbiAgICBwcm90ZWN0ZWQgZGF0YTogQXBwVWlTdG9yYWdlIHwgbnVsbCA9IG51bGw7XHJcblxyXG4gICAgY29uc3RydWN0b3IoY29udGV4dDogU2NvcGVzKSB7XHJcbiAgICAgICAgc3VwZXIoKTtcclxuICAgICAgICB0aGlzLmNvbnRleHQgPSBjb250ZXh0O1xyXG4gICAgfVxyXG5cclxuICAgIGFzeW5jIGdldFJhdygpOiBQcm9taXNlPEFwcFVpU3RvcmFnZT4ge1xyXG4gICAgICAgIGlmKCF0aGlzLmRhdGEpIHtcclxuICAgICAgICAgICAgdGhpcy5kYXRhID0gYXdhaXQgdGhpcy5jb250ZXh0LnJhd1F1ZXJ5KCcvYXBwLXVpLXN0b3JhZ2UvdXNlcicpXHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiB0aGlzLmRhdGEgYXMgQXBwVWlTdG9yYWdlXHJcbiAgICB9XHJcblxyXG4gICAgYXN5bmMgZmx1c2goKTogUHJvbWlzZTxBcHBVaVN0b3JhZ2UgfCBudWxsPiB7XHJcbiAgICAgICAgaWYgKCF0aGlzLmRhdGEpIHJldHVybiBudWxsO1xyXG5cclxuICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5jb250ZXh0LnJhd1F1ZXJ5KCcvYXBwLXVpLXN0b3JhZ2UvdXNlcicsIHtcclxuICAgICAgICAgICAgbWV0aG9kOiBcIlBVVFwiLFxyXG4gICAgICAgICAgICBib2R5OiB0aGlzLmRhdGFcclxuICAgICAgICB9KSBhcyBBcHBVaVN0b3JhZ2U7XHJcbiAgICB9XHJcblxyXG4gICAgYXN5bmMgZ2V0KGtleTogc3RyaW5nKTogUHJvbWlzZTxhbnk+IHtcclxuICAgICAgICBjb25zdCBkYXRhID0gYXdhaXQgdGhpcy5nZXRSYXcoKVxyXG4gICAgICAgIGlmKHR5cGVvZiBkYXRhLmNvbnRlbnRba2V5XSA9PT0gXCJzdHJpbmdcIikge1xyXG4gICAgICAgICAgICByZXR1cm4gSlNPTi5wYXJzZShkYXRhLmNvbnRlbnRba2V5XSBhcyBzdHJpbmcpXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gZGF0YS5jb250ZW50W2tleV1cclxuICAgIH1cclxuXHJcbiAgICBhc3luYyBzZXQoa2V5OiBzdHJpbmcsIHZhbHVlOiBhbnksIGZsdXNoPzogYm9vbGVhbik6IFByb21pc2U8dm9pZD4ge1xyXG4gICAgICAgIGNvbnN0IHZhbHVlUmF3ID0gSlNPTi5zdHJpbmdpZnkodmFsdWUpXHJcbiAgICAgICAgY29uc3QgZGF0YVJhdyA9IGF3YWl0IHRoaXMuZ2V0UmF3KClcclxuICAgICAgICBkYXRhUmF3LmNvbnRlbnRba2V5XSA9IHZhbHVlUmF3XHJcbiAgICAgICAgdGhpcy5kYXRhID0gZGF0YVJhd1xyXG5cclxuICAgICAgICBpZiAoZmx1c2gpIHtcclxuICAgICAgICAgICAgdGhpcy5mbHVzaCgpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBhc3luYyBlcmFzZSgpOiBQcm9taXNlPHZvaWQ+IHtcclxuICAgICAgICB0aGlzLmRhdGEgPSB7Y29udGVudDp7fX1cclxuICAgICAgICB0aGlzLmZsdXNoKClcclxuICAgIH1cclxufVxyXG4iLCJpbXBvcnQgeyBTY29wZUNvbnRleHQgfSBmcm9tIFwiLi4vLi4vc2NvcGVcIjtcclxuaW1wb3J0IFNjb3BlcyBmcm9tIFwiLi9zY29wZXNcIjtcclxuaW1wb3J0IHtQb2ludEFubm90YXRpb259IGZyb20gXCIuL3R5cGVzL3BvaW50LWFubm90YXRpb25cIjtcclxuaW1wb3J0IHtMaW5lQW5ub3RhdGlvbn0gZnJvbSBcIi4vdHlwZXMvbGluZS1hbm5vdGF0aW9uXCI7XHJcbmltcG9ydCB7QXJyb3dBbm5vdGF0aW9ufSBmcm9tIFwiLi90eXBlcy9hcnJvdy1hbm5vdGF0aW9uXCI7XHJcbmltcG9ydCB7Q2lyY2xlQW5ub3RhdGlvbn0gZnJvbSBcIi4vdHlwZXMvY2lyY2xlLWFubm90YXRpb25cIjtcclxuaW1wb3J0IHtSZWN0YW5nbGVBbm5vdGF0aW9ufSBmcm9tIFwiLi90eXBlcy9yZWN0YW5nbGUtYW5ub3RhdGlvblwiO1xyXG5pbXBvcnQge1BvbHlnb25Bbm5vdGF0aW9ufSBmcm9tIFwiLi90eXBlcy9wb2x5Z29uLWFubm90YXRpb25cIjtcclxuaW1wb3J0IHtQb3N0UG9pbnRBbm5vdGF0aW9uc30gZnJvbSBcIi4vdHlwZXMvcG9zdC1wb2ludC1hbm5vdGF0aW9uc1wiO1xyXG5pbXBvcnQge1Bvc3RMaW5lQW5ub3RhdGlvbnN9IGZyb20gXCIuL3R5cGVzL3Bvc3QtbGluZS1hbm5vdGF0aW9uc1wiO1xyXG5pbXBvcnQge1Bvc3RBcnJvd0Fubm90YXRpb25zfSBmcm9tIFwiLi90eXBlcy9wb3N0LWFycm93LWFubm90YXRpb25zXCI7XHJcbmltcG9ydCB7UG9zdENpcmNsZUFubm90YXRpb25zfSBmcm9tIFwiLi90eXBlcy9wb3N0LWNpcmNsZS1hbm5vdGF0aW9uc1wiO1xyXG5pbXBvcnQge1Bvc3RSZWN0YW5nbGVBbm5vdGF0aW9uc30gZnJvbSBcIi4vdHlwZXMvcG9zdC1yZWN0YW5nbGUtYW5ub3RhdGlvbnNcIjtcclxuaW1wb3J0IHtQb3N0UG9seWdvbkFubm90YXRpb25zfSBmcm9tIFwiLi90eXBlcy9wb3N0LXBvbHlnb24tYW5ub3RhdGlvbnNcIjtcclxuaW1wb3J0IHtQb3N0UG9pbnRBbm5vdGF0aW9ufSBmcm9tIFwiLi90eXBlcy9wb3N0LXBvaW50LWFubm90YXRpb25cIjtcclxuaW1wb3J0IHtQb3N0TGluZUFubm90YXRpb259IGZyb20gXCIuL3R5cGVzL3Bvc3QtbGluZS1hbm5vdGF0aW9uXCI7XHJcbmltcG9ydCB7UG9zdEFycm93QW5ub3RhdGlvbn0gZnJvbSBcIi4vdHlwZXMvcG9zdC1hcnJvdy1hbm5vdGF0aW9uXCI7XHJcbmltcG9ydCB7UG9zdENpcmNsZUFubm90YXRpb259IGZyb20gXCIuL3R5cGVzL3Bvc3QtY2lyY2xlLWFubm90YXRpb25cIjtcclxuaW1wb3J0IHtQb3N0UmVjdGFuZ2xlQW5ub3RhdGlvbn0gZnJvbSBcIi4vdHlwZXMvcG9zdC1yZWN0YW5nbGUtYW5ub3RhdGlvblwiO1xyXG5pbXBvcnQge1Bvc3RQb2x5Z29uQW5ub3RhdGlvbn0gZnJvbSBcIi4vdHlwZXMvcG9zdC1wb2x5Z29uLWFubm90YXRpb25cIjtcclxuaW1wb3J0IHtBbm5vdGF0aW9uTGlzdFJlc3BvbnNlfSBmcm9tIFwiLi90eXBlcy9hbm5vdGF0aW9uLWxpc3QtcmVzcG9uc2VcIjtcclxuaW1wb3J0IHtJZE9iamVjdH0gZnJvbSBcIi4vdHlwZXMvaWQtb2JqZWN0XCI7XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIFBvc3RBbm5vdGF0aW9uUXVlcnlQYXJhbXMge1xyXG4gICAgaXNSb2k/OiBib29sZWFuO1xyXG4gICAgZXh0ZXJuYWxJZHM/OiBib29sZWFuO1xyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBBbm5vdGF0aW9ucyBleHRlbmRzIFNjb3BlQ29udGV4dCB7XHJcbiAgICBwcm90ZWN0ZWQgY29udGV4dDogU2NvcGVzO1xyXG4gICAgcHJvdGVjdGVkIGRhdGE6IHVuZGVmaW5lZDsgLy91bnVzZWRcclxuXHJcbiAgICBjb25zdHJ1Y3Rvcihjb250ZXh0OiBTY29wZXMpIHtcclxuICAgICAgICBzdXBlcigpO1xyXG4gICAgICAgIHRoaXMuY29udGV4dCA9IGNvbnRleHQ7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBQb3N0IG11bHRpcGxlIGFubm90YXRpb25zIGFzIG9uZS4gSW5yZWFsaXR5IHRoZSBzYW1lIGVuZHBvaW50IGFzIGNyZWF0ZSguLi4pXHJcbiAgICAgKi9cclxuICAgIGFzeW5jIHVwbG9hZChkYXRhOiBQb3N0UG9pbnRBbm5vdGF0aW9ucyB8IFBvc3RMaW5lQW5ub3RhdGlvbnMgfCBQb3N0QXJyb3dBbm5vdGF0aW9ucyB8IFBvc3RDaXJjbGVBbm5vdGF0aW9ucyB8IFBvc3RSZWN0YW5nbGVBbm5vdGF0aW9ucyB8IFBvc3RQb2x5Z29uQW5ub3RhdGlvbnMsXHJcbiAgICAgICAgICAgICAgICAgb3B0aW9uczogUG9zdEFubm90YXRpb25RdWVyeVBhcmFtcyA9IHt9XHJcbiAgICApOiBQcm9taXNlPEFubm90YXRpb25MaXN0UmVzcG9uc2U+IHtcclxuICAgICAgICAvL3RoZSBzYW1lIGFzIGNyZWF0ZSBidXQgZm9yIHR5cGVzIGl0cyBzaW1wbGVyIHRvIHNwbGl0XHJcbiAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuY29udGV4dC5yYXdRdWVyeSgnL2Fubm90YXRpb25zJywge1xyXG4gICAgICAgICAgICBtZXRob2Q6IFwiUE9TVFwiLFxyXG4gICAgICAgICAgICBxdWVyeTogb3B0aW9ucyxcclxuICAgICAgICAgICAgYm9keTogdGhpcy5kYXRhXHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLyoqXHJcbiAgICAgKiBDcmVhdGUgYW4gYW5ub3RhdGlvbi5cclxuICAgICAqL1xyXG4gICAgYXN5bmMgY3JlYXRlKGRhdGE6IFBvc3RQb2ludEFubm90YXRpb24gfCBQb3N0TGluZUFubm90YXRpb24gfCBQb3N0QXJyb3dBbm5vdGF0aW9uIHwgUG9zdENpcmNsZUFubm90YXRpb24gfCBQb3N0UmVjdGFuZ2xlQW5ub3RhdGlvbiB8IFBvc3RQb2x5Z29uQW5ub3RhdGlvbixcclxuICAgICAgICAgICAgICAgICBvcHRpb25zOiBQb3N0QW5ub3RhdGlvblF1ZXJ5UGFyYW1zID0ge31cclxuICAgICk6IFByb21pc2U8KFBvaW50QW5ub3RhdGlvbiB8IExpbmVBbm5vdGF0aW9uIHwgQXJyb3dBbm5vdGF0aW9uIHwgQ2lyY2xlQW5ub3RhdGlvbiB8IFJlY3RhbmdsZUFubm90YXRpb24gfCBQb2x5Z29uQW5ub3RhdGlvbik+IHtcclxuICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5jb250ZXh0LnJhd1F1ZXJ5KCcvYW5ub3RhdGlvbnMnLCB7XHJcbiAgICAgICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXHJcbiAgICAgICAgICAgIHF1ZXJ5OiBvcHRpb25zLFxyXG4gICAgICAgICAgICBib2R5OiB0aGlzLmRhdGFcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBhc3luYyBkZWxldGUoaWQ6IHN0cmluZyk6IFByb21pc2U8SWRPYmplY3Q+IHtcclxuICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5jb250ZXh0LnJhd1F1ZXJ5KGAvYW5ub3RhdGlvbnMvJHtpZH1gLCB7XHJcbiAgICAgICAgICAgIG1ldGhvZDogXCJERUxFVEVcIlxyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIGFzeW5jIHVwZGF0ZShcclxuICAgICAgICBpZDogc3RyaW5nLFxyXG4gICAgICAgIGRhdGE6IFBvc3RQb2ludEFubm90YXRpb24gfCBQb3N0TGluZUFubm90YXRpb24gfCBQb3N0QXJyb3dBbm5vdGF0aW9uIHwgUG9zdENpcmNsZUFubm90YXRpb24gfCBQb3N0UmVjdGFuZ2xlQW5ub3RhdGlvbiB8IFBvc3RQb2x5Z29uQW5ub3RhdGlvbixcclxuICAgICAgICBvcHRpb25zOiBQb3N0QW5ub3RhdGlvblF1ZXJ5UGFyYW1zID0ge30sXHJcbiAgICApOiBQcm9taXNlPChQb2ludEFubm90YXRpb24gfCBMaW5lQW5ub3RhdGlvbiB8IEFycm93QW5ub3RhdGlvbiB8IENpcmNsZUFubm90YXRpb24gfCBSZWN0YW5nbGVBbm5vdGF0aW9uIHwgUG9seWdvbkFubm90YXRpb24pPiB7XHJcbiAgICAgICAgYXdhaXQgdGhpcy5kZWxldGUoaWQpO1xyXG5cclxuICAgICAgICAvLyB1cGRhdGUgbWlnaHQgY2FycnkgaWQgYnV0IHVzZXIgZm9yZ290IHRvIHNldCBleHRlcm5hbCBJRHMgdG8gdHJ1ZVxyXG4gICAgICAgIGlmICghb3B0aW9ucy5leHRlcm5hbElkcyAmJiBkYXRhLmlkKSB7XHJcbiAgICAgICAgICAgIG9wdGlvbnMuZXh0ZXJuYWxJZHMgPSB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5jcmVhdGUoZGF0YSwgb3B0aW9ucyk7XHJcbiAgICB9XHJcbn1cclxuIiwiaW1wb3J0IHsgU2NvcGVDb250ZXh0IH0gZnJvbSBcIi4uLy4uL3Njb3BlXCI7XHJcbmltcG9ydCBTY29wZXMgZnJvbSBcIi4vc2NvcGVzXCI7XHJcbmltcG9ydCB7IENvbGxlY3Rpb24gfSBmcm9tIFwiLi90eXBlcy9jb2xsZWN0aW9uXCI7XHJcbmltcG9ydCB7IEl0ZW1RdWVyeSB9IGZyb20gXCIuL3R5cGVzL2l0ZW0tcXVlcnlcIjtcclxuaW1wb3J0IHsgSXRlbVF1ZXJ5TGlzdCB9IGZyb20gXCIuL3R5cGVzL2l0ZW0tcXVlcnktbGlzdFwiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ29sbGVjdGlvbnMgZXh0ZW5kcyBTY29wZUNvbnRleHQge1xyXG4gICAgcHJvdGVjdGVkIGNvbnRleHQ6IFNjb3BlcztcclxuICAgIHByb3RlY3RlZCBkYXRhOiBDb2xsZWN0aW9uIHwgbnVsbCA9IG51bGw7XHJcblxyXG4gICAgY29uc3RydWN0b3IoY29udGV4dDogU2NvcGVzKSB7XHJcbiAgICAgICAgc3VwZXIoKTtcclxuICAgICAgICB0aGlzLmNvbnRleHQgPSBjb250ZXh0O1xyXG4gICAgfVxyXG5cclxuICAgIGFzeW5jIGdldChjb2xsZWN0aW9uSWQ6IHN0cmluZyk6IFByb21pc2U8Q29sbGVjdGlvbj4ge1xyXG4gICAgICAgIGNvbnN0IGNvbGxlY3Rpb246IENvbGxlY3Rpb24gPSBhd2FpdCB0aGlzLmNvbnRleHQucmF3UXVlcnkoYC9jb2xsZWN0aW9ucy8ke2NvbGxlY3Rpb25JZH1gKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIGNvbGxlY3Rpb247XHJcbiAgICB9XHJcblxyXG4gICAgYXN5bmMgY3JlYXRlKGNvbGxlY3Rpb246IENvbGxlY3Rpb24pOiBQcm9taXNlPENvbGxlY3Rpb24+IHtcclxuICAgICAgICBjb25zdCBjcmVhdGVkQ29sbGVjdGlvbjogQ29sbGVjdGlvbiA9IGF3YWl0IHRoaXMuY29udGV4dC5yYXdRdWVyeShgL2NvbGxlY3Rpb25zYCwge1xyXG4gICAgICAgICAgICBtZXRob2Q6IFwiUE9TVFwiLFxyXG4gICAgICAgICAgICBib2R5OiBjb2xsZWN0aW9uLFxyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIHJldHVybiBjcmVhdGVkQ29sbGVjdGlvbjtcclxuICAgIH1cclxuXHJcbiAgICBhc3luYyBkZWxldGUoY29sbGVjdGlvbklkOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcclxuICAgICAgICBhd2FpdCB0aGlzLmNvbnRleHQucmF3UXVlcnkoYC9jb2xsZWN0aW9ucy8ke2NvbGxlY3Rpb25JZH1gLCB7XHJcbiAgICAgICAgICAgIG1ldGhvZDogXCJERUxFVEVcIixcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICBhc3luYyBxdWVyeUl0ZW1zKGNvbGxlY3Rpb25JZDogc3RyaW5nLCBxdWVyeTogSXRlbVF1ZXJ5KTogUHJvbWlzZTxJdGVtUXVlcnlMaXN0PiB7XHJcbiAgICAgICAgY29uc3QgcXVlcnlSZXN1bHQ6IEl0ZW1RdWVyeUxpc3QgPSBhd2FpdCB0aGlzLmNvbnRleHQucmF3UXVlcnkoYC9jb2xsZWN0aW9ucy8ke2NvbGxlY3Rpb25JZH0vaXRlbXMvcXVlcnlgLCB7XHJcbiAgICAgICAgICAgIG1ldGhvZDogXCJQVVRcIixcclxuICAgICAgICAgICAgYm9keTogcXVlcnksXHJcbiAgICAgICAgfSlcclxuXHJcbiAgICAgICAgcmV0dXJuIHF1ZXJ5UmVzdWx0O1xyXG4gICAgfVxyXG5cclxuICAgIGFzeW5jIGNyZWF0ZUl0ZW1zKGNvbGxlY3Rpb25JZDogc3RyaW5nLCBpdGVtczogYW55KTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgICAgICAgYXdhaXQgdGhpcy5jb250ZXh0LnJhd1F1ZXJ5KGAvY29sbGVjdGlvbnMvJHtjb2xsZWN0aW9uSWR9L2l0ZW1zYCwge1xyXG4gICAgICAgICAgICBtZXRob2Q6IFwiUE9TVFwiLFxyXG4gICAgICAgICAgICBib2R5OiB7XHJcbiAgICAgICAgICAgICAgICAuLi5pdGVtcyxcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH0pXHJcbiAgICB9XHJcblxyXG4gICAgYXN5bmMgZGVsZXRlSXRlbShjb2xsZWN0aW9uSWQ6IHN0cmluZywgaXRlbUlkOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcclxuICAgICAgICBhd2FpdCB0aGlzLmNvbnRleHQucmF3UXVlcnkoYC9jb2xsZWN0aW9ucy8ke2NvbGxlY3Rpb25JZH0vaXRlbXMvJHtpdGVtSWR9YCwge1xyXG4gICAgICAgICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXHJcbiAgICAgICAgfSk7XHJcbiAgICB9XHJcbn1cclxuIiwiaW1wb3J0IHtTY29wZXNBUEl9IGZyb20gXCIuLi8uLi9zY29wZVwiO1xyXG5pbXBvcnQge1Jhd0FQSSwgUmF3T3B0aW9uc30gZnJvbSBcIi4uLy4uL2Jhc2VcIjtcclxuaW1wb3J0IHtTY29wZVRva2VuQW5kU2NvcGVJZH0gZnJvbSBcIi4uL3Jvb3QvdHlwZXMvc2NvcGUtdG9rZW4tYW5kLXNjb3BlLWlkXCI7XHJcbmltcG9ydCB7XHJcbiAgICBXb3JrYmVuY2hTZXJ2aWNlQXBpVjNDdXN0b21Nb2RlbHNFeGFtaW5hdGlvbnNFeGFtaW5hdGlvblxyXG59IGZyb20gXCIuLi9yb290L3R5cGVzL3dvcmtiZW5jaC1zZXJ2aWNlLWFwaS12LTMtY3VzdG9tLW1vZGVscy1leGFtaW5hdGlvbnMtZXhhbWluYXRpb25cIjtcclxuaW1wb3J0IFJvb3QgZnJvbSBcIi4uL3Jvb3Qvcm9vdFwiO1xyXG5pbXBvcnQgU3RvcmFnZSBmcm9tIFwiLi9zdG9yYWdlXCI7XHJcbmltcG9ydCB7Z2V0Snd0VG9rZW5FeHBpcmVzVGltZW91dCwgcGFyc2VKd3RUb2tlbiwgU2NvcGVUb2tlbn0gZnJvbSBcIi4uLy4uL3V0aWxzXCI7XHJcbmltcG9ydCBBbm5vdGF0aW9ucyBmcm9tIFwiLi9hbm5vdGF0aW9uc1wiO1xyXG5pbXBvcnQgQ29sbGVjdGlvbnMgZnJvbSBcIi4vY29sbGVjdGlvbnNcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFNjb3BlcyBleHRlbmRzIFNjb3Blc0FQSSB7XHJcbiAgICBzdGF0aWMgYXBpUGF0aCA9ICcvdjMvc2NvcGVzJztcclxuXHJcbiAgICAvLyBJbnRlcmZhY2VcclxuICAgIHJhdzogUmF3QVBJO1xyXG4gICAgY29udGV4dDogUm9vdDtcclxuICAgIHN0b3JhZ2U6IFN0b3JhZ2U7XHJcbiAgICBhbm5vdGF0aW9uczogQW5ub3RhdGlvbnM7XHJcbiAgICBjb2xsZWN0aW9uczogQ29sbGVjdGlvbnM7XHJcblxyXG4gICAgLy8gQWRkaXRpb25hbFxyXG4gICAgc2NvcGVDb250ZXh0OiBTY29wZVRva2VuQW5kU2NvcGVJZCB8IG51bGwgPSBudWxsO1xyXG4gICAgcHJpdmF0ZSBfZGVmYXVsdEV4YW1pbmF0aW9uSWQ6IHN0cmluZyA9IFwiXCI7XHJcbiAgICBwcml2YXRlIF9hY3RpdmVFeGFtaW5hdGlvbklkOiBzdHJpbmcgPSBcIlwiO1xyXG4gICAgcHJpdmF0ZSBfdG9rZW5SZWZldGNoSW50ZXJ2YWw6IE5vZGVKUy5UaW1lb3V0IHwgbnVsbCA9IG51bGw7XHJcblxyXG4gICAgY29uc3RydWN0b3IoY29udGV4dDogUm9vdCkge1xyXG4gICAgICAgIHN1cGVyKCk7XHJcbiAgICAgICAgdGhpcy5jb250ZXh0ID0gY29udGV4dDtcclxuICAgICAgICB0aGlzLnJhdyA9IG5ldyBSYXdBUEkodGhpcy5jb250ZXh0Lm9wdGlvbnMuYXBpVXJsICsgU2NvcGVzLmFwaVBhdGgpO1xyXG4gICAgICAgIHRoaXMuc3RvcmFnZSA9IG5ldyBTdG9yYWdlKHRoaXMpO1xyXG4gICAgICAgIHRoaXMuYW5ub3RhdGlvbnMgPSBuZXcgQW5ub3RhdGlvbnModGhpcyk7XHJcbiAgICAgICAgdGhpcy5jb2xsZWN0aW9ucyA9IG5ldyBDb2xsZWN0aW9ucyh0aGlzKTtcclxuICAgIH1cclxuXHJcbiAgICBhc3luYyB1c2UoY2FzZUlkOiBzdHJpbmcsIGFwcElkOiBzdHJpbmcgfCB1bmRlZmluZWQgPSB1bmRlZmluZWQpOiBQcm9taXNlPHZvaWQ+IHtcclxuICAgICAgICAvL3RvZG8gY29uc2lkZXIgY2FjaGluZ1xyXG5cclxuICAgICAgICB0aGlzLnJlcXVpcmVzKFwicm9vdDo6dXNlcklkXCIsIHRoaXMuY29udGV4dC51c2VySWQpO1xyXG5cclxuICAgICAgICBjb25zdCBmaW5kRXhhbWluYXRpb24gPSBhc3luYyAoYXBwSWQ6IHN0cmluZyk6XHJcbiAgICAgICAgICAgIFByb21pc2U8V29ya2JlbmNoU2VydmljZUFwaVYzQ3VzdG9tTW9kZWxzRXhhbWluYXRpb25zRXhhbWluYXRpb24+ID0+IHtcclxuXHJcbiAgICAgICAgICAgIGxldCBleGFtaW5hdGlvbnMgPSBhd2FpdCB0aGlzLmNvbnRleHQuZXhhbWluYXRpb25zLnF1ZXJ5KHtcclxuICAgICAgICAgICAgICAgIGFwcHM6IFthcHBJZF0sXHJcbiAgICAgICAgICAgICAgICBjcmVhdG9yczogW3RoaXMuY29udGV4dC51c2VySWRdXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBpZiAoZXhhbWluYXRpb25zLml0ZW1fY291bnQgPiAwKSB7XHJcbiAgICAgICAgICAgICAgICBsZXQgZXhhbWluYXRpb24gPSBleGFtaW5hdGlvbnMuaXRlbXMuZmluZChleCA9PiBleC5zdGF0ZSA9PT0gXCJPUEVOXCIpO1xyXG4gICAgICAgICAgICAgICAgaWYgKGV4YW1pbmF0aW9uKSByZXR1cm4gZXhhbWluYXRpb247XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuY29udGV4dC5leGFtaW5hdGlvbnMuY3JlYXRlKGNhc2VJZCwgYXBwSWQpO1xyXG4gICAgICAgIH1cclxuXHJcblxyXG4gICAgICAgIGxldCBleGFtaW5hdGlvbjtcclxuICAgICAgICBpZiAoYXBwSWQpIHtcclxuICAgICAgICAgICAgZXhhbWluYXRpb24gPSBhd2FpdCBmaW5kRXhhbWluYXRpb24oYXBwSWQpO1xyXG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5fZGVmYXVsdEV4YW1pbmF0aW9uSWQpIHtcclxuICAgICAgICAgICAgZXhhbWluYXRpb24gPSBhd2FpdCB0aGlzLmNvbnRleHQuZXhhbWluYXRpb25zLmdldCh0aGlzLl9kZWZhdWx0RXhhbWluYXRpb25JZCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoIWV4YW1pbmF0aW9uKSB7XHJcbiAgICAgICAgICAgIGxldCBhcHAgPSBhd2FpdCB0aGlzLmNvbnRleHQuYXBwcy5kZWZhdWx0KCk7XHJcbiAgICAgICAgICAgIGV4YW1pbmF0aW9uID0gYXdhaXQgZmluZEV4YW1pbmF0aW9uKGFwcC5hcHBfaWQpO1xyXG4gICAgICAgICAgICB0aGlzLl9kZWZhdWx0RXhhbWluYXRpb25JZCA9IGV4YW1pbmF0aW9uLmlkO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgYXdhaXQgdGhpcy5mcm9tKGV4YW1pbmF0aW9uKTtcclxuICAgIH1cclxuXHJcbiAgICBnZXQgc2NvcGVUb2tlbigpOiBzdHJpbmcgfCB1bmRlZmluZWQge1xyXG4gICAgICAgIHJldHVybiB0aGlzLnNjb3BlQ29udGV4dD8uYWNjZXNzX3Rva2VuO1xyXG4gICAgfVxyXG5cclxuICAgIGFzeW5jIGZyb20oZXhhbWluYXRpb246IFdvcmtiZW5jaFNlcnZpY2VBcGlWM0N1c3RvbU1vZGVsc0V4YW1pbmF0aW9uc0V4YW1pbmF0aW9uKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgICAgICAgdGhpcy5yZXNldCgpO1xyXG4gICAgICAgIHRoaXMuc2NvcGVDb250ZXh0ID0gYXdhaXQgdGhpcy5jb250ZXh0LmV4YW1pbmF0aW9ucy5zY29wZShleGFtaW5hdGlvbi5pZCk7XHJcbiAgICAgICAgdGhpcy5fYWN0aXZlRXhhbWluYXRpb25JZCA9IGV4YW1pbmF0aW9uLmlkO1xyXG4gICAgICAgIGNvbnN0IHRva2VuID0gcGFyc2VKd3RUb2tlbih0aGlzLnNjb3BlQ29udGV4dC5hY2Nlc3NfdG9rZW4pIGFzIFNjb3BlVG9rZW47XHJcbiAgICAgICAgY29uc3QgdGltZW91dCA9IGdldEp3dFRva2VuRXhwaXJlc1RpbWVvdXQodG9rZW4pO1xyXG4gICAgICAgIHRoaXMuX3Rva2VuUmVmZXRjaEludGVydmFsID0gc2V0SW50ZXJ2YWwoYXN5bmMgKCkgPT4ge1xyXG4gICAgICAgICAgICB0aGlzLnNjb3BlQ29udGV4dCA9IGF3YWl0IHRoaXMuY29udGV4dC5leGFtaW5hdGlvbnMuc2NvcGUoZXhhbWluYXRpb24uaWQpO1xyXG4gICAgICAgIH0sIHRpbWVvdXQpO1xyXG4gICAgICAgIHRoaXMucmFpc2VFdmVudCgnaW5pdCcpO1xyXG4gICAgfVxyXG5cclxuICAgIHJlc2V0KCk6IHZvaWQge1xyXG4gICAgICAgIHRoaXMuX2FjdGl2ZUV4YW1pbmF0aW9uSWQgPSBcIlwiO1xyXG4gICAgICAgIHRoaXMuc2NvcGVDb250ZXh0ID0gbnVsbDtcclxuICAgICAgICBpZiAodGhpcy5fdG9rZW5SZWZldGNoSW50ZXJ2YWwpIHtcclxuICAgICAgICAgICAgY2xlYXJJbnRlcnZhbCh0aGlzLl90b2tlblJlZmV0Y2hJbnRlcnZhbCk7XHJcbiAgICAgICAgICAgIHRoaXMuX3Rva2VuUmVmZXRjaEludGVydmFsID0gbnVsbDtcclxuICAgICAgICAgICAgLy90b2RvIGNsZWFyIGFsbCBjYWNoZWQgZGF0YVxyXG4gICAgICAgICAgICB0aGlzLnJhaXNlRXZlbnQoJ3Jlc2V0Jyk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGFzeW5jIHJhd1F1ZXJ5KGVuZHBvaW50OiBzdHJpbmcsIG9wdGlvbnM/OiBSYXdPcHRpb25zKTogUHJvbWlzZTxhbnk+IHtcclxuICAgICAgICB0aGlzLnJlcXVpcmVzKCd0aGlzLnNjb3BlQ29udGV4dCcsIHRoaXMuc2NvcGVDb250ZXh0KTtcclxuICAgICAgICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTtcclxuICAgICAgICBvcHRpb25zLmhlYWRlcnMgPSBvcHRpb25zLmhlYWRlcnMgfHwge307XHJcbiAgICAgICAgb3B0aW9ucy5oZWFkZXJzW1wiQXV0aG9yaXphdGlvblwiXSA9IGBCZWFyZXIgJHt0aGlzLnNjb3BlQ29udGV4dD8uYWNjZXNzX3Rva2VufWA7XHJcbiAgICAgICAgaWYgKGVuZHBvaW50ICYmICFlbmRwb2ludC5zdGFydHNXaXRoKCcvJykpIHtcclxuICAgICAgICAgICAgZW5kcG9pbnQgPSBgLyR7ZW5kcG9pbnR9YDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIHJldHVybiBhd2FpdCB0aGlzLnJhdy5odHRwKGAvJHt0aGlzLnNjb3BlQ29udGV4dD8uc2NvcGVfaWR9JHtlbmRwb2ludH1gLCBvcHRpb25zKTtcclxuICAgICAgICB9IGNhdGNoIChlKSB7XHJcbiAgICAgICAgICAgIGlmIChlLnN0YXR1c0NvZGUgPT09IDQwMSkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5zY29wZUNvbnRleHQgPSBhd2FpdCB0aGlzLmNvbnRleHQuZXhhbWluYXRpb25zLnNjb3BlKHRoaXMuX2FjdGl2ZUV4YW1pbmF0aW9uSWQpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMucmF3Lmh0dHAoYC8ke3RoaXMuc2NvcGVDb250ZXh0LnNjb3BlX2lkfSR7ZW5kcG9pbnR9YCwgb3B0aW9ucyk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHRocm93IGU7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG59XHJcbiIsIi8qIHRzbGludDpkaXNhYmxlICovXHJcbi8qIGVzbGludC1kaXNhYmxlICovXHJcbmV4cG9ydCBlbnVtIEdsb2JhbERhdGFDcmVhdG9yVHlwZSB7XHJcbiAgVVNFUiA9IFwidXNlclwiLFxyXG4gIFNDT1BFID0gXCJzY29wZVwiLFxyXG4gIEpPQiA9IFwiam9iXCJcclxufSIsIi8qIHRzbGludDpkaXNhYmxlICovXHJcbi8qIGVzbGludC1kaXNhYmxlICovXHJcbmV4cG9ydCBlbnVtIEdsb2JhbEl0ZW1SZWZlcmVuY2VUeXBlIHtcclxuICBBTk5PVEFUSU9OID0gXCJhbm5vdGF0aW9uXCIsXHJcbiAgQ09MTEVDVElPTiA9IFwiY29sbGVjdGlvblwiLFxyXG4gIENMQVNTID0gXCJjbGFzc1wiLFxyXG4gIFBSSU1JVElWRSA9IFwicHJpbWl0aXZlXCIsXHJcbiAgV1NJID0gXCJ3c2lcIixcclxuICBDQVNFID0gXCJjYXNlXCIsXHJcbiAgVVNFUiA9IFwidXNlclwiLFxyXG4gIFNDT1BFID0gXCJzY29wZVwiLFxyXG4gIEpPQiA9IFwiam9iXCJcclxufSIsIi8qIHRzbGludDpkaXNhYmxlICovXHJcbi8qIGVzbGludC1kaXNhYmxlICovXHJcbmV4cG9ydCBlbnVtIFRlbXBsYXRlVHlwZSB7XHJcbiAgQmFja2dyb3VuZCA9ICdiYWNrZ3JvdW5kJyxcclxuICBQYXJhbXMgPSAncGFyYW1zJyxcclxuICBTaGFkZXIgPSAnc2hhZGVyJyxcclxuICBWaXN1YWxpemF0aW9uID0gJ3Zpc3VhbGl6YXRpb24nXHJcbn0iLCJpbXBvcnQge1Jvb3RBUEksIFJvb3RDb250ZXh0fSBmcm9tIFwiLi4vLi4vcm9vdFwiO1xyXG5pbXBvcnQgUm9vdCBmcm9tIFwiLi9yb290XCI7XHJcbmltcG9ydCB7IFNsaWRlIH0gZnJvbSBcIi4vdHlwZXMvc2xpZGVcIjtcclxuaW1wb3J0IHsgU2xpZGVJbmZvIH0gZnJvbSBcIi4vdHlwZXMvc2xpZGUtaW5mb1wiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2xpZGVzIGV4dGVuZHMgUm9vdENvbnRleHQge1xyXG4gICAgcHJvdGVjdGVkIGNvbnRleHQ6IFJvb3RBUEk7XHJcbiAgICBwcm90ZWN0ZWQgZGF0YTogU2xpZGVJbmZvIHwgbnVsbCA9IG51bGw7XHJcblxyXG4gICAgY29uc3RydWN0b3IoY29udGV4dDogUm9vdCkge1xyXG4gICAgICAgIHN1cGVyKCk7XHJcbiAgICAgICAgdGhpcy5jb250ZXh0ID0gY29udGV4dDtcclxuICAgIH1cclxuXHJcbiAgICBhc3luYyBzbGlkZUluZm8oc2xpZGVJZDogc3RyaW5nKTogUHJvbWlzZTxTbGlkZUluZm8+IHtcclxuICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5jb250ZXh0LnJhd1F1ZXJ5KGAvc2xpZGVzLyR7c2xpZGVJZH0vaW5mb2ApXHJcbiAgICB9XHJcblxyXG4gICAgYXN5bmMgc2xpZGVUaHVtYm5haWwoc2xpZGVJZDogc3RyaW5nLCBtYXhXaWR0aDogbnVtYmVyLCBtYXhIZWlnaHQ6IG51bWJlciwgZm9ybWF0Pzogc3RyaW5nKTogUHJvbWlzZTxCbG9iPiB7XHJcbiAgICAgICAgcmV0dXJuIGF3YWl0IHRoaXMuY29udGV4dC5yYXdRdWVyeShgL3NsaWRlcy8ke3NsaWRlSWR9L3RodW1ibmFpbC9tYXhfc2l6ZS8ke21heFdpZHRofS8ke21heEhlaWdodH1gLCB7XHJcbiAgICAgICAgICAgIHF1ZXJ5OiB7XHJcbiAgICAgICAgICAgICAgICBpbWFnZV9mb3JtYXQ6IGZvcm1hdFxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICByZXNwb25zZVR5cGU6IFwiYmxvYlwiXHJcbiAgICAgICAgfSlcclxuICAgIH1cclxuXHJcbiAgICBhc3luYyBzbGlkZUxhYmVsKHNsaWRlSWQ6IHN0cmluZywgbWF4V2lkdGg6IG51bWJlciwgbWF4SGVpZ2h0OiBudW1iZXIsIGZvcm1hdD86IHN0cmluZyk6IFByb21pc2U8QmxvYj4ge1xyXG4gICAgICAgIHJldHVybiBhd2FpdCB0aGlzLmNvbnRleHQucmF3UXVlcnkoYC9zbGlkZXMvJHtzbGlkZUlkfS9sYWJlbC9tYXhfc2l6ZS8ke21heFdpZHRofS8ke21heEhlaWdodH1gLCB7XHJcbiAgICAgICAgICAgIHF1ZXJ5OiB7XHJcbiAgICAgICAgICAgICAgICBpbWFnZV9mb3JtYXQ6IGZvcm1hdFxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICByZXNwb25zZVR5cGU6IFwiYmxvYlwiXHJcbiAgICAgICAgfSlcclxuICAgIH1cclxuXHJcbiAgICBhc3luYyBsb2FkVGlsZShzbGlkZUlkOiBzdHJpbmcsIGxldmVsOiBudW1iZXIsIHg6IG51bWJlciwgeTogbnVtYmVyLCBmb3JtYXQ/OiBzdHJpbmcpOiBQcm9taXNlPEJsb2I+IHtcclxuICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy5jb250ZXh0LnJhd1F1ZXJ5KGAvc2xpZGVzLyR7c2xpZGVJZH0vdGlsZS9sZXZlbC8ke2xldmVsfS90aWxlLyR7eH0vJHt5fWAsIHtcclxuICAgICAgICAgICAgcXVlcnk6IHtcclxuICAgICAgICAgICAgICAgIGltYWdlX2Zvcm1hdDogZm9ybWF0XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHJlc3BvbnNlVHlwZTogXCJibG9iXCJcclxuICAgICAgICB9KVxyXG4gICAgfVxyXG59XHJcbiIsImltcG9ydCBHbG9iYWxTdG9yYWdlIGZyb20gXCIuLi9yYXRpb25haS9nbG9iYWwtc3RvcmFnZVwiO1xyXG5pbXBvcnQgeyBHbG9iYWxJdGVtIH0gZnJvbSBcIi4uL3JhdGlvbmFpL3R5cGVzL2dsb2JhbC1pdGVtXCI7XHJcbmltcG9ydCB7IEdsb2JhbEl0ZW1SZWZlcmVuY2VUeXBlIH0gZnJvbSBcIi4uL3JhdGlvbmFpL3R5cGVzL2dsb2JhbC1pdGVtLXJlZmVyZW5jZS10eXBlXCI7XHJcbmltcG9ydCB7IE1hc2tNZXRhZGF0YSB9IGZyb20gXCIuL3R5cGVzL21hc2stbWV0YWRhdGFcIjtcclxuaW1wb3J0IHsgU2hhZGVyLCBTbGlkZU1ldGFkYXRhIH0gZnJvbSBcIi4vdHlwZXMvc2xpZGUtbWV0YWRhdGFcIjtcclxuaW1wb3J0IHsgVGVtcGxhdGVUeXBlIH0gZnJvbSBcIi4vdHlwZXMvdGVtcGxhdGUtdHlwZVwiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgV3NpTWV0YWRhdGEge1xyXG4gICAgcHJvdGVjdGVkIGNvbnRleHQ6IEdsb2JhbFN0b3JhZ2U7XHJcbiAgICBwcm90ZWN0ZWQgZGF0YTogR2xvYmFsSXRlbSB8IG51bGwgPSBudWxsO1xyXG5cclxuICAgIHByaXZhdGUgZGVmYXVsdFNsaWRlTWV0YWRhdGE6IFNsaWRlTWV0YWRhdGEgPSB7IHZpc3VhbGl6YXRpb246IHt9IH1cclxuICAgIHByaXZhdGUgZGVmYXVsdE1hc2tNZXRhZGF0YTogTWFza01ldGFkYXRhID0ge31cclxuXHJcbiAgICBjb25zdHJ1Y3Rvcihjb250ZXh0OiBHbG9iYWxTdG9yYWdlKSB7XHJcbiAgICAgICAgdGhpcy5jb250ZXh0ID0gY29udGV4dDtcclxuICAgIH1cclxuXHJcbiAgICAvLyBTbGlkZVxyXG5cclxuICAgIHByaXZhdGUgYXN5bmMgZ2V0V3NpTWV0YWRhdGFJdGVtKHdzaUlkOiBzdHJpbmcsIGlzU2xpZGU6IGJvb2xlYW4gPSB0cnVlKTogUHJvbWlzZTxHbG9iYWxJdGVtPiB7XHJcbiAgICAgIGxldCBtZXRhZGF0YSA9IChhd2FpdCB0aGlzLmNvbnRleHQucXVlcnkoe3JlZmVyZW5jZXM6IFt3c2lJZF19KSkuZmluZCgocCkgPT4gcC5kYXRhX3R5cGUgPT09IGAke2lzU2xpZGUgPyBcInNsaWRlXCIgOiBcIm1hc2tcIn1fbWV0YWRhdGFgKTtcclxuICAgICAgaWYgKCFtZXRhZGF0YSkge1xyXG4gICAgICAgIG1ldGFkYXRhID0gIGF3YWl0IHRoaXMuY3JlYXRlV3NpTWV0YWRhdGFJdGVtKHdzaUlkLCBpc1NsaWRlID8gdGhpcy5kZWZhdWx0U2xpZGVNZXRhZGF0YSA6IHRoaXMuZGVmYXVsdE1hc2tNZXRhZGF0YSlcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gbWV0YWRhdGFcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIGFzeW5jIGNyZWF0ZVdzaU1ldGFkYXRhSXRlbSh3c2lJZDogc3RyaW5nLCB2YWx1ZTogYW55LCBpc1NsaWRlOiBib29sZWFuID0gdHJ1ZSk6IFByb21pc2U8R2xvYmFsSXRlbT4ge1xyXG4gICAgcmV0dXJuIGF3YWl0IHRoaXMuY29udGV4dC5jcmVhdGVWYWx1ZSh2YWx1ZSwgYE1ldGFkYXRhIG9mICR7aXNTbGlkZSA/IFwic2xpZGVcIiA6IFwibWFza1wifSAke3dzaUlkfWAsIHVuZGVmaW5lZCwgd3NpSWQsIEdsb2JhbEl0ZW1SZWZlcmVuY2VUeXBlLldTSSwgYCR7aXNTbGlkZSA/IFwic2xpZGVcIiA6IFwibWFza1wifV9tZXRhZGF0YWApXHJcbiAgICB9XHJcblxyXG4gICAgYXN5bmMgZ2V0U2xpZGVNZXRhZGF0YShzbGlkZUlkOiBzdHJpbmcpOiBQcm9taXNlPFNsaWRlTWV0YWRhdGE+IHtcclxuICAgICAgcmV0dXJuIEpTT04ucGFyc2UoKGF3YWl0IHRoaXMuZ2V0V3NpTWV0YWRhdGFJdGVtKHNsaWRlSWQpKS52YWx1ZSBhcyBzdHJpbmcpXHJcbiAgICB9XHJcblxyXG4gICAgYXN5bmMgdXBkYXRlU2xpZGVNZXRhZGF0YShzbGlkZUlkOiBzdHJpbmcsIHZhbHVlOiBTbGlkZU1ldGFkYXRhKTogUHJvbWlzZTxTbGlkZU1ldGFkYXRhIHwgZmFsc2U+IHtcclxuICAgICAgY29uc3QgbWV0YWRhdGFJdGVtID0gYXdhaXQgdGhpcy5nZXRXc2lNZXRhZGF0YUl0ZW0oc2xpZGVJZCk7XHJcbiAgICAgIHRyeSB7XHJcbiAgICAgICAgY29uc3QgdXBkYXRlZEl0ZW0gPSBhd2FpdCB0aGlzLmNvbnRleHQudXBkYXRlKG1ldGFkYXRhSXRlbS5pZCwgey4uLm1ldGFkYXRhSXRlbSwgdmFsdWU6IEpTT04uc3RyaW5naWZ5KHZhbHVlKX0pXHJcbiAgICAgICAgcmV0dXJuIEpTT04ucGFyc2UodXBkYXRlZEl0ZW0udmFsdWUpXHJcbiAgICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgICByZXR1cm4gZmFsc2VcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgYXN5bmMgZ2V0U2hhZGVyc0NvbmZpZyhzaGFkZXJzOiBTaGFkZXJbXSk6IFByb21pc2U8b2JqZWN0PiB7XHJcbiAgICAgIGNvbnN0IHNoYWRlcnNDb25maWcgPSB7fVxyXG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHNoYWRlcnMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICBjb25zdCBzaGFkZXJUZW1wID0gYXdhaXQgdGhpcy5jb250ZXh0LnZpc1RlbXBsYXRlcy5nZXRUZW1wbGF0ZShUZW1wbGF0ZVR5cGUuU2hhZGVyLCBzaGFkZXJzW2ldLnNoYWRlclRlbXBsYXRlKTtcclxuICAgICAgICBzaGFkZXJzQ29uZmlnW3NoYWRlcnNbaV0uaWRdID0ge1xyXG4gICAgICAgICAgLi4uc2hhZGVyVGVtcCxcclxuICAgICAgICAgICAgICAgIG5hbWU6IHNoYWRlcnNbaV0ubmFtZSB8fCBzaGFkZXJzW2ldLmlkLFxyXG4gICAgICAgICAgICAgICAgZGF0YVJlZmVyZW5jZXM6IHNoYWRlcnNbaV0uZGF0YVJlZnMsXHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiBzaGFkZXJzQ29uZmlnO1xyXG4gICAgfVxyXG5cclxuICAgIGFzeW5jIGdldFZpc3VhbGl6YXRpb25zKHNsaWRlSWQ6IHN0cmluZyk6IFByb21pc2U8YW55PiB7XHJcbiAgICAgIGNvbnN0IHNsaWRlVmlzID0gKGF3YWl0IHRoaXMuZ2V0U2xpZGVNZXRhZGF0YShzbGlkZUlkKSkudmlzdWFsaXphdGlvbjtcclxuICAgICAgY29uc3QgdmlzdWFsaXphdGlvbnMgPSB7XHJcbiAgICAgICAgcGFyYW1zOiBzbGlkZVZpcy5wYXJhbXNUZW1wbGF0ZSA/IChhd2FpdCB0aGlzLmNvbnRleHQudmlzVGVtcGxhdGVzLmdldFRlbXBsYXRlKFRlbXBsYXRlVHlwZS5QYXJhbXMsIHNsaWRlVmlzLnBhcmFtc1RlbXBsYXRlKSB8fCB1bmRlZmluZWQpIDogdW5kZWZpbmVkLFxyXG4gICAgICAgIGRhdGE6IHNsaWRlVmlzLmRhdGEsXHJcbiAgICAgICAgYmFja2dyb3VuZDoge1xyXG4gICAgICAgICAgLi4uKHNsaWRlVmlzLmJhY2tncm91bmQgPyBhd2FpdCB0aGlzLmNvbnRleHQudmlzVGVtcGxhdGVzLmdldFRlbXBsYXRlKFRlbXBsYXRlVHlwZS5CYWNrZ3JvdW5kLCBzbGlkZVZpcy5iYWNrZ3JvdW5kPy50ZW1wbGF0ZSkgOiB7fSksXHJcbiAgICAgICAgICBkYXRhOiBzbGlkZVZpcy5iYWNrZ3JvdW5kICYmIHNsaWRlVmlzLmJhY2tncm91bmQuZGF0YVJlZixcclxuICAgICAgICB9LFxyXG4gICAgICAgIHZpc3VhbGl6YXRpb25zOiBzbGlkZVZpcy52aXN1YWxpemF0aW9ucyAmJiBhd2FpdCBQcm9taXNlLmFsbChzbGlkZVZpcy52aXN1YWxpemF0aW9ucy5tYXAoYXN5bmMgKHZpcykgPT4ge1xyXG4gICAgICAgICAgcmV0dXJuICh7XHJcbiAgICAgICAgICAgIC4uLmF3YWl0IHRoaXMuY29udGV4dC52aXNUZW1wbGF0ZXMuZ2V0VGVtcGxhdGUoVGVtcGxhdGVUeXBlLlZpc3VhbGl6YXRpb24sIHZpcy52aXNUZW1wbGF0ZSksXHJcbiAgICAgICAgICAgIG5hbWU6IHZpcy5uYW1lLFxyXG4gICAgICAgICAgICBzaGFkZXJzOiBhd2FpdCB0aGlzLmdldFNoYWRlcnNDb25maWcodmlzLnNoYWRlcnMpLFxyXG4gICAgICAgICAgfSlcclxuICAgICAgICB9KSlcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gdmlzdWFsaXphdGlvbnM7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gTUFTS1xyXG5cclxuICAgIGFzeW5jIGdldE1hc2tNZXRhZGF0YShzbGlkZUlkOiBzdHJpbmcpOiBQcm9taXNlPE1hc2tNZXRhZGF0YT4ge1xyXG4gICAgICByZXR1cm4gSlNPTi5wYXJzZSgoYXdhaXQgdGhpcy5nZXRXc2lNZXRhZGF0YUl0ZW0oc2xpZGVJZCwgZmFsc2UpKS52YWx1ZSBhcyBzdHJpbmcpXHJcbiAgICB9XHJcbn0iLCJpbXBvcnQgR2xvYmFsU3RvcmFnZSBmcm9tIFwiLi4vcmF0aW9uYWkvZ2xvYmFsLXN0b3JhZ2VcIjtcclxuaW1wb3J0IHsgR2xvYmFsSXRlbSB9IGZyb20gXCIuLi9yYXRpb25haS90eXBlcy9nbG9iYWwtaXRlbVwiO1xyXG5pbXBvcnQgeyBUZW1wbGF0ZVR5cGUgfSBmcm9tIFwiLi90eXBlcy90ZW1wbGF0ZS10eXBlXCI7XHJcblxyXG5jb25zdCB0ZW1wbGF0ZXNHbG9iYWxJdGVtRGF0YVR5cGUgPSBcInZpc190ZW1wbGF0ZXNcIlxyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgVmlzdWFsaXphdGlvblRlbXBsYXRlcyB7XHJcbiAgICBwcm90ZWN0ZWQgY29udGV4dDogR2xvYmFsU3RvcmFnZTtcclxuICAgIHByb3RlY3RlZCBkYXRhOiBvYmplY3QgfCBudWxsID0gbnVsbDtcclxuXHJcbiAgICBjb25zdHJ1Y3Rvcihjb250ZXh0OiBHbG9iYWxTdG9yYWdlKSB7XHJcbiAgICAgICAgdGhpcy5jb250ZXh0ID0gY29udGV4dDtcclxuICAgIH1cclxuXHJcbiAgICBhc3luYyBmZXRjaFRlbXBsYXRlSXRlbSh0eXBlOiBUZW1wbGF0ZVR5cGUsIG5hbWU6IHN0cmluZyk6IFByb21pc2U8R2xvYmFsSXRlbSB8IHVuZGVmaW5lZD4ge1xyXG4gICAgICByZXR1cm4gKGF3YWl0IHRoaXMuY29udGV4dC5xdWVyeSh7cmVmZXJlbmNlczogW251bGxdLCBkYXRhX3R5cGVzOiBbYCR7dGVtcGxhdGVzR2xvYmFsSXRlbURhdGFUeXBlfV8ke3R5cGV9YF19KSkuZmluZCgoaXRlbSkgPT4gaXRlbS5uYW1lID09PSBuYW1lKVxyXG4gICAgfVxyXG5cclxuICAgIGFzeW5jIGdldFRlbXBsYXRlKHR5cGU6IFRlbXBsYXRlVHlwZSwgbmFtZTogc3RyaW5nKTogUHJvbWlzZTxvYmplY3QgfCBmYWxzZT4ge1xyXG4gICAgICBjb25zdCB0bXBsID0gYXdhaXQgdGhpcy5mZXRjaFRlbXBsYXRlSXRlbSh0eXBlLCBuYW1lKVxyXG4gICAgICBpZiAodG1wbCkge1xyXG4gICAgICAgIHJldHVybiBKU09OLnBhcnNlKHRtcGwudmFsdWUpO1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgICBhc3luYyBjcmVhdGVUZW1wbGF0ZSh0eXBlOiBUZW1wbGF0ZVR5cGUsIG5hbWU6IHN0cmluZywgdmFsdWU6IG9iamVjdCk6IFByb21pc2U8b2JqZWN0IHwgZmFsc2U+IHtcclxuICAgICAgY29uc3QgZXhpc3RpbmdUbXBsID0gYXdhaXQgdGhpcy5mZXRjaFRlbXBsYXRlSXRlbSh0eXBlLCBuYW1lKVxyXG4gICAgICBpZiAoZXhpc3RpbmdUbXBsKSB7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiBhd2FpdCB0aGlzLmNvbnRleHQuY3JlYXRlVmFsdWUodmFsdWUsIGAke25hbWV9YCwgdW5kZWZpbmVkLCB1bmRlZmluZWQsIHVuZGVmaW5lZCwgYCR7dGVtcGxhdGVzR2xvYmFsSXRlbURhdGFUeXBlfV8ke3R5cGV9YClcclxuICAgIH1cclxuXHJcbiAgICBhc3luYyBkZWxldGVUZW1wbGF0ZSh0eXBlOiBUZW1wbGF0ZVR5cGUsIG5hbWU6IHN0cmluZyk6IFByb21pc2U8Ym9vbGVhbj4ge1xyXG4gICAgICBjb25zdCBleGlzdGluZ1RtcGwgPSBhd2FpdCB0aGlzLmZldGNoVGVtcGxhdGVJdGVtKHR5cGUsIG5hbWUpXHJcbiAgICAgIGlmICghZXhpc3RpbmdUbXBsKSB7XHJcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICB9XHJcbiAgICAgIGF3YWl0IHRoaXMuY29udGV4dC5kZWxldGUoZXhpc3RpbmdUbXBsLmlkKTtcclxuICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9XHJcbn0iLCJpbXBvcnQgUmF0aW9uQUkgZnJvbSBcIi4vcmF0aW9uYWlcIjtcclxuaW1wb3J0IHsgR2xvYmFsSXRlbSB9IGZyb20gXCIuL3R5cGVzL2dsb2JhbC1pdGVtXCI7XHJcbmltcG9ydCB7IEdsb2JhbFN0b3JhZ2VRdWVyeSB9IGZyb20gXCIuL3R5cGVzL2dsb2JhbC1zdG9yYWdlLXF1ZXJ5XCI7XHJcbmltcG9ydCB7IEdsb2JhbEl0ZW1MaXN0IH0gZnJvbSBcIi4vdHlwZXMvZ2xvYmFsLWl0ZW0tbGlzdFwiO1xyXG5pbXBvcnQgeyBQb3N0R2xvYmFsSXRlbXMgfSBmcm9tIFwiLi90eXBlcy9wb3N0LWdsb2JhbC1pdGVtc1wiO1xyXG5pbXBvcnQgeyBHbG9iYWxJdGVtcyB9IGZyb20gXCIuL3R5cGVzL2dsb2JhbC1pdGVtc1wiO1xyXG5pbXBvcnQgeyBHbG9iYWxJdGVtUmVmZXJlbmNlVHlwZSB9IGZyb20gXCIuL3R5cGVzL2dsb2JhbC1pdGVtLXJlZmVyZW5jZS10eXBlXCI7XHJcbmltcG9ydCB7IFBvc3RHbG9iYWxJdGVtIH0gZnJvbSBcIi4vdHlwZXMvcG9zdC1nbG9iYWwtaXRlbVwiO1xyXG5pbXBvcnQgeyBHbG9iYWxEYXRhQ3JlYXRvclR5cGUgfSBmcm9tIFwiLi90eXBlcy9nbG9iYWwtZGF0YS1jcmVhdG9yLXR5cGVcIjtcclxuaW1wb3J0IHsgUHV0R2xvYmFsSXRlbSB9IGZyb20gXCIuL3R5cGVzL3B1dC1nbG9iYWwtaXRlbVwiO1xyXG5pbXBvcnQgV3NpTWV0YWRhdGEgZnJvbSBcIi4uL2V4dGVuc2lvbnMvd3NpLW1ldGFkYXRhXCI7XHJcbmltcG9ydCBWaXN1YWxpemF0aW9uVGVtcGxhdGVzIGZyb20gXCIuLi9leHRlbnNpb25zL3Zpc3VhbGl6YXRpb24tdGVtcGxhdGVzXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBHbG9iYWxTdG9yYWdlIHtcclxuICAgIHByb3RlY3RlZCBjb250ZXh0OiBSYXRpb25BSTtcclxuICAgIHByb3RlY3RlZCBkYXRhOiBHbG9iYWxJdGVtIHwgbnVsbCA9IG51bGw7XHJcblxyXG4gICAgd3NpTWV0YWRhdGE6IFdzaU1ldGFkYXRhXHJcbiAgICB2aXNUZW1wbGF0ZXM6IFZpc3VhbGl6YXRpb25UZW1wbGF0ZXNcclxuXHJcbiAgICBjb25zdHJ1Y3Rvcihjb250ZXh0OiBSYXRpb25BSSkge1xyXG4gICAgICAgIHRoaXMuY29udGV4dCA9IGNvbnRleHQ7XHJcbiAgICAgICAgdGhpcy53c2lNZXRhZGF0YSA9IG5ldyBXc2lNZXRhZGF0YSh0aGlzKVxyXG4gICAgICAgIHRoaXMudmlzVGVtcGxhdGVzID0gbmV3IFZpc3VhbGl6YXRpb25UZW1wbGF0ZXModGhpcylcclxuICAgIH1cclxuXHJcbiAgICBhc3luYyBnZXQoaXRlbUlkOiBzdHJpbmcpOiBQcm9taXNlPEdsb2JhbEl0ZW0+IHtcclxuICAgICAgY29uc3QgZ2xvYmFsSXRlbTogR2xvYmFsSXRlbSA9IGF3YWl0IHRoaXMuY29udGV4dC5yYXdRdWVyeShgL2dsb2JhbC1zdG9yYWdlLyR7aXRlbUlkfWApO1xyXG4gICAgICByZXR1cm4gZ2xvYmFsSXRlbTtcclxuICAgIH1cclxuXHJcbiAgICBhc3luYyBnZXRWYWx1ZShpdGVtSWQ6IHN0cmluZyk6IFByb21pc2U8YW55PiB7XHJcbiAgICAgIGNvbnN0IGl0ZW0gPSBhd2FpdCB0aGlzLmdldChpdGVtSWQpXHJcbiAgICAgIGlmIChpdGVtLnR5cGUgPT09IFwic3RyaW5nXCIpIHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgcmV0dXJuIEpTT04ucGFyc2UoaXRlbS52YWx1ZSk7XHJcbiAgICAgICAgfSBjYXRjaCB7XHJcbiAgICAgICAgICByZXR1cm4gaXRlbS52YWx1ZVxyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gaXRlbS52YWx1ZVxyXG4gICAgfVxyXG5cclxuICAgIGFzeW5jIHF1ZXJ5KHF1ZXJ5OiBHbG9iYWxTdG9yYWdlUXVlcnkpOiBQcm9taXNlPEdsb2JhbEl0ZW1bXT4ge1xyXG4gICAgICBjb25zdCBkYXRhOiBHbG9iYWxJdGVtTGlzdCA9IGF3YWl0IHRoaXMuY29udGV4dC5yYXdRdWVyeShgL2dsb2JhbC1zdG9yYWdlL3F1ZXJ5YCwge1xyXG4gICAgICAgICAgbWV0aG9kOiBcIlBVVFwiLFxyXG4gICAgICAgICAgYm9keTogcXVlcnksXHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgcmV0dXJuIGRhdGEuaXRlbXNcclxuICAgIH1cclxuXHJcbiAgICBhc3luYyBjcmVhdGUoaXRlbXM6IFBvc3RHbG9iYWxJdGVtcyk6IFByb21pc2U8R2xvYmFsSXRlbXM+IHtcclxuICAgICAgY29uc3QgY3JlYXRlZEl0ZW1zOiBHbG9iYWxJdGVtcyA9IGF3YWl0IHRoaXMuY29udGV4dC5yYXdRdWVyeShgL2dsb2JhbC1zdG9yYWdlYCwge1xyXG4gICAgICAgICAgbWV0aG9kOiBcIlBPU1RcIixcclxuICAgICAgICAgIGJvZHk6IGl0ZW1zLFxyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIHJldHVybiBjcmVhdGVkSXRlbXM7XHJcbiAgICB9XHJcblxyXG4gICAgYXN5bmMgY3JlYXRlVmFsdWUodmFsdWU6IGFueSwgbmFtZTogc3RyaW5nLCBkZXNjcmlwdGlvbj86IHN0cmluZywgcmVmZXJlbmNlX2lkPzogc3RyaW5nLCByZWZlcmVuY2VfdHlwZT86IEdsb2JhbEl0ZW1SZWZlcmVuY2VUeXBlLCBkYXRhX3R5cGU/OiBzdHJpbmcpOiBQcm9taXNlPEdsb2JhbEl0ZW0+IHtcclxuICAgICAgdmFsdWUgPSBKU09OLnN0cmluZ2lmeSh2YWx1ZSk7XHJcblxyXG4gICAgICBjb25zdCBuZXdJdGVtOiBQb3N0R2xvYmFsSXRlbSA9IHtcclxuICAgICAgICAgIG5hbWU6IG5hbWUsXHJcbiAgICAgICAgICBkZXNjcmlwdGlvbjogZGVzY3JpcHRpb24sXHJcbiAgICAgICAgICBjcmVhdG9yX2lkOiB0aGlzLmNvbnRleHQudXNlcklkLFxyXG4gICAgICAgICAgY3JlYXRvcl90eXBlOiBHbG9iYWxEYXRhQ3JlYXRvclR5cGUuVVNFUixcclxuICAgICAgICAgIHJlZmVyZW5jZV9pZDogcmVmZXJlbmNlX2lkLFxyXG4gICAgICAgICAgcmVmZXJlbmNlX3R5cGU6IHJlZmVyZW5jZV90eXBlLFxyXG4gICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcclxuICAgICAgICAgIHZhbHVlOiB2YWx1ZSxcclxuICAgICAgICAgIGRhdGFfdHlwZTogZGF0YV90eXBlXHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHJldHVybiBhd2FpdCB0aGlzLmNyZWF0ZShuZXdJdGVtKSBhcyBHbG9iYWxJdGVtO1xyXG4gICAgfVxyXG5cclxuICAgIGFzeW5jIHVwZGF0ZShpdGVtSWQ6IHN0cmluZywgaXRlbTogUHV0R2xvYmFsSXRlbSk6IFByb21pc2U8R2xvYmFsSXRlbT4ge1xyXG4gICAgICBjb25zdCB1cGRhdGVkSXRlbTogR2xvYmFsSXRlbSA9IGF3YWl0IHRoaXMuY29udGV4dC5yYXdRdWVyeShgL2dsb2JhbC1zdG9yYWdlLyR7aXRlbUlkfWAsIHtcclxuICAgICAgICAgIG1ldGhvZDogXCJQVVRcIixcclxuICAgICAgICAgIGJvZHk6IGl0ZW0sXHJcbiAgICAgIH0pO1xyXG4gICAgICByZXR1cm4gdXBkYXRlZEl0ZW07XHJcbiAgICB9XHJcblxyXG4gICAgYXN5bmMgdXBkYXRlVmFsdWUoaXRlbUlkOiBzdHJpbmcsIHZhbHVlOiBhbnkpOiBQcm9taXNlPEdsb2JhbEl0ZW0+IHtcclxuICAgICAgY29uc3QgaXRlbTogR2xvYmFsSXRlbSA9IGF3YWl0IHRoaXMuY29udGV4dC5yYXdRdWVyeShgL2dsb2JhbC1zdG9yYWdlLyR7aXRlbUlkfWApO1xyXG4gICAgICBpdGVtLnZhbHVlID0gSlNPTi5zdHJpbmdpZnkodmFsdWUpXHJcbiAgICAgIGNvbnN0IHVwZGF0ZWRJdGVtOiBHbG9iYWxJdGVtID0gYXdhaXQgdGhpcy5jb250ZXh0LnJhd1F1ZXJ5KGAvZ2xvYmFsLXN0b3JhZ2UvJHtpdGVtSWR9YCwge1xyXG4gICAgICAgICAgbWV0aG9kOiBcIlBVVFwiLFxyXG4gICAgICAgICAgYm9keTogaXRlbSxcclxuICAgICAgfSk7XHJcbiAgICAgIHJldHVybiB1cGRhdGVkSXRlbTtcclxuICAgIH1cclxuXHJcbiAgICBhc3luYyBkZWxldGUoaXRlbUlkOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcclxuICAgICAgYXdhaXQgdGhpcy5jb250ZXh0LnJhd1F1ZXJ5KGAvZ2xvYmFsLXN0b3JhZ2UvJHtpdGVtSWR9YCwge1xyXG4gICAgICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxyXG4gICAgICB9KTtcclxuICAgIH1cclxufVxyXG4iLCJpbXBvcnQge1Jhd09wdGlvbnN9IGZyb20gXCIuLi8uLi9iYXNlXCI7XHJcbmltcG9ydCBSb290IGZyb20gXCIuLi9yb290L3Jvb3RcIjtcclxuaW1wb3J0IEdsb2JhbFN0b3JhZ2UgZnJvbSBcIi4vZ2xvYmFsLXN0b3JhZ2VcIjtcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFJhdGlvbkFJIHtcclxuICAgIHN0YXRpYyByZWxhdGl2ZUFwaVBhdGggPSAnL3JhdGlvbmFpJztcclxuXHJcbiAgICBjb250ZXh0OiBSb290O1xyXG5cclxuICAgIC8vY3VzdG9tXHJcbiAgICBnbG9iYWxTdG9yYWdlOiBHbG9iYWxTdG9yYWdlO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKGNvbnRleHQ6IFJvb3QpIHtcclxuICAgICAgdGhpcy5jb250ZXh0ID0gY29udGV4dDtcclxuICAgICAgdGhpcy5nbG9iYWxTdG9yYWdlID0gbmV3IEdsb2JhbFN0b3JhZ2UodGhpcyk7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0IHVzZXJJZCgpOiBzdHJpbmcge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmNvbnRleHQudXNlcklkO1xyXG4gICAgfVxyXG5cclxuICAgIGFzeW5jIHJhd1F1ZXJ5KGVuZHBvaW50OiBzdHJpbmcsIG9wdGlvbnM6IFJhd09wdGlvbnM9e30pOiBQcm9taXNlPGFueT4ge1xyXG4gICAgICAgIHJldHVybiB0aGlzLmNvbnRleHQucmF3UXVlcnkoYCR7UmF0aW9uQUkucmVsYXRpdmVBcGlQYXRofSR7ZW5kcG9pbnR9YCwgb3B0aW9ucyk7XHJcbiAgICB9XHJcbn1cclxuIiwiaW1wb3J0IHtFbXBhdGlvbkFQSU9wdGlvbnMsIFJhd0FQSSwgUmF3T3B0aW9uc30gZnJvbSBcIi4uLy4uL2Jhc2VcIjtcclxuaW1wb3J0IHtSb290QVBJfSBmcm9tIFwiLi4vLi4vcm9vdFwiO1xyXG5pbXBvcnQgU2NvcGVzIGZyb20gXCIuLi9zY29wZS9zY29wZXNcIjtcclxuaW1wb3J0IEFwcHMgZnJvbSBcIi4vYXBwc1wiO1xyXG5pbXBvcnQgQ2FzZXMgZnJvbSBcIi4vY2FzZXNcIjtcclxuaW1wb3J0IEV4YW1pbmF0aW9ucyBmcm9tIFwiLi9leGFtaW5hdGlvbnNcIjtcclxuaW1wb3J0IFNsaWRlcyBmcm9tIFwiLi9zbGlkZXNcIjtcclxuaW1wb3J0IFJhdGlvbkFJIGZyb20gXCIuLi9yYXRpb25haS9yYXRpb25haVwiO1xyXG5cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgUm9vdCBleHRlbmRzIFJvb3RBUEkge1xyXG4gICAgc3RhdGljIGFwaVBhdGggPSAnL3YzJztcclxuXHJcbiAgICAvL2ludGVyZmFjZVxyXG4gICAgcHJvdGVjdGVkIHJhdzogUmF3QVBJO1xyXG4gICAgc2NvcGVzOiBTY29wZXM7XHJcbiAgICByYXRpb25haTogUmF0aW9uQUk7XHJcbiAgICB2ZXJzaW9uOiBzdHJpbmc7XHJcbiAgICByb290VVJJOiBzdHJpbmc7XHJcblxyXG4gICAgLy9jdXN0b21cclxuICAgIGFwcHM6IEFwcHM7XHJcbiAgICBjYXNlczogQ2FzZXM7XHJcbiAgICBleGFtaW5hdGlvbnM6IEV4YW1pbmF0aW9ucztcclxuICAgIHNsaWRlczogU2xpZGVzO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKG9wdGlvbnM6IEVtcGF0aW9uQVBJT3B0aW9ucykge1xyXG4gICAgICAgIHN1cGVyKG9wdGlvbnMpO1xyXG4gICAgICAgIHRoaXMudmVyc2lvbiA9IFwidjNcIjtcclxuICAgICAgICB0aGlzLnJvb3RVUkkgPSB0aGlzLm9wdGlvbnMuYXBpVXJsICsgUm9vdC5hcGlQYXRoO1xyXG4gICAgICAgIHRoaXMucmF3ID0gbmV3IFJhd0FQSSh0aGlzLnJvb3RVUkkpO1xyXG4gICAgICAgIHRoaXMuc2NvcGVzID0gbmV3IFNjb3Blcyh0aGlzKTtcclxuICAgICAgICB0aGlzLnJhdGlvbmFpID0gbmV3IFJhdGlvbkFJKHRoaXMpO1xyXG5cclxuICAgICAgICB0aGlzLmFwcHMgPSBuZXcgQXBwcyh0aGlzKTtcclxuICAgICAgICB0aGlzLmNhc2VzID0gbmV3IENhc2VzKHRoaXMpO1xyXG4gICAgICAgIHRoaXMuZXhhbWluYXRpb25zID0gbmV3IEV4YW1pbmF0aW9ucyh0aGlzKTtcclxuICAgICAgICB0aGlzLnNsaWRlcyA9IG5ldyBTbGlkZXModGhpcyk7XHJcbiAgICB9XHJcblxyXG4gICAgYXN5bmMgcmF3UXVlcnkoZW5kcG9pbnQ6IHN0cmluZywgb3B0aW9uczogUmF3T3B0aW9ucz17fSk6IFByb21pc2U8YW55PiB7XHJcbiAgICAgICAgYXdhaXQgc3VwZXIucmF3UXVlcnkoZW5kcG9pbnQsIG9wdGlvbnMpO1xyXG4gICAgICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xyXG4gICAgICAgIG9wdGlvbnMuaGVhZGVycyA9IG9wdGlvbnMuaGVhZGVycyB8fCB7fTtcclxuICAgICAgICBvcHRpb25zLmhlYWRlcnNbXCJVc2VyLUlkXCJdID0gdGhpcy51c2VySWQ7XHJcbiAgICAgICAgaWYgKHRoaXMuYWNjZXNzVG9rZW4pIHtcclxuICAgICAgICAgICAgb3B0aW9ucy5oZWFkZXJzWydBdXRob3JpemF0aW9uJ10gPSBvcHRpb25zLmhlYWRlcnNbJ0F1dGhvcml6YXRpb24nXSB8fCBgQmVhcmVyICR7dGhpcy5yYXdUb2tlbn1gO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gdGhpcy5yYXcuaHR0cChlbmRwb2ludCwgb3B0aW9ucyk7XHJcbiAgICB9XHJcbn1cclxuIl0sIm5hbWVzIjpbIl9fd2VicGFja19yZXF1aXJlX18iLCJleHBvcnRzIiwiZGVmaW5pdGlvbiIsImtleSIsIm8iLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImVudW1lcmFibGUiLCJnZXQiLCJvYmoiLCJwcm9wIiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJjYWxsIiwiU3ltYm9sIiwidG9TdHJpbmdUYWciLCJ2YWx1ZSIsIkV2ZW50U291cmNlIiwiZXZlbnRzIiwiYWRkT25jZUhhbmRsZXIiLCJldmVudE5hbWUiLCJoYW5kbGVyIiwidXNlckRhdGEiLCJ0aW1lcyIsInByaW9yaXR5Iiwic2VsZiIsInRoaXMiLCJjb3VudCIsIm9uY2VIYW5kbGVyIiwiZXZlbnQiLCJyZW1vdmVIYW5kbGVyIiwiYWRkSGFuZGxlciIsImlzRnVuY3Rpb24iLCJpbmRleCIsImxlbmd0aCIsImhhbmRsZXJzIiwiQXJyYXkiLCJpc0FycmF5IiwiaSIsInB1c2giLCJudW1iZXJPZkhhbmRsZXJzIiwicmVtb3ZlQWxsSGFuZGxlcnMiLCJldmVudFR5cGUiLCJnZXRIYW5kbGVyIiwiYXBwbHkiLCJzb3VyY2UiLCJhcmdzIiwiZXZlbnRTb3VyY2UiLCJnZXRBd2FpdGluZ0hhbmRsZXIiLCJQcm9taXNlIiwicmVzb2x2ZSIsImxvb3AiLCJyZXN1bHQiLCJ0eXBlIiwidGhlbiIsInJhaXNlRXZlbnQiLCJldmVudEFyZ3MiLCJyYWlzZUV2ZW50QXdhaXRpbmciLCJhd2FpdGluZ0hhbmRsZXIiLCJTdHJpbmciLCJjbGFzczJ0eXBlIiwidG9TdHJpbmciLCJTVEFUVVNfQ09ERVMiLCJIVFRQRXJyb3IiLCJFcnJvciIsImNvZGUiLCJtZXNzYWdlIiwiZXh0cmFzIiwic3VwZXIiLCJhcmd1bWVudHMiLCJhc3NpZ24iLCJuYW1lIiwic3VmZml4IiwicmVwbGFjZSIsInNwbGl0IiwicmVkdWNlIiwiYWNjIiwiYyIsImNoYXJBdCIsInRvVXBwZXJDYXNlIiwic2xpY2UiLCJodHRwRXJyb3JUb05hbWUiLCJzdGF0dXNDb2RlIiwiUmF3QVBJIiwiY29uc3RydWN0b3IiLCJ1cmwiLCJvcHRpb25zIiwiX3BhcnNlUXVlcnlQYXJhbXMiLCJwYXJhbXMiLCJ1bmRlZmluZWQiLCJrIiwidiIsIlVSTFNlYXJjaFBhcmFtcyIsIl9mZXRjaCIsInJlc3BvbnNlIiwiZmV0Y2giLCJtZXRob2QiLCJoZWFkZXJzIiwiYm9keSIsInJlc3BvbnNlVHlwZSIsImUiLCJzdGF0dXMiLCJzdGF0dXNUZXh0IiwiZXJyb3IiLCJvayIsImh0dHAiLCJlbmRwb2ludCIsImhhc0JvZHkiLCJzdGFydHNXaXRoIiwicXVlcnkiLCJKU09OIiwic3RyaW5naWZ5IiwiQWJzdHJhY3RBUEkiLCJnZXRDYWxsZXJOYW1lIiwib3JpZyIsInByZXBhcmVTdGFja1RyYWNlIiwic3RhY2siLCJyZXF1aXJlcyIsImdldEp3dFRva2VuRXhwaXJlc1RpbWVvdXQiLCJ0b2tlbiIsImV4cCIsIkRhdGUiLCJub3ciLCJwYXJzZUp3dFRva2VuIiwicGFyc2UiLCJhdG9iIiwic2xlZXAiLCJtcyIsInNldFRpbWVvdXQiLCJMb2dnZXIiLCJjb25zb2xlIiwid2FybiIsImluZm8iLCJkZWJ1ZyIsIlJvb3RDb250ZXh0IiwiUm9vdEFQSSIsImFjY2Vzc1Rva2VuIiwiX3Rva2VuRXhwaXJlcyIsIl9yYXdUb2tlbiIsIndvcmtiZW5jaEFwaVVybCIsImFwaVVybCIsImFwaVJvb3RQYXRoIiwiZW5kc1dpdGgiLCJhbm9ueW1vdXNVc2VySWQiLCJfdXNlcklkIiwiY2FjaGVkIiwiZnJvbSIsIndpdGhFdmVudCIsInJlc2V0IiwidG9rZW5UaW1lb3V0IiwidXNlcklkIiwic3ViIiwic2NvcGVzIiwicmF3VG9rZW4iLCJyYXdRdWVyeSIsImV2ZW50T2JqZWN0IiwibmV3VG9rZW4iLCJTY29wZUNvbnRleHQiLCJTY29wZXNBUEkiLCJBcHBzIiwiY29udGV4dCIsImRhdGEiLCJfZGVmYXVsdEFwcCIsImxpc3QiLCJhcHBzIiwidGlzc3VlcyIsInN0YWlucyIsImpvYl9tb2RlcyIsImFwcCIsIml0ZW1zIiwibmFtZV9zaG9ydCIsInZlbmRvcl9uYW1lIiwiZ2V0TnVtYmVyIiwidmFyaWFibGUiLCJOdW1iZXIiLCJtYXRjaFN0cmluZ09uU2VwYXJhdG9yR3JvdXAiLCJzdHIiLCJzZXBhcmF0b3IiLCJncm91cElkeCIsIm1hdGNoZXMiLCJSZWdFeHAiLCJleGVjIiwiQ2FzZUV4cGxvcmVyIiwiY3VzdG9tQ2FzZXMiLCJjYXNlSGllcmFyY2h5IiwiY2FzZVRpc3N1ZXMiLCJjYXNlU3RhaW5zIiwiaWRlbnRpZmllclNlcGFyYXRvciIsImhpZXJhcmNoeVNwZWMiLCJ1c2UiLCJnZXRDdXN0b21DYXNlcyIsIm1hcCIsImNhc2VPYmoiLCJwYXRoSW5IaWVyYXJjaHkiLCJnZXRDYXNlSGllcmFyY2h5UGF0aCIsInByZXYiLCJjdXJyIiwiZ2V0Q2FzZVZhbHVlIiwiZ2V0Q2FzZSIsImNhc2VJZCIsImZpbmQiLCJjcyIsImlkIiwiZ2V0Q2FzZVllYXIiLCJnZXRDYXNlTW9udGgiLCJnZXRDYXNlRGF5IiwiZ2V0Q2FzZURlc2NyaXB0aW9uIiwiZ2V0Q2FzZVRpc3N1ZXMiLCJnZXRDYXNlU3RhaW5zIiwiaXNOYU4iLCJnZXRDYXNlSWRlbnRpZmllclBhcnQiLCJldmFsdWF0ZUNhc2VWYWx1ZSIsImV2YWxWYWx1ZSIsImNhc2VWYWx1ZSIsImV2YXVsYXRlQ2FzZVllYXIiLCJldmF1bGF0ZUNhc2VNb250aCIsImV2YXVsYXRlQ2FzZURheSIsImV2YWx1YXRlQ2FzZURlc2NyaXB0aW9uIiwiZXZhbHVhdGVDYXNlVGlzc3VlcyIsImV2YWx1YXRlQ2FzZVN0YWlucyIsImV2YXVsYXRlQ2FzZUlkZW50aWZpZXJQYXJ0IiwiZXBvY2hUaW1lIiwiY3JlYXRlZF9hdCIsImdldEZ1bGxZZWFyIiwiZ2V0TW9udGgiLCJnZXREYXRlIiwicGFydElkeCIsInBhcnRzIiwibG9jYWxfaWQiLCJkZXNjcmlwdGlvbiIsImtleXMiLCJzdHJpbmdUb01hdGNoIiwidG9rZW5TdHJpbmciLCJ0b2tlbnMiLCJmaWx0ZXIiLCJCb29sZWFuIiwic2VhcmNoVGVybVJlZ2V4Iiwiam9pbiIsIm1hdGNoIiwibWF0Y2hTdHJpbmdPblRva2VucyIsImV2ZXJ5IiwidGlzc3VlIiwiaW5jbHVkZXMiLCJzdGFpbiIsImhpZXJhcmNoeUxldmVsIiwia2V5SWR4IiwiY2FzZXMiLCJjdXJyZW50SGllcmFyY2h5UGF0aCIsImxldmVsTmFtZSIsImxhc3RMZXZlbCIsImdyb3VwcyIsIml0ZW0iLCJoaWVyYXJjaHkiLCJzZWFyY2giLCJmaWx0ZXJlZENhc2VzIiwiZm9yRWFjaCIsImxvY2FsaXphdGlvbiIsImFsbFRpc3N1ZXMiLCJTZXQiLCJ2YWx1ZXMiLCJ0IiwiYWRkIiwiYWxsU3RhaW5zIiwiV3NpRXhwbG9yZXIiLCJsYXN0Q2FzZUlkIiwic2xpZGVzRGF0YSIsIm1hc2tzRGF0YSIsIm1hc2tJZGVudGlmaWVyU2VwYXJhdG9yIiwibWFza0lkZW50aWZpZXJWYWx1ZSIsImdldEFsbFNsaWRlcyIsInNsaWRlcyIsInNsaWRlIiwibWFza3MiLCJDYXNlcyIsImNhc2VFeHBsb3JlciIsIndzaUV4cGxvcmVyIiwiRXhhbWluYXRpb25zIiwiY3JlYXRlIiwiYXBwSWQiLCJjYXNlX2lkIiwiYXBwX2lkIiwic2tpcCIsImxpbWl0IiwiZXhhbWluYXRpb25JZCIsInNjb3BlIiwiU3RvcmFnZSIsImdldFJhdyIsImZsdXNoIiwiY29udGVudCIsInNldCIsInZhbHVlUmF3IiwiZGF0YVJhdyIsImVyYXNlIiwiQW5ub3RhdGlvbnMiLCJ1cGxvYWQiLCJ1cGRhdGUiLCJkZWxldGUiLCJleHRlcm5hbElkcyIsIkNvbGxlY3Rpb25zIiwiY29sbGVjdGlvbklkIiwiY29sbGVjdGlvbiIsInF1ZXJ5SXRlbXMiLCJjcmVhdGVJdGVtcyIsImRlbGV0ZUl0ZW0iLCJpdGVtSWQiLCJTY29wZXMiLCJzY29wZUNvbnRleHQiLCJfZGVmYXVsdEV4YW1pbmF0aW9uSWQiLCJfYWN0aXZlRXhhbWluYXRpb25JZCIsIl90b2tlblJlZmV0Y2hJbnRlcnZhbCIsInJhdyIsImFwaVBhdGgiLCJzdG9yYWdlIiwiYW5ub3RhdGlvbnMiLCJjb2xsZWN0aW9ucyIsImZpbmRFeGFtaW5hdGlvbiIsImV4YW1pbmF0aW9ucyIsImNyZWF0b3JzIiwiaXRlbV9jb3VudCIsImV4YW1pbmF0aW9uIiwiZXgiLCJzdGF0ZSIsImRlZmF1bHQiLCJzY29wZVRva2VuIiwiYWNjZXNzX3Rva2VuIiwidGltZW91dCIsInNldEludGVydmFsIiwiY2xlYXJJbnRlcnZhbCIsInNjb3BlX2lkIiwiR2xvYmFsRGF0YUNyZWF0b3JUeXBlIiwiR2xvYmFsSXRlbVJlZmVyZW5jZVR5cGUiLCJUZW1wbGF0ZVR5cGUiLCJTbGlkZXMiLCJzbGlkZUluZm8iLCJzbGlkZUlkIiwic2xpZGVUaHVtYm5haWwiLCJtYXhXaWR0aCIsIm1heEhlaWdodCIsImZvcm1hdCIsImltYWdlX2Zvcm1hdCIsInNsaWRlTGFiZWwiLCJsb2FkVGlsZSIsImxldmVsIiwieCIsInkiLCJXc2lNZXRhZGF0YSIsImRlZmF1bHRTbGlkZU1ldGFkYXRhIiwidmlzdWFsaXphdGlvbiIsImRlZmF1bHRNYXNrTWV0YWRhdGEiLCJnZXRXc2lNZXRhZGF0YUl0ZW0iLCJ3c2lJZCIsImlzU2xpZGUiLCJtZXRhZGF0YSIsInJlZmVyZW5jZXMiLCJwIiwiZGF0YV90eXBlIiwiY3JlYXRlV3NpTWV0YWRhdGFJdGVtIiwiY3JlYXRlVmFsdWUiLCJXU0kiLCJnZXRTbGlkZU1ldGFkYXRhIiwidXBkYXRlU2xpZGVNZXRhZGF0YSIsIm1ldGFkYXRhSXRlbSIsInVwZGF0ZWRJdGVtIiwiZ2V0U2hhZGVyc0NvbmZpZyIsInNoYWRlcnMiLCJzaGFkZXJzQ29uZmlnIiwic2hhZGVyVGVtcCIsInZpc1RlbXBsYXRlcyIsImdldFRlbXBsYXRlIiwiU2hhZGVyIiwic2hhZGVyVGVtcGxhdGUiLCJkYXRhUmVmZXJlbmNlcyIsImRhdGFSZWZzIiwiZ2V0VmlzdWFsaXphdGlvbnMiLCJzbGlkZVZpcyIsInBhcmFtc1RlbXBsYXRlIiwiUGFyYW1zIiwiYmFja2dyb3VuZCIsIkJhY2tncm91bmQiLCJ0ZW1wbGF0ZSIsImRhdGFSZWYiLCJ2aXN1YWxpemF0aW9ucyIsImFsbCIsInZpcyIsIlZpc3VhbGl6YXRpb24iLCJ2aXNUZW1wbGF0ZSIsImdldE1hc2tNZXRhZGF0YSIsInRlbXBsYXRlc0dsb2JhbEl0ZW1EYXRhVHlwZSIsIlZpc3VhbGl6YXRpb25UZW1wbGF0ZXMiLCJmZXRjaFRlbXBsYXRlSXRlbSIsImRhdGFfdHlwZXMiLCJ0bXBsIiwiY3JlYXRlVGVtcGxhdGUiLCJkZWxldGVUZW1wbGF0ZSIsImV4aXN0aW5nVG1wbCIsIkdsb2JhbFN0b3JhZ2UiLCJ3c2lNZXRhZGF0YSIsImdldFZhbHVlIiwicmVmZXJlbmNlX2lkIiwicmVmZXJlbmNlX3R5cGUiLCJuZXdJdGVtIiwiY3JlYXRvcl9pZCIsImNyZWF0b3JfdHlwZSIsIlVTRVIiLCJ1cGRhdGVWYWx1ZSIsIlJhdGlvbkFJIiwiZ2xvYmFsU3RvcmFnZSIsInJlbGF0aXZlQXBpUGF0aCIsIlJvb3QiLCJ2ZXJzaW9uIiwicm9vdFVSSSIsInJhdGlvbmFpIl0sInNvdXJjZVJvb3QiOiIifQ==